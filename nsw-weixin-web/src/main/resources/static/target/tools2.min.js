!function(e,t){if("function"==typeof define&&define.amd)define(["moment","jquery"],function(i,n){return e.daterangepicker=t(i,n)});else if("object"==typeof module&&module.exports){var i="undefined"!=typeof window?window.jQuery:void 0;i||(i=require("jquery"),i.fn||(i.fn={})),module.exports=t(require("moment"),i)}else e.daterangepicker=t(e.moment,e.jQuery)}(this,function(e,t){var i=function(i,n,r){if(this.parentEl="body",this.element=t(i),this.startDate=e().startOf("day"),this.endDate=e().endOf("day"),this.minDate=!1,this.maxDate=!1,this.dateLimit=!1,this.autoApply=!1,this.singleDatePicker=!1,this.showDropdowns=!1,this.showWeekNumbers=!1,this.showISOWeekNumbers=!1,this.showCustomRangeLabel=!0,this.timePicker=!1,this.timePicker24Hour=!1,this.timePickerIncrement=1,this.timePickerSeconds=!1,this.linkedCalendars=!0,this.autoUpdateInput=!0,this.alwaysShowCalendars=!1,this.ranges={},this.opens="right",this.element.hasClass("pull-right")&&(this.opens="left"),this.drops="down",this.element.hasClass("dropup")&&(this.drops="up"),this.buttonClasses="btn btn-sm",this.applyClass="btn-success",this.cancelClass="btn-default",this.locale={direction:"ltr",format:"MM/DD/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:e.weekdaysMin(),monthNames:e.monthsShort(),firstDay:e.localeData().firstDayOfWeek()},this.callback=function(){},this.isShowing=!1,this.leftCalendar={},this.rightCalendar={},"object"==typeof n&&null!==n||(n={}),n=t.extend(this.element.data(),n),"string"==typeof n.template||n.template instanceof t||(n.template='<div class="daterangepicker dropdown-menu"><div class="calendar left"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_start" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="calendar right"><div class="daterangepicker_input"><input class="input-mini form-control" type="text" name="daterangepicker_end" value="" /><i class="fa fa-calendar glyphicon glyphicon-calendar"></i><div class="calendar-time"><div></div><i class="fa fa-clock-o glyphicon glyphicon-time"></i></div></div><div class="calendar-table"></div></div><div class="ranges"><div class="range_inputs"><button class="applyBtn" disabled="disabled" type="button"></button> <button class="cancelBtn" type="button"></button></div></div></div>'),this.parentEl=t(n.parentEl&&t(n.parentEl).length?n.parentEl:this.parentEl),this.container=t(n.template).appendTo(this.parentEl),"object"==typeof n.locale&&("string"==typeof n.locale.direction&&(this.locale.direction=n.locale.direction),"string"==typeof n.locale.format&&(this.locale.format=n.locale.format),"string"==typeof n.locale.separator&&(this.locale.separator=n.locale.separator),"object"==typeof n.locale.daysOfWeek&&(this.locale.daysOfWeek=n.locale.daysOfWeek.slice()),"object"==typeof n.locale.monthNames&&(this.locale.monthNames=n.locale.monthNames.slice()),"number"==typeof n.locale.firstDay&&(this.locale.firstDay=n.locale.firstDay),"string"==typeof n.locale.applyLabel&&(this.locale.applyLabel=n.locale.applyLabel),"string"==typeof n.locale.cancelLabel&&(this.locale.cancelLabel=n.locale.cancelLabel),"string"==typeof n.locale.weekLabel&&(this.locale.weekLabel=n.locale.weekLabel),"string"==typeof n.locale.customRangeLabel&&(this.locale.customRangeLabel=n.locale.customRangeLabel)),this.container.addClass(this.locale.direction),"string"==typeof n.startDate&&(this.startDate=e(n.startDate,this.locale.format)),"string"==typeof n.endDate&&(this.endDate=e(n.endDate,this.locale.format)),"string"==typeof n.minDate&&(this.minDate=e(n.minDate,this.locale.format)),"string"==typeof n.maxDate&&(this.maxDate=e(n.maxDate,this.locale.format)),"object"==typeof n.startDate&&(this.startDate=e(n.startDate)),"object"==typeof n.endDate&&(this.endDate=e(n.endDate)),"object"==typeof n.minDate&&(this.minDate=e(n.minDate)),"object"==typeof n.maxDate&&(this.maxDate=e(n.maxDate)),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone()),"string"==typeof n.applyClass&&(this.applyClass=n.applyClass),"string"==typeof n.cancelClass&&(this.cancelClass=n.cancelClass),"object"==typeof n.dateLimit&&(this.dateLimit=n.dateLimit),"string"==typeof n.opens&&(this.opens=n.opens),"string"==typeof n.drops&&(this.drops=n.drops),"boolean"==typeof n.showWeekNumbers&&(this.showWeekNumbers=n.showWeekNumbers),"boolean"==typeof n.showISOWeekNumbers&&(this.showISOWeekNumbers=n.showISOWeekNumbers),"string"==typeof n.buttonClasses&&(this.buttonClasses=n.buttonClasses),"object"==typeof n.buttonClasses&&(this.buttonClasses=n.buttonClasses.join(" ")),"boolean"==typeof n.showDropdowns&&(this.showDropdowns=n.showDropdowns),"boolean"==typeof n.showCustomRangeLabel&&(this.showCustomRangeLabel=n.showCustomRangeLabel),"boolean"==typeof n.singleDatePicker&&(this.singleDatePicker=n.singleDatePicker,this.singleDatePicker&&(this.endDate=this.startDate.clone())),"boolean"==typeof n.timePicker&&(this.timePicker=n.timePicker),"boolean"==typeof n.timePickerSeconds&&(this.timePickerSeconds=n.timePickerSeconds),"number"==typeof n.timePickerIncrement&&(this.timePickerIncrement=n.timePickerIncrement),"boolean"==typeof n.timePicker24Hour&&(this.timePicker24Hour=n.timePicker24Hour),"boolean"==typeof n.autoApply&&(this.autoApply=n.autoApply),"boolean"==typeof n.autoUpdateInput&&(this.autoUpdateInput=n.autoUpdateInput),"boolean"==typeof n.linkedCalendars&&(this.linkedCalendars=n.linkedCalendars),"function"==typeof n.isInvalidDate&&(this.isInvalidDate=n.isInvalidDate),"function"==typeof n.isCustomDate&&(this.isCustomDate=n.isCustomDate),"boolean"==typeof n.alwaysShowCalendars&&(this.alwaysShowCalendars=n.alwaysShowCalendars),0!=this.locale.firstDay)for(var a=this.locale.firstDay;a>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),a--;var o,s,u;if("undefined"==typeof n.startDate&&"undefined"==typeof n.endDate&&t(this.element).is("input[type=text]")){var c=t(this.element).val(),l=c.split(this.locale.separator);o=s=null,2==l.length?(o=e(l[0],this.locale.format),s=e(l[1],this.locale.format)):this.singleDatePicker&&""!==c&&(o=e(c,this.locale.format),s=e(c,this.locale.format)),null!==o&&null!==s&&(this.setStartDate(o),this.setEndDate(s))}if("object"==typeof n.ranges){for(u in n.ranges){o="string"==typeof n.ranges[u][0]?e(n.ranges[u][0],this.locale.format):e(n.ranges[u][0]),s="string"==typeof n.ranges[u][1]?e(n.ranges[u][1],this.locale.format):e(n.ranges[u][1]),this.minDate&&o.isBefore(this.minDate)&&(o=this.minDate.clone());var h=this.maxDate;if(this.dateLimit&&h&&o.clone().add(this.dateLimit).isAfter(h)&&(h=o.clone().add(this.dateLimit)),h&&s.isAfter(h)&&(s=h.clone()),!(this.minDate&&s.isBefore(this.minDate,this.timepicker?"minute":"day")||h&&o.isAfter(h,this.timepicker?"minute":"day"))){var d=document.createElement("textarea");d.innerHTML=u;var f=d.value;this.ranges[f]=[o,s]}}var p="<ul>";for(u in this.ranges)p+='<li data-range-key="'+u+'">'+u+"</li>";this.showCustomRangeLabel&&(p+='<li data-range-key="'+this.locale.customRangeLabel+'">'+this.locale.customRangeLabel+"</li>"),p+="</ul>",this.container.find(".ranges").prepend(p)}"function"==typeof r&&(this.callback=r),this.timePicker||(this.startDate=this.startDate.startOf("day"),this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide()),this.timePicker&&this.autoApply&&(this.autoApply=!1),this.autoApply&&"object"!=typeof n.ranges?this.container.find(".ranges").hide():this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide"),this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".calendar.left").addClass("single"),this.container.find(".calendar.left").show(),this.container.find(".calendar.right").hide(),this.container.find(".daterangepicker_input input, .daterangepicker_input > i").hide(),this.timePicker?this.container.find(".ranges ul").hide():this.container.find(".ranges").hide()),("undefined"==typeof n.ranges&&!this.singleDatePicker||this.alwaysShowCalendars)&&this.container.addClass("show-calendar"),this.container.addClass("opens"+this.opens),"undefined"!=typeof n.ranges&&"right"==this.opens&&this.container.find(".ranges").prependTo(this.container.find(".calendar.left").parent()),this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses),this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass),this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass),this.container.find(".applyBtn").html(this.locale.applyLabel),this.container.find(".cancelBtn").html(this.locale.cancelLabel),this.container.find(".calendar").on("click.daterangepicker",".prev",t.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",t.proxy(this.clickNext,this)).on("mousedown.daterangepicker","td.available",t.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",t.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",t.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",t.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",t.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",t.proxy(this.timeChanged,this)).on("click.daterangepicker",".daterangepicker_input input",t.proxy(this.showCalendars,this)).on("focus.daterangepicker",".daterangepicker_input input",t.proxy(this.formInputsFocused,this)).on("blur.daterangepicker",".daterangepicker_input input",t.proxy(this.formInputsBlurred,this)).on("change.daterangepicker",".daterangepicker_input input",t.proxy(this.formInputsChanged,this)),this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",t.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",t.proxy(this.clickCancel,this)).on("click.daterangepicker","li",t.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",t.proxy(this.hoverRange,this)).on("mouseleave.daterangepicker","li",t.proxy(this.updateFormInputs,this)),this.element.is("input")||this.element.is("button")?this.element.on({"click.daterangepicker":t.proxy(this.show,this),"focus.daterangepicker":t.proxy(this.show,this),"keyup.daterangepicker":t.proxy(this.elementChanged,this),"keydown.daterangepicker":t.proxy(this.keydown,this)}):this.element.on("click.daterangepicker",t.proxy(this.toggle,this)),this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))};return i.prototype={constructor:i,setStartDate:function(t){"string"==typeof t&&(this.startDate=e(t,this.locale.format)),"object"==typeof t&&(this.startDate=e(t)),this.timePicker||(this.startDate=this.startDate.startOf("day")),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate,this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement)),this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate,this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.floor(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement)),this.isShowing||this.updateElement(),this.updateMonthsInView()},setEndDate:function(t){"string"==typeof t&&(this.endDate=e(t,this.locale.format)),"object"==typeof t&&(this.endDate=e(t)),this.timePicker||(this.endDate=this.endDate.endOf("day")),this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement),this.endDate.isBefore(this.startDate)&&(this.endDate=this.startDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate),this.dateLimit&&this.startDate.clone().add(this.dateLimit).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.dateLimit)),this.previousRightTime=this.endDate.clone(),this.isShowing||this.updateElement(),this.updateMonthsInView()},isInvalidDate:function(){return!1},isCustomDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").removeAttr("disabled").removeClass("disabled"):this.container.find(".right .calendar-time select").attr("disabled","disabled").addClass("disabled")),this.endDate?(this.container.find('input[name="daterangepicker_end"]').removeClass("active"),this.container.find('input[name="daterangepicker_start"]').addClass("active")):(this.container.find('input[name="daterangepicker_end"]').addClass("active"),this.container.find('input[name="daterangepicker_start"]').removeClass("active")),this.updateMonthsInView(),this.updateCalendars(),this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;this.leftCalendar.month=this.startDate.clone().date(2),this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"):this.rightCalendar.month=this.endDate.clone().date(2)}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"));this.maxDate&&this.linkedCalendars&&!this.singleDatePicker&&this.rightCalendar.month>this.maxDate&&(this.rightCalendar.month=this.maxDate.clone().date(2),this.leftCalendar.month=this.maxDate.clone().date(2).subtract(1,"month"))},updateCalendars:function(){if(this.timePicker){var e,t,i;if(this.endDate){if(e=parseInt(this.container.find(".left .hourselect").val(),10),t=parseInt(this.container.find(".left .minuteselect").val(),10),i=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,!this.timePicker24Hour){var n=this.container.find(".left .ampmselect").val();"PM"===n&&e<12&&(e+=12),"AM"===n&&12===e&&(e=0)}}else if(e=parseInt(this.container.find(".right .hourselect").val(),10),t=parseInt(this.container.find(".right .minuteselect").val(),10),i=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,!this.timePicker24Hour){var n=this.container.find(".right .ampmselect").val();"PM"===n&&e<12&&(e+=12),"AM"===n&&12===e&&(e=0)}this.leftCalendar.month.hour(e).minute(t).second(i),this.rightCalendar.month.hour(e).minute(t).second(i)}this.renderCalendar("left"),this.renderCalendar("right"),this.container.find(".ranges li").removeClass("active"),null!=this.endDate&&this.calculateChosenLabel()},renderCalendar:function(i){var n="left"==i?this.leftCalendar:this.rightCalendar,r=n.month.month(),a=n.month.year(),o=n.month.hour(),s=n.month.minute(),u=n.month.second(),c=e([a,r]).daysInMonth(),l=e([a,r,1]),h=e([a,r,c]),d=e(l).subtract(1,"month").month(),f=e(l).subtract(1,"month").year(),p=e([f,d]).daysInMonth(),m=l.day(),n=[];n.firstDay=l,n.lastDay=h;for(var g=0;g<6;g++)n[g]=[];var v=p-m+this.locale.firstDay+1;v>p&&(v-=7),m==this.locale.firstDay&&(v=p-6);for(var y,w,x=e([f,d,v,12,s,u]),g=0,y=0,w=0;g<42;g++,y++,x=e(x).add(24,"hour"))g>0&&y%7===0&&(y=0,w++),n[w][y]=x.clone().hour(o).minute(s).second(u),x.hour(12),this.minDate&&n[w][y].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&n[w][y].isBefore(this.minDate)&&"left"==i&&(n[w][y]=this.minDate.clone()),this.maxDate&&n[w][y].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&n[w][y].isAfter(this.maxDate)&&"right"==i&&(n[w][y]=this.maxDate.clone());"left"==i?this.leftCalendar.calendar=n:this.rightCalendar.calendar=n;var b="left"==i?this.minDate:this.startDate,_=this.maxDate,E=("left"==i?this.startDate:this.endDate,"ltr"==this.locale.direction?{left:"chevron-left",right:"chevron-right"}:{left:"chevron-right",right:"chevron-left"}),R='<table class="table-condensed">';R+="<thead>",R+="<tr>",(this.showWeekNumbers||this.showISOWeekNumbers)&&(R+="<th></th>"),R+=b&&!b.isBefore(n.firstDay)||this.linkedCalendars&&"left"!=i?"<th></th>":'<th class="prev available"><i class="fa fa-'+E.left+" glyphicon glyphicon-"+E.left+'"></i></th>';var D=this.locale.monthNames[n[1][1].month()]+n[1][1].format(" YYYY");if(this.showDropdowns){for(var S=n[1][1].month(),k=n[1][1].year(),T=_&&_.year()||k+5,I=b&&b.year()||k-50,A=k==I,C=k==T,O='<select class="monthselect">',M=0;M<12;M++)O+=(!A||M>=b.month())&&(!C||M<=_.month())?"<option value='"+M+"'"+(M===S?" selected='selected'":"")+">"+this.locale.monthNames[M]+"</option>":"<option value='"+M+"'"+(M===S?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[M]+"</option>";O+="</select>";for(var L='<select class="yearselect">',F=I;F<=T;F++)L+='<option value="'+F+'"'+(F===k?' selected="selected"':"")+">"+F+"</option>";L+="</select>",D=O+L}if(R+='<th colspan="5" class="month">'+D+"</th>",R+=_&&!_.isAfter(n.lastDay)||this.linkedCalendars&&"right"!=i&&!this.singleDatePicker?"<th></th>":'<th class="next available"><i class="fa fa-'+E.right+" glyphicon glyphicon-"+E.right+'"></i></th>',R+="</tr>",R+="<tr>",(this.showWeekNumbers||this.showISOWeekNumbers)&&(R+='<th class="week">'+this.locale.weekLabel+"</th>"),t.each(this.locale.daysOfWeek,function(e,t){R+="<th>"+t+"</th>"}),R+="</tr>",R+="</thead>",R+="<tbody>",null==this.endDate&&this.dateLimit){var P=this.startDate.clone().add(this.dateLimit).endOf("day");_&&!P.isBefore(_)||(_=P)}for(var w=0;w<6;w++){R+="<tr>",this.showWeekNumbers?R+='<td class="week">'+n[w][0].week()+"</td>":this.showISOWeekNumbers&&(R+='<td class="week">'+n[w][0].isoWeek()+"</td>");for(var y=0;y<7;y++){var N=[];n[w][y].isSame(new Date,"day")&&N.push("today"),n[w][y].isoWeekday()>5&&N.push("weekend"),n[w][y].month()!=n[1][1].month()&&N.push("off"),this.minDate&&n[w][y].isBefore(this.minDate,"day")&&N.push("off","disabled"),_&&n[w][y].isAfter(_,"day")&&N.push("off","disabled"),this.isInvalidDate(n[w][y])&&N.push("off","disabled"),n[w][y].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")&&N.push("active","start-date"),null!=this.endDate&&n[w][y].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&N.push("active","end-date"),null!=this.endDate&&n[w][y]>this.startDate&&n[w][y]<this.endDate&&N.push("in-range");var B=this.isCustomDate(n[w][y]);B!==!1&&("string"==typeof B?N.push(B):Array.prototype.push.apply(N,B));for(var U="",H=!1,g=0;g<N.length;g++)U+=N[g]+" ","disabled"==N[g]&&(H=!0);H||(U+="available"),R+='<td class="'+U.replace(/^\s+|\s+$/g,"")+'" data-title="r'+w+"c"+y+'">'+n[w][y].date()+"</td>"}R+="</tr>"}R+="</tbody>",R+="</table>",this.container.find(".calendar."+i+" .calendar-table").html(R)},renderTimePicker:function(e){if("right"!=e||this.endDate){var t,i,n,r=this.maxDate;if(!this.dateLimit||this.maxDate&&!this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)||(r=this.startDate.clone().add(this.dateLimit)),"left"==e)i=this.startDate.clone(),n=this.minDate;else if("right"==e){i=this.endDate.clone(),n=this.startDate;var a=this.container.find(".calendar.right .calendar-time div");if(!this.endDate&&""!=a.html()&&(i.hour(a.find(".hourselect option:selected").val()||i.hour()),i.minute(a.find(".minuteselect option:selected").val()||i.minute()),i.second(a.find(".secondselect option:selected").val()||i.second()),!this.timePicker24Hour)){var o=a.find(".ampmselect option:selected").val();"PM"===o&&i.hour()<12&&i.hour(i.hour()+12),"AM"===o&&12===i.hour()&&i.hour(0)}i.isBefore(this.startDate)&&(i=this.startDate.clone()),r&&i.isAfter(r)&&(i=r.clone())}t='<select class="hourselect">';for(var s=this.timePicker24Hour?0:1,u=this.timePicker24Hour?23:12,c=s;c<=u;c++){var l=c;this.timePicker24Hour||(l=i.hour()>=12?12==c?12:c+12:12==c?0:c);var h=i.clone().hour(l),d=!1;n&&h.minute(59).isBefore(n)&&(d=!0),r&&h.minute(0).isAfter(r)&&(d=!0),t+=l!=i.hour()||d?d?'<option value="'+c+'" disabled="disabled" class="disabled">'+c+"</option>":'<option value="'+c+'">'+c+"</option>":'<option value="'+c+'" selected="selected">'+c+"</option>"}t+="</select> ",t+=': <select class="minuteselect">';for(var c=0;c<60;c+=this.timePickerIncrement){var f=c<10?"0"+c:c,h=i.clone().minute(c),d=!1;n&&h.second(59).isBefore(n)&&(d=!0),r&&h.second(0).isAfter(r)&&(d=!0),t+=i.minute()!=c||d?d?'<option value="'+c+'" disabled="disabled" class="disabled">'+f+"</option>":'<option value="'+c+'">'+f+"</option>":'<option value="'+c+'" selected="selected">'+f+"</option>"}if(t+="</select> ",this.timePickerSeconds){t+=': <select class="secondselect">';for(var c=0;c<60;c++){var f=c<10?"0"+c:c,h=i.clone().second(c),d=!1;n&&h.isBefore(n)&&(d=!0),r&&h.isAfter(r)&&(d=!0),t+=i.second()!=c||d?d?'<option value="'+c+'" disabled="disabled" class="disabled">'+f+"</option>":'<option value="'+c+'">'+f+"</option>":'<option value="'+c+'" selected="selected">'+f+"</option>"}t+="</select> "}if(!this.timePicker24Hour){t+='<select class="ampmselect">';var p="",m="";n&&i.clone().hour(12).minute(0).second(0).isBefore(n)&&(p=' disabled="disabled" class="disabled"'),r&&i.clone().hour(0).minute(0).second(0).isAfter(r)&&(m=' disabled="disabled" class="disabled"'),t+=i.hour()>=12?'<option value="AM"'+p+'>AM</option><option value="PM" selected="selected"'+m+">PM</option>":'<option value="AM" selected="selected"'+p+'>AM</option><option value="PM"'+m+">PM</option>",t+="</select>"}this.container.find(".calendar."+e+" .calendar-time div").html(t)}},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").is(":focus")||this.container.find("input[name=daterangepicker_end]").is(":focus")||(this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.locale.format)),this.endDate&&this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.locale.format)),this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled"))},move:function(){var e,i={top:0,left:0},n=t(window).width();this.parentEl.is("body")||(i={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()},n=this.parentEl[0].clientWidth+this.parentEl.offset().left),e="up"==this.drops?this.element.offset().top-this.container.outerHeight()-i.top:this.element.offset().top+this.element.outerHeight()-i.top,this.container["up"==this.drops?"addClass":"removeClass"]("dropup"),"left"==this.opens?(this.container.css({top:e,right:n-this.element.offset().left-this.element.outerWidth(),left:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):"center"==this.opens?(this.container.css({top:e,left:this.element.offset().left-i.left+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):(this.container.css({top:e,left:this.element.offset().left-i.left,right:"auto"}),this.container.offset().left+this.container.outerWidth()>t(window).width()&&this.container.css({left:"auto",right:0}))},show:function(e){this.isShowing||(this._outsideClickProxy=t.proxy(function(e){this.outsideClick(e)},this),t(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),t(window).on("resize.daterangepicker",t.proxy(function(e){this.move(e)},this)),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.previousRightTime=this.endDate.clone(),this.updateView(),this.container.show(),this.move(),this.element.trigger("show.daterangepicker",this),this.isShowing=!0)},hide:function(e){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate,this.endDate,this.chosenLabel),this.updateElement(),t(document).off(".daterangepicker"),t(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",this),this.isShowing=!1)},toggle:function(e){this.isShowing?this.hide():this.show()},outsideClick:function(e){var i=t(e.target);"focusin"==e.type||i.closest(this.element).length||i.closest(this.container).length||i.closest(".calendar-table").length||(this.hide(),this.element.trigger("outsideClick.daterangepicker",this))},showCalendars:function(){this.container.addClass("show-calendar"),this.move(),this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar"),this.element.trigger("hideCalendar.daterangepicker",this)},hoverRange:function(e){if(!this.container.find("input[name=daterangepicker_start]").is(":focus")&&!this.container.find("input[name=daterangepicker_end]").is(":focus")){var t=e.target.getAttribute("data-range-key");if(t==this.locale.customRangeLabel)this.updateView();else{var i=this.ranges[t];this.container.find("input[name=daterangepicker_start]").val(i[0].format(this.locale.format)),this.container.find("input[name=daterangepicker_end]").val(i[1].format(this.locale.format))}}},clickRange:function(e){var t=e.target.getAttribute("data-range-key");if(this.chosenLabel=t,t==this.locale.customRangeLabel)this.showCalendars();else{var i=this.ranges[t];this.startDate=i[0],this.endDate=i[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.alwaysShowCalendars||this.hideCalendars(),this.clickApply()}},clickPrev:function(e){var i=t(e.target).parents(".calendar");i.hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,"month")):this.rightCalendar.month.subtract(1,"month"),this.updateCalendars()},clickNext:function(e){var i=t(e.target).parents(".calendar");i.hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month")),this.updateCalendars()},hoverDate:function(e){if(t(e.target).hasClass("available")){var i=t(e.target).attr("data-title"),n=i.substr(1,1),r=i.substr(3,1),a=t(e.target).parents(".calendar"),o=a.hasClass("left")?this.leftCalendar.calendar[n][r]:this.rightCalendar.calendar[n][r];this.endDate&&!this.container.find("input[name=daterangepicker_start]").is(":focus")?this.container.find("input[name=daterangepicker_start]").val(o.format(this.locale.format)):this.endDate||this.container.find("input[name=daterangepicker_end]").is(":focus")||this.container.find("input[name=daterangepicker_end]").val(o.format(this.locale.format));var s=this.leftCalendar,u=this.rightCalendar,c=this.startDate;this.endDate||this.container.find(".calendar td").each(function(e,i){if(!t(i).hasClass("week")){var n=t(i).attr("data-title"),r=n.substr(1,1),a=n.substr(3,1),l=t(i).parents(".calendar"),h=l.hasClass("left")?s.calendar[r][a]:u.calendar[r][a];h.isAfter(c)&&h.isBefore(o)||h.isSame(o,"day")?t(i).addClass("in-range"):t(i).removeClass("in-range")}})}},clickDate:function(e){if(t(e.target).hasClass("available")){var i=t(e.target).attr("data-title"),n=i.substr(1,1),r=i.substr(3,1),a=t(e.target).parents(".calendar"),o=a.hasClass("left")?this.leftCalendar.calendar[n][r]:this.rightCalendar.calendar[n][r];if(this.endDate||o.isBefore(this.startDate,"day")){if(this.timePicker){var s=parseInt(this.container.find(".left .hourselect").val(),10);if(!this.timePicker24Hour){var u=this.container.find(".left .ampmselect").val();"PM"===u&&s<12&&(s+=12),"AM"===u&&12===s&&(s=0)}var c=parseInt(this.container.find(".left .minuteselect").val(),10),l=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0;o=o.clone().hour(s).minute(c).second(l)}this.endDate=null,this.setStartDate(o.clone())}else if(!this.endDate&&o.isBefore(this.startDate))this.setEndDate(this.startDate.clone());else{if(this.timePicker){var s=parseInt(this.container.find(".right .hourselect").val(),10);if(!this.timePicker24Hour){var u=this.container.find(".right .ampmselect").val();"PM"===u&&s<12&&(s+=12),"AM"===u&&12===s&&(s=0)}var c=parseInt(this.container.find(".right .minuteselect").val(),10),l=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0;o=o.clone().hour(s).minute(c).second(l)}this.setEndDate(o.clone()),this.autoApply&&(this.calculateChosenLabel(),this.clickApply())}this.singleDatePicker&&(this.setEndDate(this.startDate),this.timePicker||this.clickApply()),this.updateView(),e.stopPropagation()}},calculateChosenLabel:function(){var e=!0,t=0;for(var i in this.ranges){if(this.timePicker){if(this.startDate.isSame(this.ranges[i][0])&&this.endDate.isSame(this.ranges[i][1])){e=!1,this.chosenLabel=this.container.find(".ranges li:eq("+t+")").addClass("active").html();break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[i][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[i][1].format("YYYY-MM-DD")){e=!1,this.chosenLabel=this.container.find(".ranges li:eq("+t+")").addClass("active").html();break}t++}e&&this.showCustomRangeLabel&&(this.chosenLabel=this.container.find(".ranges li:last").addClass("active").html(),this.showCalendars())},clickApply:function(e){this.hide(),this.element.trigger("apply.daterangepicker",this)},clickCancel:function(e){this.startDate=this.oldStartDate,this.endDate=this.oldEndDate,this.hide(),this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(e){var i=t(e.target).closest(".calendar").hasClass("left"),n=i?"left":"right",r=this.container.find(".calendar."+n),a=parseInt(r.find(".monthselect").val(),10),o=r.find(".yearselect").val();i||(o<this.startDate.year()||o==this.startDate.year()&&a<this.startDate.month())&&(a=this.startDate.month(),o=this.startDate.year()),this.minDate&&(o<this.minDate.year()||o==this.minDate.year()&&a<this.minDate.month())&&(a=this.minDate.month(),o=this.minDate.year()),this.maxDate&&(o>this.maxDate.year()||o==this.maxDate.year()&&a>this.maxDate.month())&&(a=this.maxDate.month(),o=this.maxDate.year()),i?(this.leftCalendar.month.month(a).year(o),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(a).year(o),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,"month"))),this.updateCalendars()},timeChanged:function(e){var i=t(e.target).closest(".calendar"),n=i.hasClass("left"),r=parseInt(i.find(".hourselect").val(),10),a=parseInt(i.find(".minuteselect").val(),10),o=this.timePickerSeconds?parseInt(i.find(".secondselect").val(),10):0;if(!this.timePicker24Hour){var s=i.find(".ampmselect").val();"PM"===s&&r<12&&(r+=12),"AM"===s&&12===r&&(r=0)}if(n){var u=this.startDate.clone();
u.hour(r),u.minute(a),u.second(o),this.setStartDate(u),this.singleDatePicker?this.endDate=this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==u.format("YYYY-MM-DD")&&this.endDate.isBefore(u)&&this.setEndDate(u.clone())}else if(this.endDate){var c=this.endDate.clone();c.hour(r),c.minute(a),c.second(o),this.setEndDate(c)}this.updateCalendars(),this.updateFormInputs(),this.renderTimePicker("left"),this.renderTimePicker("right")},formInputsChanged:function(i){var n=t(i.target).closest(".calendar").hasClass("right"),r=e(this.container.find('input[name="daterangepicker_start"]').val(),this.locale.format),a=e(this.container.find('input[name="daterangepicker_end"]').val(),this.locale.format);r.isValid()&&a.isValid()&&(n&&a.isBefore(r)&&(r=a.clone()),this.setStartDate(r),this.setEndDate(a),n?this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format)):this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format))),this.updateView()},formInputsFocused:function(e){this.container.find('input[name="daterangepicker_start"], input[name="daterangepicker_end"]').removeClass("active"),t(e.target).addClass("active");var i=t(e.target).closest(".calendar").hasClass("right");i&&(this.endDate=null,this.setStartDate(this.startDate.clone()),this.updateView())},formInputsBlurred:function(t){if(!this.endDate){var i=this.container.find('input[name="daterangepicker_end"]').val(),n=e(i,this.locale.format);n.isValid()&&(this.setEndDate(n),this.updateView())}},elementChanged:function(){if(this.element.is("input")&&this.element.val().length&&!(this.element.val().length<this.locale.format.length)){var t=this.element.val().split(this.locale.separator),i=null,n=null;2===t.length&&(i=e(t[0],this.locale.format),n=e(t[1],this.locale.format)),(this.singleDatePicker||null===i||null===n)&&(i=e(this.element.val(),this.locale.format),n=i),i.isValid()&&n.isValid()&&(this.setStartDate(i),this.setEndDate(n),this.updateView())}},keydown:function(e){9!==e.keyCode&&13!==e.keyCode||this.hide()},updateElement:function(){this.element.is("input")&&!this.singleDatePicker&&this.autoUpdateInput?(this.element.val(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format)),this.element.trigger("change")):this.element.is("input")&&this.autoUpdateInput&&(this.element.val(this.startDate.format(this.locale.format)),this.element.trigger("change"))},remove:function(){this.container.remove(),this.element.off(".daterangepicker"),this.element.removeData()}},t.fn.daterangepicker=function(e,n){return this.each(function(){var r=t(this);r.data("daterangepicker")&&r.data("daterangepicker").remove(),r.data("daterangepicker",new i(r,e,n))}),this},i}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):e.hasOwnProperty("angular")?t(e.angular):"object"==typeof exports&&(module.exports=t(require("angular")))}(this,function(e){"use strict";function t(t){return function(){var i="ngStorage-";this.setKeyPrefix=function(e){if("string"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setKeyPrefix() expects a String.");i=e};var n=e.toJson,r=e.fromJson;this.setSerializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setSerializer expects a function.");n=e},this.setDeserializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setDeserializer expects a function.");r=e},this.get=function(e){return r(window[t].getItem(i+e))},this.set=function(e,r){return window[t].setItem(i+e,n(r))},this.$get=["$rootScope","$window","$log","$timeout","$document",function(a,o,s,u,c){function l(e){var t;try{t=o[e]}catch(i){t=!1}if(t&&"localStorage"===e){var n="__"+Math.round(1e7*Math.random());try{localStorage.setItem(n,n),localStorage.removeItem(n)}catch(i){t=!1}}return t}var h,d,f=i.length,p=l(t)||(s.warn("This browser does not support Web Storage!"),{setItem:e.noop,getItem:e.noop,removeItem:e.noop}),m={$default:function(t){for(var i in t)e.isDefined(m[i])||(m[i]=e.copy(t[i]));return m.$sync(),m},$reset:function(e){for(var t in m)"$"===t[0]||delete m[t]&&p.removeItem(i+t);return m.$default(e)},$sync:function(){for(var e,t=0,n=p.length;t<n;t++)(e=p.key(t))&&i===e.slice(0,f)&&(m[e.slice(f)]=r(p.getItem(e)))},$apply:function(){var t;if(d=null,!e.equals(m,h)){t=e.copy(h),e.forEach(m,function(r,a){e.isDefined(r)&&"$"!==a[0]&&(p.setItem(i+a,n(r)),delete t[a])});for(var r in t)p.removeItem(i+r);h=e.copy(m)}}};return m.$sync(),h=e.copy(m),a.$watch(function(){d||(d=u(m.$apply,100,!1))}),o.addEventListener&&o.addEventListener("storage",function(t){if(t.key){var n=c[0];n.hasFocus&&n.hasFocus()||i!==t.key.slice(0,f)||(t.newValue?m[t.key.slice(f)]=r(t.newValue):delete m[t.key.slice(f)],h=e.copy(m),a.$apply())}}),o.addEventListener&&o.addEventListener("beforeunload",function(){m.$apply()}),m}]}}return e=e&&e.module?e:window.angular,e.module("ngStorage",[]).provider("$localStorage",t("localStorage")).provider("$sessionStorage",t("sessionStorage"))}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){"use strict";var t=e(window),i=function(t,n){n=e.isPlainObject(n)?n:{},this.$image=e(t),this.defaults=e.extend({},i.defaults,this.$image.data(),n),this.init()};i.prototype={construstor:i,init:function(){this.setAspectRatio(this.defaults.aspectRatio),this.render()},render:function(t){var n,r,a=this,o=this.$image;this.active||(this.$clone&&this.$clone.remove(),r=o.attr("src"),n=e('<img src="'+r+'">'),n.on("load",function(){var e;n.off("load"),this.naturalWidth&&this.naturalHeight?e={naturalHeight:this.naturalHeight,naturalWidth:this.naturalWidth}:(i.fn.size(n,{height:"auto",width:"auto"}),e=i.fn.size(n),e={naturalHeight:e.height,naturalWidth:e.width}),i.fn.size(n,{height:"100%",width:"100%"}),e.aspectRatio=e.naturalWidth/e.naturalHeight,a.src=r,a.image=e,a.active=!0,a.createCropper()}),e.isFunction(t)&&o.on("ready.cropper",t),this.$clone=n,o.after(n))},unrender:function(){this.active&&(this.active=!1,this.removeCropper(),this.src="",this.image=null,this.cropper=null,this.dragger=null)},rerender:function(){this.unrender(),this.render()},resize:function(){clearTimeout(this.resizing),this.resizing=setTimeout(e.proxy(this.rerender,this),200)},createCropper:function(){this.$cropper=e(i.template),this.$dragger=this.$cropper.find(".cropper-dragger"),i.fn.toggle(this.$image),this.$image.after(this.$cropper),this.$cropper.prepend(this.$clone),this.defaults.modal||i.fn.toggle(this.$cropper.find(".cropper-modal")),this.setPreview(),this.addListener()},removeCropper:function(){this.removeListener(),this.$preview=null,this.$clone.remove(),this.$clone=null,this.$dragger=null,this.$cropper.remove(),this.$cropper=null,i.fn.toggle(this.$image)},addListener:function(){this.$cropper.bind("mousedown touchstart",e.proxy(this.dragstart,this)),this.$cropper.bind("mousemove touchmove",e.proxy(this.dragmove,this)),this.$cropper.bind("mouseup mouseleave touchend touchleave",e.proxy(this.dragend,this)),t.on("resize",e.proxy(this.resize,this))},removeListener:function(){this.$cropper.unbind("mousedown touchstart",this.dragstart),this.$cropper.unbind("mousemove touchmove",this.dragmove),this.$cropper.unbind("mouseup mouseleave touchend touchleave",this.dragend),t.off("resize",this.resize)},setPreview:function(){var e=this.defaults.preview;this.$preview=this.$cropper.find(".cropper-preview"),"string"==typeof e&&e.length>0&&(this.$preview=this.$preview.add(e)),this.$preview.html('<img src="'+this.src+'">'),this.setCropper()},setCropper:function(){var t,n=this.$image.parent(),r=i.fn.size(n),a=this.image;a.naturalWidth*r.height/a.naturalHeight-r.width>=0?(t={height:r.width/a.aspectRatio,width:r.width,left:0},t.top=(r.height-t.height)/2):(t={height:r.height,width:r.height*a.aspectRatio,top:0},t.left=(r.width-t.width)/2),e.each(t,function(e,i){t[e]=Math.round(i)}),a.height=t.height,a.width=t.width,a.ratio=a.width/a.naturalWidth,i.fn.position(n),this.$cropper.css({height:t.height,left:t.left,top:t.top,width:t.width}),this.cropper=t,this.setDragger()},setDragger:function(){var e,t=this.cropper,n=this.defaults.aspectRatio||this.image.aspectRatio;e=t.height*n-t.width>=0?{height:t.width/n,width:t.width,left:0,top:(t.height-t.width/n)/2,maxWidth:t.width,maxHeight:t.width/n}:{height:t.height,width:t.height*n,left:(t.width-t.height*n)/2,top:0,maxHeight:t.height,maxWidth:t.height*n},e.height*=.8,e.width*=.8,e.left=(t.width-e.width)/2,e.top=(t.height-e.height)/2,this.dragger=i.fn.round(e),this.setData(this.defaults.data),this.$image.trigger("ready.cropper").off("ready.cropper")},resetDragger:function(){var e=this.dragger,t=this.cropper;e.width=e.width>e.maxWidth?e.maxWidth:Math.abs(e.width),e.height=e.height>e.maxHeight?e.maxHeight:Math.abs(e.height),e.maxLeft=t.width-e.width,e.maxTop=t.height-e.height,e.left=e.left<0?0:e.left>e.maxLeft?e.maxLeft:e.left,e.top=e.top<0?0:e.top>e.maxTop?e.maxTop:e.top,e=i.fn.round(e),this.$dragger.css({height:e.height,left:e.left,top:e.top,width:e.width}),this.dragger=e,this.preview(),this.output()},dragging:function(){var e=this.direction,t=this.dragger,i=this.defaults.aspectRatio,n={x:this.endX-this.startX,y:this.endY-this.startY};switch(i&&(n.X=n.y*i,n.Y=n.x/i),e){case"e":t.width+=n.x,i&&(t.height=t.width/i,t.top-=n.Y/2),t.width<0&&(this.direction="w",t.width=0);break;case"n":t.height-=n.y,t.top+=n.y,i&&(t.width=t.height*i,t.left+=n.X/2),t.height<0&&(this.direction="s",t.height=0);break;case"w":t.width-=n.x,t.left+=n.x,i&&(t.height=t.width/i,t.top+=n.Y/2),t.width<0&&(this.direction="e",t.width=0);break;case"s":t.height+=n.y,i&&(t.width=t.height*i,t.left-=n.X/2),t.height<0&&(this.direction="n",t.height=0);break;case"ne":t.height-=n.y,t.top+=n.y,i?t.width=t.height*i:t.width+=n.x,t.height<0&&(this.direction="sw",t.height=0,t.width=0);break;case"nw":t.height-=n.y,t.top+=n.y,i?(t.width=t.height*i,t.left+=n.X):(t.width-=n.x,t.left+=n.x),t.height<0&&(this.direction="se",t.height=0,t.width=0);break;case"sw":t.width-=n.x,t.left+=n.x,i?t.height=t.width/i:t.height+=n.y,t.width<0&&(this.direction="ne",t.height=0,t.width=0);break;case"se":t.width+=n.x,i?t.height=t.width/i:t.height+=n.y,t.width<0&&(this.direction="nw",t.height=0,t.width=0);break;default:t.left+=n.x,t.top+=n.y}this.resetDragger(),this.startX=this.endX,this.startY=this.endY},output:function(){this.defaults.done(this.getData())},preview:function(){var t=this,n=t.cropper,r=t.dragger;this.$preview.each(function(){var t=e(this),a=t.outerWidth()/r.width,o={height:n.height,marginLeft:-r.left,marginTop:-r.top,width:n.width};t.css({overflow:"hidden"}),t.find("img").css(i.fn.round(o,function(e){return e*a}))})},enable:function(e){this.render(e)},disable:function(){this.unrender()},setAspectRatio:function(t){("auto"===t||e.isNumeric(t)&&t>0)&&(this.defaults.aspectRatio="auto"===t?NaN:t,this.active&&this.setDragger())},setData:function(t){var n=this.cropper,r=this.dragger,a=this.defaults.aspectRatio,o=function(e){return"number"==typeof e};this.active&&(e.isPlainObject(t)&&!e.isEmptyObject(t)&&(t=i.fn.transformData(t,this.image.ratio),o(t.x1)&&t.x1<=n.width&&(r.left=t.x1),o(t.y1)&&t.y1<=n.height&&(r.top=t.y1),a?o(t.width)&&t.width<=n.width?(r.width=t.width,r.height=r.width/a):o(t.height)&&t.height<=n.height?(r.height=t.height,r.width=r.height*a):o(t.x2)&&t.x2<=n.width?(r.width=t.x2-r.left,r.height=r.width/a):o(t.y2)&&t.y2<=n.height&&(r.height=t.y2-r.top,r.width=r.height*a):(o(t.width)&&t.width<=n.width?r.width=t.width:o(t.x2)&&t.x2<=n.width&&(r.width=t.x2-r.left),o(t.height)&&t.height<=n.height?r.height=t.height:o(t.y2)&&t.height<=n.height&&(r.height=t.y2-r.top))),this.dragger=r,this.resetDragger())},getData:function(){var e=this.dragger,t={};return this.active&&(t={x1:e.left,y1:e.top,width:e.width,height:e.height,x2:e.left+e.width,y2:e.top+e.height},t=i.fn.transformData(t,1/this.image.ratio)),t},setImgSrc:function(e){"string"==typeof e&&e.length>0&&e!==this.src&&(this.$image.attr("src",e),this.rerender())},getImgInfo:function(){return this.image||{}},dragstart:function(t){var n,r,a=i.fn.getOriginalEvent(t).touches,o=t;a&&1===a.length&&(o=a[0],this.touchId=o.identifier,n=!0),r=e(o.target).data().direction,i.fn.isDirection(r)&&(this.startX=o.pageX,this.startY=o.pageY,this.direction=r,this.$image.trigger("dragstart"),n&&t.preventDefault())},dragmove:function(e){var t,n=i.fn.getOriginalEvent(e).changedTouches,r=e;n&&1===n.length&&(r=n[0],t=!0,r.identifier!==this.touchId)||this.direction&&(this.$image.trigger("dragmove"),t&&e.preventDefault(),this.endX=r.pageX,this.endY=r.pageY,this.dragging())},dragend:function(e){var t,n=i.fn.getOriginalEvent(e).changedTouches,r=e;n&&1===n.length&&(r=n[0],t=!0,r.identifier!==this.touchId)||this.direction&&(this.direction="",this.$image.trigger("dragend"),t&&e.preventDefault())}},i.fn={toggle:function(e){e.toggleClass("cropper-hidden")},position:function(e,t){var i=e.css("position");"static"===i&&e.css("position",t||"relative")},size:function(t,i){return e.isPlainObject(i)?void t.css(i):{height:t.height(),width:t.width()}},round:function(t,i){var n,r;for(r in t)n=t[r],t.hasOwnProperty(r)&&"number"==typeof n&&(t[r]=Math.round(e.isFunction(i)?i(n):n));return t},transformData:function(t,i){var n=this,r={};return e.each(t,function(t,a){n.isDataOption(t)&&e.isNumeric(a)&&a>=0&&(r[t]=Math.round(a*i))}),r},getOriginalEvent:function(e){return e&&"undefined"!=typeof e.originalEvent&&(e=e.originalEvent),e},isDataOption:function(e){return/^(x1|y1|x2|y2|width|height)$/i.test(e)},isDirection:function(e){return/^(\*|e|n|w|s|ne|nw|sw|se)$/i.test(e)}},i.template=['<div class="cropper-container">','<div class="cropper-modal"></div>','<div class="cropper-dragger">','<span class="cropper-preview"></span>','<span class="cropper-dashed dashed-h"></span>','<span class="cropper-dashed dashed-v"></span>','<span class="cropper-face" data-direction="*"></span>','<span class="cropper-line line-e" data-direction="e"></span>','<span class="cropper-line line-n" data-direction="n"></span>','<span class="cropper-line line-w" data-direction="w"></span>','<span class="cropper-line line-s" data-direction="s"></span>','<span class="cropper-point point-e" data-direction="e"></span>','<span class="cropper-point point-n" data-direction="n"></span>','<span class="cropper-point point-w" data-direction="w"></span>','<span class="cropper-point point-s" data-direction="s"></span>','<span class="cropper-point point-ne" data-direction="ne"></span>','<span class="cropper-point point-nw" data-direction="nw"></span>','<span class="cropper-point point-sw" data-direction="sw"></span>','<span class="cropper-point point-se" data-direction="se"></span>',"</div>","</div>"].join(""),i.defaults={aspectRatio:"auto",data:{},done:function(){},modal:!0,preview:""},i.setDefaults=function(t){e.extend(i.defaults,t)},e.fn.cropper=function(t,n){var r=this;return this.each(function(){var a=e(this),o=a.data("cropper");o||(o=new i(this,t),a.data("cropper",o)),"string"==typeof t&&e.isFunction(o[t])&&(r=o[t](n))}),"undefined"!=typeof r?r:this},e.fn.cropper.Constructor=i,e.fn.cropper.setDefaults=i.setDefaults,e(function(){e("img[cropper]").cropper()})}),function(e,t){var i,n={},r=function(e,t){var i,n,r;if("string"==typeof e)return s(e);for(i=[],n=e.length,r=0;r<n;r++)i.push(s(e[r]));return t.apply(null,i)},a=function(e,t,i){2===arguments.length&&(i=t,t=null),r(t||[],function(){o(e,i,arguments)})},o=function(e,t,i){var a,o={exports:t};"function"==typeof t&&(i.length||(i=[r,o.exports,o]),a=t.apply(null,i),void 0!==a&&(o.exports=a)),n[e]=o.exports},s=function(t){var i=n[t]||e[t];if(!i)throw new Error("`"+t+"` is undefined");return i},u=function(e){var t,i,r,a,o,s;s=function(e){return e&&e.charAt(0).toUpperCase()+e.substr(1)};for(t in n)if(i=e,n.hasOwnProperty(t)){for(r=t.split("/"),o=s(r.pop());a=s(r.shift());)i[a]=i[a]||{},i=i[a];i[o]=n[t]}return e},c=function(i){return e.__dollar=i,u(t(e,a,r))};"object"==typeof module&&"object"==typeof module.exports?module.exports=c():"function"==typeof define&&define.amd?define(["jquery"],c):(i=e.WebUploader,e.WebUploader=c(),e.WebUploader.noConflict=function(){e.WebUploader=i})}(window,function(e,t,i){return t("dollar-third",[],function(){var t=e.__dollar||e.jQuery||e.Zepto;if(!t)throw new Error("jQuery or Zepto not found!");return t}),t("dollar",["dollar-third"],function(e){return e}),t("promise-third",["dollar"],function(e){return{Deferred:e.Deferred,when:e.when,isPromise:function(e){return e&&"function"==typeof e.then}}}),t("promise",["promise-third"],function(e){return e}),t("base",["dollar","promise"],function(t,i){function n(e){return function(){return s.apply(e,arguments)}}function r(e,t){return function(){return e.apply(t,arguments)}}function a(e){var t;return Object.create?Object.create(e):(t=function(){},t.prototype=e,new t)}var o=function(){},s=Function.call;return{version:"0.1.5",$:t,Deferred:i.Deferred,isPromise:i.isPromise,when:i.when,browser:function(e){var t={},i=e.match(/WebKit\/([\d.]+)/),n=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),r=e.match(/MSIE\s([\d\.]+)/)||e.match(/(?:trident)(?:.*rv:([\w.]+))?/i),a=e.match(/Firefox\/([\d.]+)/),o=e.match(/Safari\/([\d.]+)/),s=e.match(/OPR\/([\d.]+)/);return i&&(t.webkit=parseFloat(i[1])),n&&(t.chrome=parseFloat(n[1])),r&&(t.ie=parseFloat(r[1])),a&&(t.firefox=parseFloat(a[1])),o&&(t.safari=parseFloat(o[1])),s&&(t.opera=parseFloat(s[1])),t}(navigator.userAgent),os:function(e){var t={},i=e.match(/(?:Android);?[\s\/]+([\d.]+)?/),n=e.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);return i&&(t.android=parseFloat(i[1])),n&&(t.ios=parseFloat(n[1].replace(/_/g,"."))),t}(navigator.userAgent),inherits:function(e,i,n){var r;return"function"==typeof i?(r=i,i=null):r=i&&i.hasOwnProperty("constructor")?i.constructor:function(){return e.apply(this,arguments)},t.extend(!0,r,e,n||{}),r.__super__=e.prototype,r.prototype=a(e.prototype),i&&t.extend(!0,r.prototype,i),r},noop:o,bindFn:r,log:function(){return e.console?r(console.log,console):o}(),nextTick:function(){return function(e){setTimeout(e,1)}}(),slice:n([].slice),guid:function(){var e=0;return function(t){for(var i=(+new Date).toString(32),n=0;n<5;n++)i+=Math.floor(65535*Math.random()).toString(32);return(t||"wu_")+i+(e++).toString(32)}}(),formatSize:function(e,t,i){var n;for(i=i||["B","K","M","G","TB"];(n=i.shift())&&e>1024;)e/=1024;return("B"===n?e:e.toFixed(t||2))+n}}}),t("mediator",["base"],function(e){function t(e,t,i,n){return a.grep(e,function(e){return e&&(!t||e.e===t)&&(!i||e.cb===i||e.cb._cb===i)&&(!n||e.ctx===n)})}function i(e,t,i){a.each((e||"").split(s),function(e,n){i(n,t)})}function n(e,t){for(var i,n=!1,r=-1,a=e.length;++r<a;)if(i=e[r],i.cb.apply(i.ctx2,t)===!1){n=!0;break}return!n}var r,a=e.$,o=[].slice,s=/\s+/;return r={on:function(e,t,n){var r,a=this;return t?(r=this._events||(this._events=[]),i(e,t,function(e,t){var i={e:e};i.cb=t,i.ctx=n,i.ctx2=n||a,i.id=r.length,r.push(i)}),this):this},once:function(e,t,n){var r=this;return t?(i(e,t,function(e,t){var i=function(){return r.off(e,i),t.apply(n||r,arguments)};i._cb=t,r.on(e,i,n)}),r):r},off:function(e,n,r){var o=this._events;return o?e||n||r?(i(e,n,function(e,i){a.each(t(o,e,i,r),function(){delete o[this.id]})}),this):(this._events=[],this):this},trigger:function(e){var i,r,a;return this._events&&e?(i=o.call(arguments,1),r=t(this._events,e),a=t(this._events,"all"),n(r,i)&&n(a,arguments)):this}},a.extend({installTo:function(e){return a.extend(e,r)}},r)}),t("uploader",["base","mediator"],function(e,t){function i(e){this.options=n.extend(!0,{},i.options,e),this._init(this.options)}var n=e.$;return i.options={},t.installTo(i.prototype),n.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",cancelFile:"cancel-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",md5File:"md5-file",getDimension:"get-dimension",addButton:"add-btn",predictRuntimeType:"predict-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(e,t){i.prototype[e]=function(){return this.request(t,arguments)}}),n.extend(i.prototype,{state:"pending",_init:function(e){var t=this;t.request("init",e,function(){t.state="ready",t.trigger("ready")})},option:function(e,t){var i=this.options;return arguments.length>1?void(n.isPlainObject(t)&&n.isPlainObject(i[e])?n.extend(i[e],t):i[e]=t):e?i[e]:i},getStats:function(){var e=this.request("get-stats");return e?{successNum:e.numOfSuccess,progressNum:e.numOfProgress,cancelNum:e.numOfCancel,invalidNum:e.numOfInvalid,uploadFailNum:e.numOfUploadFailed,queueNum:e.numOfQueue,interruptNum:e.numofInterrupt}:{}},trigger:function(e){var i=[].slice.call(arguments,1),r=this.options,a="on"+e.substring(0,1).toUpperCase()+e.substring(1);return!(t.trigger.apply(this,arguments)===!1||n.isFunction(r[a])&&r[a].apply(this,i)===!1||n.isFunction(this[a])&&this[a].apply(this,i)===!1||t.trigger.apply(t,[this,e].concat(i))===!1)},destroy:function(){this.request("destroy",arguments),this.off()},request:e.noop}),e.create=i.create=function(e){return new i(e)},e.Uploader=i,i}),t("runtime/runtime",["base","mediator"],function(e,t){function i(t){this.options=n.extend({container:document.body},t),this.uid=e.guid("rt_")}var n=e.$,r={},a=function(e){for(var t in e)if(e.hasOwnProperty(t))return t;return null};return n.extend(i.prototype,{getContainer:function(){var e,t,i=this.options;return this._container?this._container:(e=n(i.container||document.body),t=n(document.createElement("div")),t.attr("id","rt_"+this.uid),t.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),e.append(t),e.addClass("webuploader-container"),this._container=t,this._parent=e,t)},init:e.noop,exec:e.noop,destroy:function(){this._container&&this._container.remove(),this._parent&&this._parent.removeClass("webuploader-container"),this.off()}}),i.orders="html5,flash",i.addRuntime=function(e,t){r[e]=t},i.hasRuntime=function(e){return!!(e?r[e]:a(r))},i.create=function(e,t){var o,s;if(t=t||i.orders,n.each(t.split(/\s*,\s*/g),function(){if(r[this])return o=this,!1}),o=o||a(r),!o)throw new Error("Runtime Error");return s=new r[o](e)},t.installTo(i.prototype),i}),t("runtime/client",["base","mediator","runtime/runtime"],function(e,t,i){function n(t,n){var a,o=e.Deferred();this.uid=e.guid("client_"),this.runtimeReady=function(e){return o.done(e)},this.connectRuntime=function(t,s){if(a)throw new Error("already connected!");return o.done(s),"string"==typeof t&&r.get(t)&&(a=r.get(t)),a=a||r.get(null,n),a?(e.$.extend(a.options,t),a.__promise.then(o.resolve),a.__client++):(a=i.create(t,t.runtimeOrder),a.__promise=o.promise(),a.once("ready",o.resolve),a.init(),r.add(a),a.__client=1),n&&(a.__standalone=n),a},this.getRuntime=function(){return a},this.disconnectRuntime=function(){a&&(a.__client--,a.__client<=0&&(r.remove(a),delete a.__promise,a.destroy()),a=null)},this.exec=function(){if(a){var i=e.slice(arguments);return t&&i.unshift(t),a.exec.apply(this,i)}},this.getRuid=function(){return a&&a.uid},this.destroy=function(e){return function(){e&&e.apply(this,arguments),this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()}}(this.destroy)}var r;return r=function(){var e={};return{add:function(t){e[t.uid]=t},get:function(t,i){var n;if(t)return e[t];for(n in e)if(!i||!e[n].__standalone)return e[n];return null},remove:function(t){delete e[t.uid]}}}(),t.installTo(n.prototype),n}),t("lib/dnd",["base","mediator","runtime/client"],function(e,t,i){function n(e){e=this.options=r.extend({},n.options,e),e.container=r(e.container),e.container.length&&i.call(this,"DragAndDrop")}var r=e.$;return n.options={accept:null,disableGlobalDnd:!1},e.inherits(i,{constructor:n,init:function(){var e=this;e.connectRuntime(e.options,function(){e.exec("init"),e.trigger("ready")})}}),t.installTo(n.prototype),n}),t("widgets/widget",["base","uploader"],function(e,t){function i(e){if(!e)return!1;var t=e.length,i=r.type(e);return!(1!==e.nodeType||!t)||("array"===i||"function"!==i&&"string"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e))}function n(e){this.owner=e,this.options=e.options}var r=e.$,a=t.prototype._init,o=t.prototype.destroy,s={},u=[];return r.extend(n.prototype,{init:e.noop,invoke:function(e,t){var i=this.responseMap;return i&&e in i&&i[e]in this&&r.isFunction(this[i[e]])?this[i[e]].apply(this,t):s},request:function(){return this.owner.request.apply(this.owner,arguments)}}),r.extend(t.prototype,{_init:function(){var e=this,t=e._widgets=[],i=e.options.disableWidgets||"";return r.each(u,function(n,r){(!i||!~i.indexOf(r._name))&&t.push(new r(e))}),a.apply(e,arguments)},request:function(t,n,r){var a,o,u,c,l=0,h=this._widgets,d=h&&h.length,f=[],p=[];for(n=i(n)?n:[n];l<d;l++)a=h[l],o=a.invoke(t,n),o!==s&&(e.isPromise(o)?p.push(o):f.push(o));return r||p.length?(u=e.when.apply(e,p),c=u.pipe?"pipe":"then",u[c](function(){var t=e.Deferred(),i=arguments;return 1===i.length&&(i=i[0]),setTimeout(function(){t.resolve(i)},1),t.promise()})[r?c:"done"](r||e.noop)):f[0]},destroy:function(){o.apply(this,arguments),this._widgets=null}}),t.register=n.register=function(t,i){var a,o={init:"init",destroy:"destroy",name:"anonymous"};return 1===arguments.length?(i=t,r.each(i,function(e){return"_"===e[0]||"name"===e?void("name"===e&&(o.name=i.name)):void(o[e.replace(/[A-Z]/g,"-$&").toLowerCase()]=e)})):o=r.extend(o,t),i.responseMap=o,a=e.inherits(n,i),a._name=o.name,u.push(a),a},t.unRegister=n.unRegister=function(e){if(e&&"anonymous"!==e)for(var t=u.length;t--;)u[t]._name===e&&u.splice(t,1)},n}),t("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(e,t,i){var n=e.$;return t.options.dnd="",t.register({name:"dnd",init:function(t){if(t.dnd&&"html5"===this.request("predict-runtime-type")){var r,a=this,o=e.Deferred(),s=n.extend({},{disableGlobalDnd:t.disableGlobalDnd,container:t.dnd,accept:t.accept});return this.dnd=r=new i(s),r.once("ready",o.resolve),r.on("drop",function(e){a.request("add-file",[e])}),r.on("accept",function(e){return a.owner.trigger("dndAccept",e)}),r.init(),o.promise()}},destroy:function(){this.dnd&&this.dnd.destroy()}})}),t("lib/filepaste",["base","mediator","runtime/client"],function(e,t,i){function n(e){e=this.options=r.extend({},e),e.container=r(e.container||document.body),i.call(this,"FilePaste")}var r=e.$;return e.inherits(i,{constructor:n,init:function(){var e=this;e.connectRuntime(e.options,function(){e.exec("init"),e.trigger("ready")})}}),t.installTo(n.prototype),n}),t("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(e,t,i){var n=e.$;return t.register({name:"paste",init:function(t){if(t.paste&&"html5"===this.request("predict-runtime-type")){var r,a=this,o=e.Deferred(),s=n.extend({},{container:t.paste,accept:t.accept});return this.paste=r=new i(s),r.once("ready",o.resolve),r.on("paste",function(e){a.owner.request("add-file",[e])}),r.init(),o.promise()}},destroy:function(){this.paste&&this.paste.destroy()}})}),t("lib/blob",["base","runtime/client"],function(e,t){function i(e,i){var n=this;n.source=i,n.ruid=e,this.size=i.size||0,!i.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)?this.type="image/"+("jpg"===this.ext?"jpeg":this.ext):this.type=i.type||"application/octet-stream",t.call(n,"Blob"),this.uid=i.uid||this.uid,e&&n.connectRuntime(e)}return e.inherits(t,{constructor:i,slice:function(e,t){return this.exec("slice",e,t)},getSource:function(){return this.source}}),i}),t("lib/file",["base","lib/blob"],function(e,t){function i(e,i){var a;this.name=i.name||"untitled"+n++,a=r.exec(i.name)?RegExp.$1.toLowerCase():"",!a&&i.type&&(a=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(i.type)?RegExp.$1.toLowerCase():"",this.name+="."+a),this.ext=a,this.lastModifiedDate=i.lastModifiedDate||(new Date).toLocaleString(),t.apply(this,arguments)}var n=1,r=/\.([^.]+)$/;return e.inherits(t,i)}),t("lib/filepicker",["base","runtime/client","lib/file"],function(t,i,n){function r(e){if(e=this.options=a.extend({},r.options,e),e.container=a(e.id),!e.container.length)throw new Error("");e.innerHTML=e.innerHTML||e.label||e.container.html()||"",e.button=a(e.button||document.createElement("div")),e.button.html(e.innerHTML),e.container.html(e.button),i.call(this,"FilePicker",!0)}var a=t.$;return r.options={button:null,container:null,label:null,innerHTML:null,multiple:!0,accept:null,name:"file"},t.inherits(i,{constructor:r,init:function(){var i=this,r=i.options,o=r.button;o.addClass("webuploader-pick"),i.on("all",function(e){var t;switch(e){case"mouseenter":o.addClass("webuploader-pick-hover");break;case"mouseleave":o.removeClass("webuploader-pick-hover");break;case"change":t=i.exec("getFiles"),i.trigger("select",a.map(t,function(e){return e=new n(i.getRuid(),e),e._refer=r.container,e}),r.container)}}),i.connectRuntime(r,function(){i.refresh(),i.exec("init",r),i.trigger("ready")}),this._resizeHandler=t.bindFn(this.refresh,this),a(e).on("resize",this._resizeHandler)},refresh:function(){var e=this.getRuntime().getContainer(),t=this.options.button,i=t.outerWidth?t.outerWidth():t.width(),n=t.outerHeight?t.outerHeight():t.height(),r=t.offset();i&&n&&e.css({bottom:"auto",right:"auto",width:i+"px",height:n+"px"}).offset(r)},enable:function(){var e=this.options.button;e.removeClass("webuploader-pick-disable"),this.refresh()},disable:function(){var e=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"}),e.addClass("webuploader-pick-disable")},destroy:function(){var t=this.options.button;a(e).off("resize",this._resizeHandler),t.removeClass("webuploader-pick-disable webuploader-pick-hover webuploader-pick")}}),r}),t("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(e,t,i){var n=e.$;return n.extend(t.options,{pick:null,accept:null}),t.register({name:"picker",init:function(e){return this.pickers=[],e.pick&&this.addBtn(e.pick)},refresh:function(){n.each(this.pickers,function(){this.refresh()})},addBtn:function(t){var r=this,a=r.options,o=a.accept,s=[];if(t)return n.isPlainObject(t)||(t={id:t}),n(t.id).each(function(){var u,c,l;l=e.Deferred(),u=n.extend({},t,{accept:n.isPlainObject(o)?[o]:o,swf:a.swf,runtimeOrder:a.runtimeOrder,id:this}),c=new i(u),c.once("ready",l.resolve),c.on("select",function(e){r.owner.request("add-file",[e])}),c.init(),r.pickers.push(c),s.push(l.promise())}),e.when.apply(e,s)},disable:function(){n.each(this.pickers,function(){this.disable()})},enable:function(){n.each(this.pickers,function(){this.enable()})},destroy:function(){n.each(this.pickers,function(){this.destroy()}),this.pickers=null}})}),t("lib/image",["base","runtime/client","lib/blob"],function(e,t,i){function n(e){this.options=r.extend({},n.options,e),t.call(this,"Image"),this.on("load",function(){this._info=this.exec("info"),this._meta=this.exec("meta")})}var r=e.$;return n.options={quality:90,crop:!1,preserveHeaders:!1,allowMagnify:!1},e.inherits(t,{constructor:n,info:function(e){return e?(this._info=e,this):this._info},meta:function(e){return e?(this._meta=e,this):this._meta},loadFromBlob:function(e){var t=this,i=e.getRuid();this.connectRuntime(i,function(){t.exec("init",t.options),t.exec("loadFromBlob",e)})},resize:function(){var t=e.slice(arguments);return this.exec.apply(this,["resize"].concat(t))},crop:function(){var t=e.slice(arguments);return this.exec.apply(this,["crop"].concat(t))},getAsDataUrl:function(e){return this.exec("getAsDataUrl",e)},getAsBlob:function(e){var t=this.exec("getAsBlob",e);return new i(this.getRuid(),t)}}),n}),t("widgets/image",["base","uploader","lib/image","widgets/widget"],function(e,t,i){var n,r=e.$;return n=function(e){var t=0,i=[],n=function(){for(var n;i.length&&t<e;)n=i.shift(),t+=n[0],n[1]()};return function(e,r,a){i.push([r,a]),e.once("destroy",function(){t-=r,setTimeout(n,1)}),setTimeout(n,1)}}(5242880),r.extend(t.options,{thumb:{width:110,height:110,quality:70,allowMagnify:!0,
crop:!0,preserveHeaders:!1,type:"image/jpeg"},compress:{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0}}),t.register({name:"image",makeThumb:function(e,t,a,o){var s,u;return e=this.request("get-file",e),e.type.match(/^image/)?(s=r.extend({},this.options.thumb),r.isPlainObject(a)&&(s=r.extend(s,a),a=null),a=a||s.width,o=o||s.height,u=new i(s),u.once("load",function(){e._info=e._info||u.info(),e._meta=e._meta||u.meta(),a<=1&&a>0&&(a=e._info.width*a),o<=1&&o>0&&(o=e._info.height*o),u.resize(a,o)}),u.once("complete",function(){t(!1,u.getAsDataUrl(s.type)),u.destroy()}),u.once("error",function(e){t(e||!0),u.destroy()}),void n(u,e.source.size,function(){e._info&&u.info(e._info),e._meta&&u.meta(e._meta),u.loadFromBlob(e.source)})):void t(!0)},beforeSendFile:function(t){var n,a,o=this.options.compress||this.options.resize,s=o&&o.compressSize||0,u=o&&o.noCompressIfLarger||!1;if(t=this.request("get-file",t),o&&~"image/jpeg,image/jpg".indexOf(t.type)&&!(t.size<s)&&!t._compressed)return o=r.extend({},o),a=e.Deferred(),n=new i(o),a.always(function(){n.destroy(),n=null}),n.once("error",a.reject),n.once("load",function(){var e=o.width,i=o.height;t._info=t._info||n.info(),t._meta=t._meta||n.meta(),e<=1&&e>0&&(e=t._info.width*e),i<=1&&i>0&&(i=t._info.height*i),n.resize(e,i)}),n.once("complete",function(){var e,i;try{e=n.getAsBlob(o.type),i=t.size,(!u||e.size<i)&&(t.source=e,t.size=e.size,t.trigger("resize",e.size,i)),t._compressed=!0,a.resolve()}catch(r){a.resolve()}}),t._info&&n.info(t._info),t._meta&&n.meta(t._meta),n.loadFromBlob(t.source),a.promise()}})}),t("file",["base","mediator"],function(e,t){function i(){return a+o++}function n(e){this.name=e.name||"Untitled",this.size=e.size||0,this.type=e.type||"application/octet-stream",this.lastModifiedDate=e.lastModifiedDate||1*new Date,this.id=i(),this.ext=s.exec(this.name)?RegExp.$1:"",this.statusText="",u[this.id]=n.Status.INITED,this.source=e,this.loaded=0,this.on("error",function(e){this.setStatus(n.Status.ERROR,e)})}var r=e.$,a="WU_FILE_",o=0,s=/\.([^.]+)$/,u={};return r.extend(n.prototype,{setStatus:function(e,t){var i=u[this.id];"undefined"!=typeof t&&(this.statusText=t),e!==i&&(u[this.id]=e,this.trigger("statuschange",e,i))},getStatus:function(){return u[this.id]},getSource:function(){return this.source},destroy:function(){this.off(),delete u[this.id]}}),t.installTo(n.prototype),n.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"},n}),t("queue",["base","mediator","file"],function(e,t,i){function n(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0,numofDeleted:0,numofInterrupt:0},this._queue=[],this._map={}}var r=e.$,a=i.Status;return r.extend(n.prototype,{append:function(e){return this._queue.push(e),this._fileAdded(e),this},prepend:function(e){return this._queue.unshift(e),this._fileAdded(e),this},getFile:function(e){return"string"!=typeof e?e:this._map[e]},fetch:function(e){var t,i,n=this._queue.length;for(e=e||a.QUEUED,t=0;t<n;t++)if(i=this._queue[t],e===i.getStatus())return i;return null},sort:function(e){"function"==typeof e&&this._queue.sort(e)},getFiles:function(){for(var e,t=[].slice.call(arguments,0),i=[],n=0,a=this._queue.length;n<a;n++)e=this._queue[n],t.length&&!~r.inArray(e.getStatus(),t)||i.push(e);return i},removeFile:function(e){var t=this._map[e.id];t&&(delete this._map[e.id],e.destroy(),this.stats.numofDeleted++)},_fileAdded:function(e){var t=this,i=this._map[e.id];i||(this._map[e.id]=e,e.on("statuschange",function(e,i){t._onFileStatusChange(e,i)}))},_onFileStatusChange:function(e,t){var i=this.stats;switch(t){case a.PROGRESS:i.numOfProgress--;break;case a.QUEUED:i.numOfQueue--;break;case a.ERROR:i.numOfUploadFailed--;break;case a.INVALID:i.numOfInvalid--;break;case a.INTERRUPT:i.numofInterrupt--}switch(e){case a.QUEUED:i.numOfQueue++;break;case a.PROGRESS:i.numOfProgress++;break;case a.ERROR:i.numOfUploadFailed++;break;case a.COMPLETE:i.numOfSuccess++;break;case a.CANCELLED:i.numOfCancel++;break;case a.INVALID:i.numOfInvalid++;break;case a.INTERRUPT:i.numofInterrupt++}}}),t.installTo(n.prototype),n}),t("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(e,t,i,n,r,a){var o=e.$,s=/\.\w+$/,u=n.Status;return t.register({name:"queue",init:function(t){var n,r,s,u,c,l,h,d=this;if(o.isPlainObject(t.accept)&&(t.accept=[t.accept]),t.accept){for(c=[],s=0,r=t.accept.length;s<r;s++)u=t.accept[s].extensions,u&&c.push(u);c.length&&(l="\\."+c.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"),d.accept=new RegExp(l,"i")}if(d.queue=new i,d.stats=d.queue.stats,"html5"===this.request("predict-runtime-type"))return n=e.Deferred(),this.placeholder=h=new a("Placeholder"),h.connectRuntime({runtimeOrder:"html5"},function(){d._ruid=h.getRuid(),n.resolve()}),n.promise()},_wrapFile:function(e){if(!(e instanceof n)){if(!(e instanceof r)){if(!this._ruid)throw new Error("Can't add external files.");e=new r(this._ruid,e)}e=new n(e)}return e},acceptFile:function(e){var t=!e||!e.size||this.accept&&s.exec(e.name)&&!this.accept.test(e.name);return!t},_addFile:function(e){var t=this;if(e=t._wrapFile(e),t.owner.trigger("beforeFileQueued",e))return t.acceptFile(e)?(t.queue.append(e),t.owner.trigger("fileQueued",e),e):void t.owner.trigger("error","Q_TYPE_DENIED",e)},getFile:function(e){return this.queue.getFile(e)},addFile:function(e){var t=this;e.length||(e=[e]),e=o.map(e,function(e){return t._addFile(e)}),t.owner.trigger("filesQueued",e),t.options.auto&&setTimeout(function(){t.request("start-upload")},20)},getStats:function(){return this.stats},removeFile:function(e,t){var i=this;e=e.id?e:i.queue.getFile(e),this.request("cancel-file",e),t&&this.queue.removeFile(e)},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(e,t){var i,n,r,a=this;if(e)return e=e.id?e:a.queue.getFile(e),e.setStatus(u.QUEUED),void(t||a.request("start-upload"));for(i=a.queue.getFiles(u.ERROR),n=0,r=i.length;n<r;n++)e=i[n],e.setStatus(u.QUEUED);a.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.owner.trigger("reset"),this.queue=new i,this.stats=this.queue.stats},destroy:function(){this.reset(),this.placeholder&&this.placeholder.destroy()}})}),t("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(e,t){return e.support=function(){return t.hasRuntime.apply(t,arguments)},e.register({name:"runtime",init:function(){if(!this.predictRuntimeType())throw Error("Runtime Error")},predictRuntimeType:function(){var e,i,n=this.options.runtimeOrder||t.orders,r=this.type;if(!r)for(n=n.split(/\s*,\s*/g),e=0,i=n.length;e<i;e++)if(t.hasRuntime(n[e])){this.type=r=n[e];break}return r}})}),t("lib/transport",["base","runtime/client","mediator"],function(e,t,i){function n(e){var i=this;e=i.options=r.extend(!0,{},n.options,e||{}),t.call(this,"Transport"),this._blob=null,this._formData=e.formData||{},this._headers=e.headers||{},this.on("progress",this._timeout),this.on("load error",function(){i.trigger("progress",1),clearTimeout(i._timer)})}var r=e.$;return n.options={server:"",method:"POST",withCredentials:!1,fileVal:"file",timeout:12e4,formData:{},headers:{},sendAsBinary:!1},r.extend(n.prototype,{appendBlob:function(e,t,i){var n=this,r=n.options;n.getRuid()&&n.disconnectRuntime(),n.connectRuntime(t.ruid,function(){n.exec("init")}),n._blob=t,r.fileVal=e||r.fileVal,r.filename=i||r.filename},append:function(e,t){"object"==typeof e?r.extend(this._formData,e):this._formData[e]=t},setRequestHeader:function(e,t){"object"==typeof e?r.extend(this._headers,e):this._headers[e]=t},send:function(e){this.exec("send",e),this._timeout()},abort:function(){return clearTimeout(this._timer),this.exec("abort")},destroy:function(){this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var e=this,t=e.options.timeout;t&&(clearTimeout(e._timer),e._timer=setTimeout(function(){e.abort(),e.trigger("error","timeout")},t))}}),i.installTo(n.prototype),n}),t("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(e,t,i,n){function r(e,t){var i,n,r=[],a=e.source,o=a.size,s=t?Math.ceil(o/t):1,u=0,c=0;for(n={file:e,has:function(){return!!r.length},shift:function(){return r.shift()},unshift:function(e){r.unshift(e)}};c<s;)i=Math.min(t,o-u),r.push({file:e,start:u,end:t?u+i:o,total:o,chunks:s,chunk:c++,cuted:n}),u+=i;return e.blocks=r.concat(),e.remaning=r.length,n}var a=e.$,o=e.isPromise,s=i.Status;a.extend(t.options,{prepareNextFile:!1,chunked:!1,chunkSize:5242880,chunkRetry:2,threads:3,formData:{}}),t.register({name:"upload",init:function(){var t=this.owner,i=this;this.runing=!1,this.progress=!1,t.on("startUpload",function(){i.progress=!0}).on("uploadFinished",function(){i.progress=!1}),this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this.__tick=e.bindFn(this._tick,this),t.on("uploadComplete",function(e){e.blocks&&a.each(e.blocks,function(e,t){t.transport&&(t.transport.abort(),t.transport.destroy()),delete t.transport}),delete e.blocks,delete e.remaning})},reset:function(){this.request("stop-upload",!0),this.runing=!1,this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this._trigged=!1,this._promise=null},startUpload:function(t){var i=this;if(a.each(i.request("get-files",s.INVALID),function(){i.request("remove-file",this)}),t)if(t=t.id?t:i.request("get-file",t),t.getStatus()===s.INTERRUPT)a.each(i.pool,function(e,i){i.file===t&&i.transport&&i.transport.send()}),t.setStatus(s.QUEUED);else{if(t.getStatus()===s.PROGRESS)return;t.setStatus(s.QUEUED)}else a.each(i.request("get-files",[s.INITED]),function(){this.setStatus(s.QUEUED)});if(!i.runing){i.runing=!0;var n=[];a.each(i.pool,function(e,t){var r=t.file;r.getStatus()===s.INTERRUPT&&(n.push(r),i._trigged=!1,t.transport&&t.transport.send())});for(var t;t=n.shift();)t.setStatus(s.PROGRESS);t||a.each(i.request("get-files",s.INTERRUPT),function(){this.setStatus(s.PROGRESS)}),i._trigged=!1,e.nextTick(i.__tick),i.owner.trigger("startUpload")}},stopUpload:function(t,i){var n=this;if(t===!0&&(i=t,t=null),n.runing!==!1){if(t){if(t=t.id?t:n.request("get-file",t),t.getStatus()!==s.PROGRESS&&t.getStatus()!==s.QUEUED)return;return t.setStatus(s.INTERRUPT),a.each(n.pool,function(e,i){i.file===t&&(i.transport&&i.transport.abort(),n._putback(i),n._popBlock(i))}),e.nextTick(n.__tick)}n.runing=!1,this._promise&&this._promise.file&&this._promise.file.setStatus(s.INTERRUPT),i&&a.each(n.pool,function(e,t){t.transport&&t.transport.abort(),t.file.setStatus(s.INTERRUPT)}),n.owner.trigger("stopUpload")}},cancelFile:function(e){e=e.id?e:this.request("get-file",e),e.blocks&&a.each(e.blocks,function(e,t){var i=t.transport;i&&(i.abort(),i.destroy(),delete t.transport)}),e.setStatus(s.CANCELLED),this.owner.trigger("fileDequeued",e)},isInProgress:function(){return!!this.progress},_getStats:function(){return this.request("get-stats")},skipFile:function(e,t){e=e.id?e:this.request("get-file",e),e.setStatus(t||s.COMPLETE),e.skipped=!0,e.blocks&&a.each(e.blocks,function(e,t){var i=t.transport;i&&(i.abort(),i.destroy(),delete t.transport)}),this.owner.trigger("uploadSkip",e)},_tick:function(){var t,i,n=this,r=n.options;return n._promise?n._promise.always(n.__tick):void(n.pool.length<r.threads&&(i=n._nextBlock())?(n._trigged=!1,t=function(t){n._promise=null,t&&t.file&&n._startSend(t),e.nextTick(n.__tick)},n._promise=o(i)?i.always(t):t(i)):n.remaning||n._getStats().numOfQueue||n._getStats().numofInterrupt||(n.runing=!1,n._trigged||e.nextTick(function(){n.owner.trigger("uploadFinished")}),n._trigged=!0))},_putback:function(e){var t;e.cuted.unshift(e),t=this.stack.indexOf(e.cuted),~t||this.stack.unshift(e.cuted)},_getStack:function(){for(var e,t=0;e=this.stack[t++];){if(e.has()&&e.file.getStatus()===s.PROGRESS)return e;(!e.has()||e.file.getStatus()!==s.PROGRESS&&e.file.getStatus()!==s.INTERRUPT)&&this.stack.splice(--t,1)}return null},_nextBlock:function(){var e,t,i,n,a=this,s=a.options;return(e=this._getStack())?(s.prepareNextFile&&!a.pending.length&&a._prepareNextFile(),e.shift()):a.runing?(!a.pending.length&&a._getStats().numOfQueue&&a._prepareNextFile(),t=a.pending.shift(),i=function(t){return t?(e=r(t,s.chunked?s.chunkSize:0),a.stack.push(e),e.shift()):null},o(t)?(n=t.file,t=t[t.pipe?"pipe":"then"](i),t.file=n,t):i(t)):void 0},_prepareNextFile:function(){var e,t=this,i=t.request("fetch-file"),n=t.pending;i&&(e=t.request("before-send-file",i,function(){return i.getStatus()===s.PROGRESS||i.getStatus()===s.INTERRUPT?i:t._finishFile(i)}),t.owner.trigger("uploadStart",i),i.setStatus(s.PROGRESS),e.file=i,e.done(function(){var t=a.inArray(e,n);~t&&n.splice(t,1,i)}),e.fail(function(e){i.setStatus(s.ERROR,e),t.owner.trigger("uploadError",i,e),t.owner.trigger("uploadComplete",i)}),n.push(e))},_popBlock:function(e){var t=a.inArray(e,this.pool);this.pool.splice(t,1),e.file.remaning--,this.remaning--},_startSend:function(t){var i,n=this,r=t.file;return r.getStatus()!==s.PROGRESS?void(r.getStatus()===s.INTERRUPT&&n._putback(t)):(n.pool.push(t),n.remaning++,t.blob=1===t.chunks?r.source:r.source.slice(t.start,t.end),i=n.request("before-send",t,function(){r.getStatus()===s.PROGRESS?n._doSend(t):(n._popBlock(t),e.nextTick(n.__tick))}),void i.fail(function(){1===r.remaning?n._finishFile(r).always(function(){t.percentage=1,n._popBlock(t),n.owner.trigger("uploadComplete",r),e.nextTick(n.__tick)}):(t.percentage=1,n.updateFileProgress(r),n._popBlock(t),e.nextTick(n.__tick))}))},_doSend:function(t){var i,r,o=this,u=o.owner,c=o.options,l=t.file,h=new n(c),d=a.extend({},c.formData),f=a.extend({},c.headers);t.transport=h,h.on("destroy",function(){delete t.transport,o._popBlock(t),e.nextTick(o.__tick)}),h.on("progress",function(e){t.percentage=e,o.updateFileProgress(l)}),i=function(e){var i;return r=h.getResponseAsJson()||{},r._raw=h.getResponse(),i=function(t){e=t},u.trigger("uploadAccept",t,r,i)||(e=e||"server"),e},h.on("error",function(e,n){t.retried=t.retried||0,t.chunks>1&&~"http,abort".indexOf(e)&&t.retried<c.chunkRetry?(t.retried++,h.send()):(n||"server"!==e||(e=i(e)),l.setStatus(s.ERROR,e),u.trigger("uploadError",l,e),u.trigger("uploadComplete",l))}),h.on("load",function(){var e;return(e=i())?void h.trigger("error",e,!0):void(1===l.remaning?o._finishFile(l,r):h.destroy())}),d=a.extend(d,{id:l.id,name:l.name,type:l.type,lastModifiedDate:l.lastModifiedDate,size:l.size}),t.chunks>1&&a.extend(d,{chunks:t.chunks,chunk:t.chunk}),u.trigger("uploadBeforeSend",t,d,f),h.appendBlob(c.fileVal,t.blob,l.name),h.append(d),h.setRequestHeader(f),h.send()},_finishFile:function(e,t,i){var n=this.owner;return n.request("after-send-file",arguments,function(){e.setStatus(s.COMPLETE),n.trigger("uploadSuccess",e,t,i)}).fail(function(t){e.getStatus()===s.PROGRESS&&e.setStatus(s.ERROR,t),n.trigger("uploadError",e,t)}).always(function(){n.trigger("uploadComplete",e)})},updateFileProgress:function(e){var t=0,i=0;e.blocks&&(a.each(e.blocks,function(e,t){i+=(t.percentage||0)*(t.end-t.start)}),t=i/e.size,this.owner.trigger("uploadProgress",e,t||0))}})}),t("widgets/validator",["base","uploader","file","widgets/widget"],function(e,t,i){var n,r=e.$,a={};return n={addValidator:function(e,t){a[e]=t},removeValidator:function(e){delete a[e]}},t.register({name:"validator",init:function(){var t=this;e.nextTick(function(){r.each(a,function(){this.call(t.owner)})})}}),n.addValidator("fileNumLimit",function(){var e=this,t=e.options,i=0,n=parseInt(t.fileNumLimit,10),r=!0;n&&(e.on("beforeFileQueued",function(e){return i>=n&&r&&(r=!1,this.trigger("error","Q_EXCEED_NUM_LIMIT",n,e),setTimeout(function(){r=!0},1)),!(i>=n)}),e.on("fileQueued",function(){i++}),e.on("fileDequeued",function(){i--}),e.on("reset",function(){i=0}))}),n.addValidator("fileSizeLimit",function(){var e=this,t=e.options,i=0,n=parseInt(t.fileSizeLimit,10),r=!0;n&&(e.on("beforeFileQueued",function(e){var t=i+e.size>n;return t&&r&&(r=!1,this.trigger("error","Q_EXCEED_SIZE_LIMIT",n,e),setTimeout(function(){r=!0},1)),!t}),e.on("fileQueued",function(e){i+=e.size}),e.on("fileDequeued",function(e){i-=e.size}),e.on("reset",function(){i=0}))}),n.addValidator("fileSingleSizeLimit",function(){var e=this,t=e.options,n=t.fileSingleSizeLimit;n&&e.on("beforeFileQueued",function(e){if(e.size>n)return e.setStatus(i.Status.INVALID,"exceed_size"),this.trigger("error","F_EXCEED_SIZE",n,e),!1})}),n.addValidator("duplicate",function(){function e(e){for(var t,i=0,n=0,r=e.length;n<r;n++)t=e.charCodeAt(n),i=t+(i<<6)+(i<<16)-i;return i}var t=this,i=t.options,n={};i.duplicate||(t.on("beforeFileQueued",function(t){var i=t.__hash||(t.__hash=e(t.name+t.size+t.lastModifiedDate));if(n[i])return this.trigger("error","F_DUPLICATE",t),!1}),t.on("fileQueued",function(e){var t=e.__hash;t&&(n[t]=!0)}),t.on("fileDequeued",function(e){var t=e.__hash;t&&delete n[t]}),t.on("reset",function(){n={}}))}),n}),t("lib/md5",["runtime/client","mediator"],function(e,t){function i(){e.call(this,"Md5")}return t.installTo(i.prototype),i.prototype.loadFromBlob=function(e){var t=this;t.getRuid()&&t.disconnectRuntime(),t.connectRuntime(e.ruid,function(){t.exec("init"),t.exec("loadFromBlob",e)})},i.prototype.getResult=function(){return this.exec("getResult")},i}),t("widgets/md5",["base","uploader","lib/md5","lib/blob","widgets/widget"],function(e,t,i,n){return t.register({name:"md5",md5File:function(t,r,a){var o=new i,s=e.Deferred(),u=t instanceof n?t:this.request("get-file",t).source;return o.on("progress load",function(e){e=e||{},s.notify(e.total?e.loaded/e.total:1)}),o.on("complete",function(){s.resolve(o.getResult())}),o.on("error",function(e){s.reject(e)}),arguments.length>1&&(r=r||0,a=a||0,r<0&&(r=u.size+r),a<0&&(a=u.size+a),a=Math.min(a,u.size),u=u.slice(r,a)),o.loadFromBlob(u),s.promise()}})}),t("runtime/compbase",[],function(){function e(e,t){this.owner=e,this.options=e.options,this.getRuntime=function(){return t},this.getRuid=function(){return t.uid},this.trigger=function(){return e.trigger.apply(e,arguments)}}return e}),t("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(t,i,n){function r(){var e={},n=this,r=this.destroy;i.apply(n,arguments),n.type=a,n.exec=function(i,r){var a,s=this,u=s.uid,c=t.slice(arguments,2);if(o[i]&&(a=e[u]=e[u]||new o[i](s,n),a[r]))return a[r].apply(a,c)},n.destroy=function(){return r&&r.apply(this,arguments)}}var a="html5",o={};return t.inherits(i,{constructor:r,init:function(){var e=this;setTimeout(function(){e.trigger("ready")},1)}}),r.register=function(e,i){var r=o[e]=t.inherits(n,i);return r},e.Blob&&e.FileReader&&e.DataView&&i.addRuntime(a,r),r}),t("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(e,t){return e.register("Blob",{slice:function(e,i){var n=this.owner.source,r=n.slice||n.webkitSlice||n.mozSlice;return n=r.call(n,e,i),new t(this.getRuid(),n)}})}),t("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(e,t,i){var n=e.$,r="webuploader-dnd-";return t.register("DragAndDrop",{init:function(){var t=this.elem=this.options.container;this.dragEnterHandler=e.bindFn(this._dragEnterHandler,this),this.dragOverHandler=e.bindFn(this._dragOverHandler,this),this.dragLeaveHandler=e.bindFn(this._dragLeaveHandler,this),this.dropHandler=e.bindFn(this._dropHandler,this),this.dndOver=!1,t.on("dragenter",this.dragEnterHandler),t.on("dragover",this.dragOverHandler),t.on("dragleave",this.dragLeaveHandler),t.on("drop",this.dropHandler),this.options.disableGlobalDnd&&(n(document).on("dragover",this.dragOverHandler),n(document).on("drop",this.dropHandler))},_dragEnterHandler:function(e){var t,i=this,n=i._denied||!1;return e=e.originalEvent||e,i.dndOver||(i.dndOver=!0,t=e.dataTransfer.items,t&&t.length&&(i._denied=n=!i.trigger("accept",t)),i.elem.addClass(r+"over"),i.elem[n?"addClass":"removeClass"](r+"denied")),e.dataTransfer.dropEffect=n?"none":"copy",!1},_dragOverHandler:function(e){var t=this.elem.parent().get(0);return!(t&&!n.contains(t,e.currentTarget))&&(clearTimeout(this._leaveTimer),this._dragEnterHandler.call(this,e),!1)},_dragLeaveHandler:function(){var e,t=this;return e=function(){t.dndOver=!1,t.elem.removeClass(r+"over "+r+"denied")},clearTimeout(t._leaveTimer),t._leaveTimer=setTimeout(e,100),!1},_dropHandler:function(e){var t,a,o=this,s=o.getRuid(),u=o.elem.parent().get(0);if(u&&!n.contains(u,e.currentTarget))return!1;e=e.originalEvent||e,t=e.dataTransfer;try{a=t.getData("text/html")}catch(c){}return a?void 0:(o._getTansferFiles(t,function(e){o.trigger("drop",n.map(e,function(e){return new i(s,e)}))}),o.dndOver=!1,o.elem.removeClass(r+"over"),!1)},_getTansferFiles:function(t,i){var n,r,a,o,s,u,c,l=[],h=[];for(n=t.items,r=t.files,c=!(!n||!n[0].webkitGetAsEntry),s=0,u=r.length;s<u;s++)a=r[s],o=n&&n[s],c&&o.webkitGetAsEntry().isDirectory?h.push(this._traverseDirectoryTree(o.webkitGetAsEntry(),l)):l.push(a);e.when.apply(e,h).done(function(){l.length&&i(l)})},_traverseDirectoryTree:function(t,i){var n=e.Deferred(),r=this;return t.isFile?t.file(function(e){i.push(e),n.resolve()}):t.isDirectory&&t.createReader().readEntries(function(t){var a,o=t.length,s=[],u=[];for(a=0;a<o;a++)s.push(r._traverseDirectoryTree(t[a],u));e.when.apply(e,s).then(function(){i.push.apply(i,u),n.resolve()},n.reject)}),n.promise()},destroy:function(){var e=this.elem;e&&(e.off("dragenter",this.dragEnterHandler),e.off("dragover",this.dragOverHandler),e.off("dragleave",this.dragLeaveHandler),e.off("drop",this.dropHandler),this.options.disableGlobalDnd&&(n(document).off("dragover",this.dragOverHandler),n(document).off("drop",this.dropHandler)))}})}),t("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(e,t,i){return t.register("FilePaste",{init:function(){var t,i,n,r,a=this.options,o=this.elem=a.container,s=".*";if(a.accept){for(t=[],i=0,n=a.accept.length;i<n;i++)r=a.accept[i].mimeTypes,r&&t.push(r);t.length&&(s=t.join(","),s=s.replace(/,/g,"|").replace(/\*/g,".*"))}this.accept=s=new RegExp(s,"i"),this.hander=e.bindFn(this._pasteHander,this),o.on("paste",this.hander)},_pasteHander:function(e){var t,n,r,a,o,s=[],u=this.getRuid();for(e=e.originalEvent||e,t=e.clipboardData.items,a=0,o=t.length;a<o;a++)n=t[a],"file"===n.kind&&(r=n.getAsFile())&&s.push(new i(u,r));s.length&&(e.preventDefault(),e.stopPropagation(),this.trigger("paste",s))},destroy:function(){this.elem.off("paste",this.hander)}})}),t("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(e,t){var i=e.$;return t.register("FilePicker",{init:function(){var e,t,n,r,a=this.getRuntime().getContainer(),o=this,s=o.owner,u=o.options,c=this.label=i(document.createElement("label")),l=this.input=i(document.createElement("input"));if(l.attr("type","file"),l.attr("name",u.name),l.addClass("webuploader-element-invisible"),c.on("click",function(){l.trigger("click")}),c.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"}),u.multiple&&l.attr("multiple","multiple"),u.accept&&u.accept.length>0){for(e=[],t=0,n=u.accept.length;t<n;t++)e.push(u.accept[t].mimeTypes);l.attr("accept",e.join(","))}a.append(l),a.append(c),r=function(e){s.trigger(e.type)},l.on("change",function(e){var t,n=arguments.callee;o.files=e.target.files,t=this.cloneNode(!0),t.value=null,this.parentNode.replaceChild(t,this),l.off(),l=i(t).on("change",n).on("mouseenter mouseleave",r),s.trigger("change")}),c.on("mouseenter mouseleave",r)},getFiles:function(){return this.files},destroy:function(){this.input.off(),this.label.off()}})}),t("runtime/html5/util",["base"],function(t){var i=e.createObjectURL&&e||e.URL&&URL.revokeObjectURL&&URL||e.webkitURL,n=t.noop,r=n;return i&&(n=function(){return i.createObjectURL.apply(i,arguments)},r=function(){return i.revokeObjectURL.apply(i,arguments)}),{createObjectURL:n,revokeObjectURL:r,dataURL2Blob:function(e){var t,i,n,r,a,o;for(o=e.split(","),t=~o[0].indexOf("base64")?atob(o[1]):decodeURIComponent(o[1]),n=new ArrayBuffer(t.length),i=new Uint8Array(n),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return a=o[0].split(":")[1].split(";")[0],this.arrayBufferToBlob(n,a)},dataURL2ArrayBuffer:function(e){var t,i,n,r;for(r=e.split(","),t=~r[0].indexOf("base64")?atob(r[1]):decodeURIComponent(r[1]),i=new Uint8Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i.buffer},arrayBufferToBlob:function(t,i){var n,r=e.BlobBuilder||e.WebKitBlobBuilder;return r?(n=new r,n.append(t),n.getBlob(i)):new Blob([t],i?{type:i}:{})},canvasToDataUrl:function(e,t,i){return e.toDataURL(t,i/100)},parseMeta:function(e,t){t(!1,{})},updateImageHead:function(e){return e}}}),t("runtime/html5/imagemeta",["runtime/html5/util"],function(e){var t;return t={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(e,t){var i=this,n=new FileReader;n.onload=function(){t(!1,i._parse(this.result)),n=n.onload=n.onerror=null},n.onerror=function(e){t(e.message),n=n.onload=n.onerror=null},e=e.slice(0,i.maxMetaDataSize),n.readAsArrayBuffer(e.getSource())},_parse:function(e,i){if(!(e.byteLength<6)){var n,r,a,o,s=new DataView(e),u=2,c=s.byteLength-4,l=u,h={};if(65496===s.getUint16(0)){for(;u<c&&(n=s.getUint16(u),n>=65504&&n<=65519||65534===n)&&(r=s.getUint16(u+2)+2,!(u+r>s.byteLength));){if(a=t.parsers[n],!i&&a)for(o=0;o<a.length;o+=1)a[o].call(t,s,u,r,h);u+=r,l=u}l>6&&(e.slice?h.imageHead=e.slice(2,l):h.imageHead=new Uint8Array(e).subarray(2,l))}return h}},updateImageHead:function(e,t){var i,n,r,a=this._parse(e,!0);return r=2,a.imageHead&&(r=2+a.imageHead.byteLength),n=e.slice?e.slice(r):new Uint8Array(e).subarray(r),i=new Uint8Array(t.byteLength+2+n.byteLength),i[0]=255,i[1]=216,i.set(new Uint8Array(t),2),i.set(new Uint8Array(n),t.byteLength+2),i.buffer}},e.parseMeta=function(){return t.parse.apply(t,arguments)},e.updateImageHead=function(){return t.updateImageHead.apply(t,arguments)},t}),t("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(e,t){var i={};return i.ExifMap=function(){return this},i.ExifMap.prototype.map={Orientation:274},i.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},i.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}},i.exifTagTypes[7]=i.exifTagTypes[1],i.getExifValue=function(t,n,r,a,o,s){var u,c,l,h,d,f,p=i.exifTagTypes[a];if(!p)return void e.log("Invalid Exif data: Invalid tag type.");if(u=p.size*o,c=u>4?n+t.getUint32(r+8,s):r+8,c+u>t.byteLength)return void e.log("Invalid Exif data: Invalid data offset.");if(1===o)return p.getValue(t,c,s);for(l=[],h=0;h<o;h+=1)l[h]=p.getValue(t,c+h*p.size,s);if(p.ascii){for(d="",h=0;h<l.length&&(f=l[h],"\0"!==f);h+=1)d+=f;return d}return l},i.parseExifTag=function(e,t,n,r,a){var o=e.getUint16(n,r);a.exif[o]=i.getExifValue(e,t,n,e.getUint16(n+2,r),e.getUint32(n+4,r),r)},i.parseExifTags=function(t,i,n,r,a){var o,s,u;if(n+6>t.byteLength)return void e.log("Invalid Exif data: Invalid directory offset.");if(o=t.getUint16(n,r),s=n+2+12*o,s+4>t.byteLength)return void e.log("Invalid Exif data: Invalid directory size.");for(u=0;u<o;u+=1)this.parseExifTag(t,i,n+2+12*u,r,a);return t.getUint32(s,r)},i.parseExifData=function(t,n,r,a){var o,s,u=n+10;if(1165519206===t.getUint32(n+4)){if(u+8>t.byteLength)return void e.log("Invalid Exif data: Invalid segment size.");if(0!==t.getUint16(n+8))return void e.log("Invalid Exif data: Missing byte alignment offset.");switch(t.getUint16(u)){case 18761:o=!0;break;case 19789:o=!1;break;default:return void e.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==t.getUint16(u+2,o))return void e.log("Invalid Exif data: Missing TIFF marker.");s=t.getUint32(u+4,o),a.exif=new i.ExifMap,s=i.parseExifTags(t,u,u+s,o,a)}},t.parsers[65505].push(i.parseExifData),i}),t("runtime/html5/jpegencoder",[],function(e,t,i){function n(e){function t(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var n=R((t[i]*e+50)/100);n<1?n=1:n>255&&(n=255),D[q[i]]=n}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a=0;a<64;a++){var o=R((r[a]*e+50)/100);o<1?o=1:o>255&&(o=255),S[q[a]]=o}for(var s=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],u=0,c=0;c<8;c++)for(var l=0;l<8;l++)k[u]=1/(D[q[u]]*s[c]*s[l]*8),T[u]=1/(S[q[u]]*s[c]*s[l]*8),u++}function i(e,t){for(var i=0,n=0,r=new Array,a=1;a<=16;a++){for(var o=1;o<=e[a];o++)r[t[n]]=[],r[t[n]][0]=i,r[t[n]][1]=a,n++,i++;i*=2}return r}function n(){w=i(z,j),x=i(G,V),b=i(Y,$),_=i(W,X)}function r(){for(var e=1,t=2,i=1;i<=15;i++){for(var n=e;n<t;n++)A[32767+n]=i,I[32767+n]=[],I[32767+n][1]=i,I[32767+n][0]=n;for(var r=-(t-1);r<=-e;r++)A[32767+r]=i,I[32767+r]=[],I[32767+r][1]=i,I[32767+r][0]=t-1+r;e<<=1,t<<=1}}function a(){for(var e=0;e<256;e++)H[e]=19595*e,H[e+256>>0]=38470*e,H[e+512>>0]=7471*e+32768,H[e+768>>0]=-11059*e,H[e+1024>>0]=-21709*e,H[e+1280>>0]=32768*e+8421375,H[e+1536>>0]=-27439*e,H[e+1792>>0]=-5329*e}function o(e){for(var t=e[0],i=e[1]-1;i>=0;)t&1<<i&&(L|=1<<F),i--,F--,F<0&&(255==L?(s(255),s(0)):s(L),F=7,L=0)}function s(e){M.push(U[e])}function u(e){s(e>>8&255),s(255&e)}function c(e,t){var i,n,r,a,o,s,u,c,l,h=0,d=8,f=64;for(l=0;l<d;++l){i=e[h],n=e[h+1],r=e[h+2],a=e[h+3],o=e[h+4],s=e[h+5],u=e[h+6],c=e[h+7];var p=i+c,m=i-c,g=n+u,v=n-u,y=r+s,w=r-s,x=a+o,b=a-o,_=p+x,E=p-x,R=g+y,D=g-y;e[h]=_+R,e[h+4]=_-R;var S=.707106781*(D+E);e[h+2]=E+S,e[h+6]=E-S,_=b+w,R=w+v,D=v+m;var k=.382683433*(_-D),T=.5411961*_+k,I=1.306562965*D+k,A=.707106781*R,O=m+A,M=m-A;e[h+5]=M+T,e[h+3]=M-T,e[h+1]=O+I,e[h+7]=O-I,h+=8}for(h=0,l=0;l<d;++l){i=e[h],n=e[h+8],r=e[h+16],a=e[h+24],o=e[h+32],s=e[h+40],u=e[h+48],c=e[h+56];var L=i+c,F=i-c,P=n+u,N=n-u,B=r+s,U=r-s,H=a+o,q=a-o,z=L+H,j=L-H,Y=P+B,$=P-B;e[h]=z+Y,e[h+32]=z-Y;var G=.707106781*($+j);e[h+16]=j+G,e[h+48]=j-G,z=q+U,Y=U+N,$=N+F;var V=.382683433*(z-$),W=.5411961*z+V,X=1.306562965*$+V,Q=.707106781*Y,J=F+Q,Z=F-Q;e[h+40]=Z+W,e[h+24]=Z-W,e[h+8]=J+X,e[h+56]=J-X,h++}var K;for(l=0;l<f;++l)K=e[l]*t[l],C[l]=K>0?K+.5|0:K-.5|0;return C}function l(){u(65504),u(16),s(74),s(70),s(73),s(70),s(0),s(1),s(1),s(0),u(1),u(1),s(0),s(0)}function h(e,t){u(65472),u(17),s(8),u(t),u(e),s(3),s(1),s(17),s(0),s(2),s(17),s(1),s(3),s(17),s(1)}function d(){u(65499),u(132),s(0);for(var e=0;e<64;e++)s(D[e]);s(1);for(var t=0;t<64;t++)s(S[t])}function f(){u(65476),u(418),s(0);for(var e=0;e<16;e++)s(z[e+1]);for(var t=0;t<=11;t++)s(j[t]);s(16);for(var i=0;i<16;i++)s(Y[i+1]);for(var n=0;n<=161;n++)s($[n]);s(1);for(var r=0;r<16;r++)s(G[r+1]);for(var a=0;a<=11;a++)s(V[a]);s(17);for(var o=0;o<16;o++)s(W[o+1]);for(var c=0;c<=161;c++)s(X[c])}function p(){u(65498),u(12),s(3),s(1),s(0),s(2),s(17),s(3),s(17),s(0),s(63),s(0)}function m(e,t,i,n,r){for(var a,s=r[0],u=r[240],l=16,h=63,d=64,f=c(e,t),p=0;p<d;++p)O[q[p]]=f[p];var m=O[0]-i;i=O[0],0==m?o(n[0]):(a=32767+m,o(n[A[a]]),o(I[a]));for(var g=63;g>0&&0==O[g];g--);if(0==g)return o(s),i;for(var v,y=1;y<=g;){for(var w=y;0==O[y]&&y<=g;++y);var x=y-w;if(x>=l){v=x>>4;for(var b=1;b<=v;++b)o(u);x=15&x}a=32767+O[y],o(r[(x<<4)+A[a]]),o(I[a]),y++}return g!=h&&o(s),i}function g(){
for(var e=String.fromCharCode,t=0;t<256;t++)U[t]=e(t)}function v(e){if(e<=0&&(e=1),e>100&&(e=100),E!=e){var i=0;i=e<50?Math.floor(5e3/e):Math.floor(200-2*e),t(i),E=e}}function y(){e||(e=50),g(),n(),r(),a(),v(e)}var w,x,b,_,E,R=(Math.round,Math.floor),D=new Array(64),S=new Array(64),k=new Array(64),T=new Array(64),I=new Array(65535),A=new Array(65535),C=new Array(64),O=new Array(64),M=[],L=0,F=7,P=new Array(64),N=new Array(64),B=new Array(64),U=new Array(256),H=new Array(2048),q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],z=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],$=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],G=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],X=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(e,t){t&&v(t),M=new Array,L=0,F=7,u(65496),l(),d(),h(e.width,e.height),f(),p();var i=0,n=0,r=0;L=0,F=7,this.encode.displayName="_encode_";for(var a,s,c,g,y,E,R,D,S,I=e.data,A=e.width,C=e.height,O=4*A,U=0;U<C;){for(a=0;a<O;){for(y=O*U+a,E=y,R=-1,D=0,S=0;S<64;S++)D=S>>3,R=4*(7&S),E=y+D*O+R,U+D>=C&&(E-=O*(U+1+D-C)),a+R>=O&&(E-=a+R-O+4),s=I[E++],c=I[E++],g=I[E++],P[S]=(H[s]+H[c+256>>0]+H[g+512>>0]>>16)-128,N[S]=(H[s+768>>0]+H[c+1024>>0]+H[g+1280>>0]>>16)-128,B[S]=(H[s+1280>>0]+H[c+1536>>0]+H[g+1792>>0]>>16)-128;i=m(P,k,i,w,b),n=m(N,T,n,x,_),r=m(B,T,r,x,_),a+=32}U+=8}if(F>=0){var q=[];q[1]=F+1,q[0]=(1<<F+1)-1,o(q)}u(65497);var z="data:image/jpeg;base64,"+btoa(M.join(""));return M=[],z},y()}return n.encode=function(e,t){var i=new n(t);return i.encode(e)},n}),t("runtime/html5/androidpatch",["runtime/html5/util","runtime/html5/jpegencoder","base"],function(e,t,i){var n,r=e.canvasToDataUrl;e.canvasToDataUrl=function(e,a,o){var s,u,c,l,h;return i.os.android?("image/jpeg"===a&&"undefined"==typeof n&&(l=r.apply(null,arguments),h=l.split(","),l=~h[0].indexOf("base64")?atob(h[1]):decodeURIComponent(h[1]),l=l.substring(0,2),n=255===l.charCodeAt(0)&&216===l.charCodeAt(1)),"image/jpeg"!==a||n?r.apply(null,arguments):(u=e.width,c=e.height,s=e.getContext("2d"),t.encode(s.getImageData(0,0,u,c),o))):r.apply(null,arguments)}}),t("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(e,t,i){var n="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";return t.register("Image",{modified:!1,init:function(){var e=this,t=new Image;t.onload=function(){e._info={type:e.type,width:this.width,height:this.height},e._metas||"image/jpeg"!==e.type?e.owner.trigger("load"):i.parseMeta(e._blob,function(t,i){e._metas=i,e.owner.trigger("load")})},t.onerror=function(){e.owner.trigger("error")},e._img=t},loadFromBlob:function(e){var t=this,n=t._img;t._blob=e,t.type=e.type,n.src=i.createObjectURL(e.getSource()),t.owner.once("load",function(){i.revokeObjectURL(n.src)})},resize:function(e,t){var i=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,i,e,t),this._blob=null,this.modified=!0,this.owner.trigger("complete","resize")},crop:function(e,t,i,n,r){var a=this._canvas||(this._canvas=document.createElement("canvas")),o=this.options,s=this._img,u=s.naturalWidth,c=s.naturalHeight,l=this.getOrientation();r=r||1,a.width=i,a.height=n,o.preserveHeaders||this._rotate2Orientaion(a,l),this._renderImageToCanvas(a,s,-e,-t,u*r,c*r),this._blob=null,this.modified=!0,this.owner.trigger("complete","crop")},getAsBlob:function(e){var t,n=this._blob,r=this.options;if(e=e||this.type,this.modified||this.type!==e){if(t=this._canvas,"image/jpeg"===e){if(n=i.canvasToDataUrl(t,e,r.quality),r.preserveHeaders&&this._metas&&this._metas.imageHead)return n=i.dataURL2ArrayBuffer(n),n=i.updateImageHead(n,this._metas.imageHead),n=i.arrayBufferToBlob(n,e)}else n=i.canvasToDataUrl(t,e);n=i.dataURL2Blob(n)}return n},getAsDataUrl:function(e){var t=this.options;return e=e||this.type,"image/jpeg"===e?i.canvasToDataUrl(this._canvas,e,t.quality):this._canvas.toDataURL(e)},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},info:function(e){return e?(this._info=e,this):this._info},meta:function(e){return e?(this._meta=e,this):this._meta},destroy:function(){var e=this._canvas;this._img.onload=null,e&&(e.getContext("2d").clearRect(0,0,e.width,e.height),e.width=e.height=0,this._canvas=null),this._img.src=n,this._img=this._blob=null},_resize:function(e,t,i,n){var r,a,o,s,u,c=this.options,l=e.width,h=e.height,d=this.getOrientation();~[5,6,7,8].indexOf(d)&&(i^=n,n^=i,i^=n),r=Math[c.crop?"max":"min"](i/l,n/h),c.allowMagnify||(r=Math.min(1,r)),a=l*r,o=h*r,c.crop?(t.width=i,t.height=n):(t.width=a,t.height=o),s=(t.width-a)/2,u=(t.height-o)/2,c.preserveHeaders||this._rotate2Orientaion(t,d),this._renderImageToCanvas(t,e,s,u,a,o)},_rotate2Orientaion:function(e,t){var i=e.width,n=e.height,r=e.getContext("2d");switch(t){case 5:case 6:case 7:case 8:e.width=n,e.height=i}switch(t){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,n),r.rotate(Math.PI);break;case 4:r.translate(0,n),r.scale(1,-1);break;case 5:r.rotate(.5*Math.PI),r.scale(1,-1);break;case 6:r.rotate(.5*Math.PI),r.translate(0,-n);break;case 7:r.rotate(.5*Math.PI),r.translate(i,-n),r.scale(-1,1);break;case 8:r.rotate(-.5*Math.PI),r.translate(-i,0)}},_renderImageToCanvas:function(){function t(e,t,i){var n,r,a,o=document.createElement("canvas"),s=o.getContext("2d"),u=0,c=i,l=i;for(o.width=1,o.height=i,s.drawImage(e,0,0),n=s.getImageData(0,0,1,i).data;l>u;)r=n[4*(l-1)+3],0===r?c=l:u=l,l=c+u>>1;return a=l/i,0===a?1:a}function i(e){var t,i,n=e.naturalWidth,r=e.naturalHeight;return n*r>1048576&&(t=document.createElement("canvas"),t.width=t.height=1,i=t.getContext("2d"),i.drawImage(e,-n+1,0),0===i.getImageData(0,0,1,1).data[3])}return e.os.ios?e.os.ios>=7?function(e,i,n,r,a,o){var s=i.naturalWidth,u=i.naturalHeight,c=t(i,s,u);return e.getContext("2d").drawImage(i,0,0,s*c,u*c,n,r,a,o)}:function(e,n,r,a,o,s){var u,c,l,h,d,f,p,m=n.naturalWidth,g=n.naturalHeight,v=e.getContext("2d"),y=i(n),w="image/jpeg"===this.type,x=1024,b=0,_=0;for(y&&(m/=2,g/=2),v.save(),u=document.createElement("canvas"),u.width=u.height=x,c=u.getContext("2d"),l=w?t(n,m,g):1,h=Math.ceil(x*o/m),d=Math.ceil(x*s/g/l);b<g;){for(f=0,p=0;f<m;)c.clearRect(0,0,x,x),c.drawImage(n,-f,-b),v.drawImage(u,0,0,x,x,r+p,a+_,h,d),f+=x,p+=h;b+=x,_+=d}v.restore(),u=c=null}:function(t){var i=e.slice(arguments,1),n=t.getContext("2d");n.drawImage.apply(n,i)}}()})}),t("runtime/html5/transport",["base","runtime/html5/runtime"],function(e,t){var i=e.noop,n=e.$;return t.register("Transport",{init:function(){this._status=0,this._response=null},send:function(){var t,i,r,a=this.owner,o=this.options,s=this._initAjax(),u=a._blob,c=o.server;o.sendAsBinary?(c+=(/\?/.test(c)?"&":"?")+n.param(a._formData),i=u.getSource()):(t=new FormData,n.each(a._formData,function(e,i){t.append(e,i)}),t.append(o.fileVal,u.getSource(),o.filename||a._formData.name||"")),o.withCredentials&&"withCredentials"in s?(s.open(o.method,c,!0),s.withCredentials=!0):s.open(o.method,c),this._setRequestHeader(s,o.headers),i?(s.overrideMimeType&&s.overrideMimeType("application/octet-stream"),e.os.android?(r=new FileReader,r.onload=function(){s.send(this.result),r=r.onload=null},r.readAsArrayBuffer(i)):s.send(i)):s.send(t)},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var e=this._xhr;e&&(e.upload.onprogress=i,e.onreadystatechange=i,e.abort(),this._xhr=e=null)},destroy:function(){this.abort()},_initAjax:function(){var e=this,t=new XMLHttpRequest,n=this.options;return!n.withCredentials||"withCredentials"in t||"undefined"==typeof XDomainRequest||(t=new XDomainRequest),t.upload.onprogress=function(t){var i=0;return t.lengthComputable&&(i=t.loaded/t.total),e.trigger("progress",i)},t.onreadystatechange=function(){if(4===t.readyState)return t.upload.onprogress=i,t.onreadystatechange=i,e._xhr=null,e._status=t.status,t.status>=200&&t.status<300?(e._response=t.responseText,e.trigger("load")):t.status>=500&&t.status<600?(e._response=t.responseText,e.trigger("error","server")):e.trigger("error",e._status?"http":"abort")},e._xhr=t,t},_setRequestHeader:function(e,t){n.each(t,function(t,i){e.setRequestHeader(t,i)})},_parseJson:function(e){var t;try{t=JSON.parse(e)}catch(i){t={}}return t}})}),t("runtime/html5/md5",["runtime/html5/runtime"],function(e){var t=function(e,t){return e+t&4294967295},i=function(e,i,n,r,a,o){return i=t(t(i,e),t(r,o)),t(i<<a|i>>>32-a,n)},n=function(e,t,n,r,a,o,s){return i(t&n|~t&r,e,t,a,o,s)},r=function(e,t,n,r,a,o,s){return i(t&r|n&~r,e,t,a,o,s)},a=function(e,t,n,r,a,o,s){return i(t^n^r,e,t,a,o,s)},o=function(e,t,n,r,a,o,s){return i(n^(t|~r),e,t,a,o,s)},s=function(e,i){var s=e[0],u=e[1],c=e[2],l=e[3];s=n(s,u,c,l,i[0],7,-680876936),l=n(l,s,u,c,i[1],12,-389564586),c=n(c,l,s,u,i[2],17,606105819),u=n(u,c,l,s,i[3],22,-1044525330),s=n(s,u,c,l,i[4],7,-176418897),l=n(l,s,u,c,i[5],12,1200080426),c=n(c,l,s,u,i[6],17,-1473231341),u=n(u,c,l,s,i[7],22,-45705983),s=n(s,u,c,l,i[8],7,1770035416),l=n(l,s,u,c,i[9],12,-1958414417),c=n(c,l,s,u,i[10],17,-42063),u=n(u,c,l,s,i[11],22,-1990404162),s=n(s,u,c,l,i[12],7,1804603682),l=n(l,s,u,c,i[13],12,-40341101),c=n(c,l,s,u,i[14],17,-1502002290),u=n(u,c,l,s,i[15],22,1236535329),s=r(s,u,c,l,i[1],5,-165796510),l=r(l,s,u,c,i[6],9,-1069501632),c=r(c,l,s,u,i[11],14,643717713),u=r(u,c,l,s,i[0],20,-373897302),s=r(s,u,c,l,i[5],5,-701558691),l=r(l,s,u,c,i[10],9,38016083),c=r(c,l,s,u,i[15],14,-660478335),u=r(u,c,l,s,i[4],20,-405537848),s=r(s,u,c,l,i[9],5,568446438),l=r(l,s,u,c,i[14],9,-1019803690),c=r(c,l,s,u,i[3],14,-187363961),u=r(u,c,l,s,i[8],20,1163531501),s=r(s,u,c,l,i[13],5,-1444681467),l=r(l,s,u,c,i[2],9,-51403784),c=r(c,l,s,u,i[7],14,1735328473),u=r(u,c,l,s,i[12],20,-1926607734),s=a(s,u,c,l,i[5],4,-378558),l=a(l,s,u,c,i[8],11,-2022574463),c=a(c,l,s,u,i[11],16,1839030562),u=a(u,c,l,s,i[14],23,-35309556),s=a(s,u,c,l,i[1],4,-1530992060),l=a(l,s,u,c,i[4],11,1272893353),c=a(c,l,s,u,i[7],16,-155497632),u=a(u,c,l,s,i[10],23,-1094730640),s=a(s,u,c,l,i[13],4,681279174),l=a(l,s,u,c,i[0],11,-358537222),c=a(c,l,s,u,i[3],16,-722521979),u=a(u,c,l,s,i[6],23,76029189),s=a(s,u,c,l,i[9],4,-640364487),l=a(l,s,u,c,i[12],11,-421815835),c=a(c,l,s,u,i[15],16,530742520),u=a(u,c,l,s,i[2],23,-995338651),s=o(s,u,c,l,i[0],6,-198630844),l=o(l,s,u,c,i[7],10,1126891415),c=o(c,l,s,u,i[14],15,-1416354905),u=o(u,c,l,s,i[5],21,-57434055),s=o(s,u,c,l,i[12],6,1700485571),l=o(l,s,u,c,i[3],10,-1894986606),c=o(c,l,s,u,i[10],15,-1051523),u=o(u,c,l,s,i[1],21,-2054922799),s=o(s,u,c,l,i[8],6,1873313359),l=o(l,s,u,c,i[15],10,-30611744),c=o(c,l,s,u,i[6],15,-1560198380),u=o(u,c,l,s,i[13],21,1309151649),s=o(s,u,c,l,i[4],6,-145523070),l=o(l,s,u,c,i[11],10,-1120210379),c=o(c,l,s,u,i[2],15,718787259),u=o(u,c,l,s,i[9],21,-343485551),e[0]=t(s,e[0]),e[1]=t(u,e[1]),e[2]=t(c,e[2]),e[3]=t(l,e[3])},u=function(e){var t,i=[];for(t=0;t<64;t+=4)i[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return i},c=function(e){var t,i=[];for(t=0;t<64;t+=4)i[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return i},l=function(e){var t,i,n,r,a,o,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)s(l,u(e.substring(t-64,t)));for(e=e.substring(t-64),i=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(s(l,n),t=0;t<16;t+=1)n[t]=0;return r=8*c,r=r.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),o=parseInt(r[1],16)||0,n[14]=a,n[15]=o,s(l,n),l},h=function(e){var t,i,n,r,a,o,u=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=u;t+=64)s(l,c(e.subarray(t-64,t)));for(e=t-64<u?e.subarray(t-64):new Uint8Array(0),i=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)n[t>>2]|=e[t]<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(s(l,n),t=0;t<16;t+=1)n[t]=0;return r=8*u,r=r.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),o=parseInt(r[1],16)||0,n[14]=a,n[15]=o,s(l,n),l},d=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],f=function(e){var t,i="";for(t=0;t<4;t+=1)i+=d[e>>8*t+4&15]+d[e>>8*t&15];return i},p=function(e){var t;for(t=0;t<e.length;t+=1)e[t]=f(e[t]);return e.join("")},m=function(e){return p(l(e))},g=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==m("hello")&&(t=function(e,t){var i=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(i>>16);return n<<16|65535&i}),g.prototype.append=function(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),this.appendBinary(e),this},g.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)s(this._state,u(this._buff.substring(t-64,t)));return this._buff=this._buff.substr(t-64),this},g.prototype.end=function(e){var t,i,n=this._buff,r=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r;t+=1)a[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(a,r),i=e?this._state:p(this._state),this.reset(),i},g.prototype._finish=function(e,t){var i,n,r,a=t;if(e[a>>2]|=128<<(a%4<<3),a>55)for(s(this._state,e),a=0;a<16;a+=1)e[a]=0;i=8*this._length,i=i.toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(i[2],16),r=parseInt(i[1],16)||0,e[14]=n,e[15]=r,s(this._state,e)},g.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},g.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},g.hash=function(e,t){/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e)));var i=l(e);return t?i:p(i)},g.hashBinary=function(e,t){var i=l(e);return t?i:p(i)},g.ArrayBuffer=function(){this.reset()},g.ArrayBuffer.prototype.append=function(e){var t,i=this._concatArrayBuffer(this._buff,e),n=i.length;for(this._length+=e.byteLength,t=64;t<=n;t+=64)s(this._state,c(i.subarray(t-64,t)));return this._buff=t-64<n?i.subarray(t-64):new Uint8Array(0),this},g.ArrayBuffer.prototype.end=function(e){var t,i,n=this._buff,r=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r;t+=1)a[t>>2]|=n[t]<<(t%4<<3);return this._finish(a,r),i=e?this._state:p(this._state),this.reset(),i},g.ArrayBuffer.prototype._finish=g.prototype._finish,g.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},g.ArrayBuffer.prototype.destroy=g.prototype.destroy,g.ArrayBuffer.prototype._concatArrayBuffer=function(e,t){var i=e.length,n=new Uint8Array(i+t.byteLength);return n.set(e),n.set(new Uint8Array(t),i),n},g.ArrayBuffer.hash=function(e,t){var i=h(new Uint8Array(e));return t?i:p(i)},e.register("Md5",{init:function(){},loadFromBlob:function(e){var t,i,n=e.getSource(),r=2097152,a=Math.ceil(n.size/r),o=0,s=this.owner,u=new g.ArrayBuffer,c=this,l=n.mozSlice||n.webkitSlice||n.slice;i=new FileReader,(t=function(){var h,d;h=o*r,d=Math.min(h+r,n.size),i.onload=function(t){u.append(t.target.result),s.trigger("progress",{total:e.size,loaded:d})},i.onloadend=function(){i.onloadend=i.onload=null,++o<a?setTimeout(t,1):setTimeout(function(){s.trigger("load"),c.result=u.end(),t=e=n=u=null,s.trigger("complete")},50)},i.readAsArrayBuffer(l.call(n,h,d))})()},getResult:function(){return this.result}})}),t("runtime/flash/runtime",["base","runtime/runtime","runtime/compbase"],function(t,i,n){function r(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(i){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1],10)}function a(){function n(e,t){var i,n,r=e.type||e;i=r.split("::"),n=i[0],r=i[1],"Ready"===r&&n===c.uid?c.trigger("ready"):a[n]&&a[n].trigger(r.toLowerCase(),e,t)}var r={},a={},o=this.destroy,c=this,l=t.guid("webuploader_");i.apply(c,arguments),c.type=s,c.exec=function(e,i){var n,o=this,s=o.uid,l=t.slice(arguments,2);return a[s]=o,u[e]&&(r[s]||(r[s]=new u[e](o,c)),n=r[s],n[i])?n[i].apply(n,l):c.flashExec.apply(o,arguments)},e[l]=function(){var e=arguments;setTimeout(function(){n.apply(null,e)},1)},this.jsreciver=l,this.destroy=function(){return o&&o.apply(this,arguments)},this.flashExec=function(e,i){var n=c.getFlash(),r=t.slice(arguments,2);return n.exec(this.uid,e,i,r)}}var o=t.$,s="flash",u={};return t.inherits(i,{constructor:a,init:function(){var e,i=this.getContainer(),n=this.options;i.css({position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),e='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+n.swf+'" ',t.browser.ie&&(e+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),e+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+n.swf+'" /><param name="flashvars" value="uid='+this.uid+"&jsreciver="+this.jsreciver+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',i.html(e)},getFlash:function(){return this._flash?this._flash:(this._flash=o("#"+this.uid).get(0),this._flash)}}),a.register=function(e,i){return i=u[e]=t.inherits(n,o.extend({flashExec:function(){var e=this.owner,t=this.getRuntime();return t.flashExec.apply(e,arguments)}},i))},r()>=11.4&&i.addRuntime(s,a),a}),t("runtime/flash/filepicker",["base","runtime/flash/runtime"],function(e,t){var i=e.$;return t.register("FilePicker",{init:function(e){var t,n,r=i.extend({},e);for(t=r.accept&&r.accept.length,n=0;n<t;n++)r.accept[n].title||(r.accept[n].title="Files");delete r.button,delete r.id,delete r.container,this.flashExec("FilePicker","init",r)},destroy:function(){this.flashExec("FilePicker","destroy")}})}),t("runtime/flash/image",["runtime/flash/runtime"],function(e){return e.register("Image",{loadFromBlob:function(e){var t=this.owner;t.info()&&this.flashExec("Image","info",t.info()),t.meta()&&this.flashExec("Image","meta",t.meta()),this.flashExec("Image","loadFromBlob",e.uid)}})}),t("runtime/flash/transport",["base","runtime/flash/runtime","runtime/client"],function(t,i,n){var r=t.$;return i.register("Transport",{init:function(){this._status=0,this._response=null,this._responseJson=null},send:function(){var e,t=this.owner,i=this.options,n=this._initAjax(),a=t._blob,o=i.server;n.connectRuntime(a.ruid),i.sendAsBinary?(o+=(/\?/.test(o)?"&":"?")+r.param(t._formData),e=a.uid):(r.each(t._formData,function(e,t){n.exec("append",e,t)}),n.exec("appendBlob",i.fileVal,a.uid,i.filename||t._formData.name||"")),this._setRequestHeader(n,i.headers),n.exec("send",{method:i.method,url:o,forceURLStream:i.forceURLStream,mimeType:"application/octet-stream"},e)},getStatus:function(){return this._status},getResponse:function(){return this._response||""},getResponseAsJson:function(){return this._responseJson},abort:function(){var e=this._xhr;e&&(e.exec("abort"),e.destroy(),this._xhr=e=null)},destroy:function(){this.abort()},_initAjax:function(){var t=this,i=new n("XMLHttpRequest");return i.on("uploadprogress progress",function(e){var i=e.loaded/e.total;return i=Math.min(1,Math.max(0,i)),t.trigger("progress",i)}),i.on("load",function(){var n,r=i.exec("getStatus"),a=!1,o="";return i.off(),t._xhr=null,r>=200&&r<300?a=!0:r>=500&&r<600?(a=!0,o="server"):o="http",a&&(t._response=i.exec("getResponse"),t._response=decodeURIComponent(t._response),n=e.JSON&&e.JSON.parse||function(e){try{return new Function("return "+e).call()}catch(t){return{}}},t._responseJson=t._response?n(t._response):{}),i.destroy(),i=null,o?t.trigger("error",o):t.trigger("load")}),i.on("error",function(){i.off(),t._xhr=null,t.trigger("error","http")}),t._xhr=i,i},_setRequestHeader:function(e,t){r.each(t,function(t,i){e.exec("setRequestHeader",t,i)})}})}),t("runtime/flash/blob",["runtime/flash/runtime","lib/blob"],function(e,t){return e.register("Blob",{slice:function(e,i){var n=this.flashExec("Blob","slice",e,i);return new t(n.uid,n)}})}),t("runtime/flash/md5",["runtime/flash/runtime"],function(e){return e.register("Md5",{init:function(){},loadFromBlob:function(e){return this.flashExec("Md5","loadFromBlob",e.uid)}})}),t("preset/all",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","widgets/md5","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/androidpatch","runtime/html5/image","runtime/html5/transport","runtime/html5/md5","runtime/flash/filepicker","runtime/flash/image","runtime/flash/transport","runtime/flash/blob","runtime/flash/md5"],function(e){return e}),t("widgets/log",["base","uploader","widgets/widget"],function(e,t){function i(e){var t=r.extend({},n,e),i=a.replace(/^(.*)\?/,"$1"+r.param(t)),o=new Image;o.src=i}var n,r=e.$,a=" http://static.tieba.baidu.com/tb/pms/img/st.gif??",o=(location.hostname||location.host||"protected").toLowerCase(),s=o&&/baidu/i.exec(o);if(s)return n={dv:3,master:"webuploader",online:/test/.exec(o)?0:1,module:"",product:o,type:0},t.register({name:"log",init:function(){var e=this.owner,t=0,n=0;e.on("error",function(e){i({type:2,c_error_code:e})}).on("uploadError",function(e,t){i({type:2,c_error_code:"UPLOAD_ERROR",c_reason:""+t})}).on("uploadComplete",function(e){t++,n+=e.size}).on("uploadFinished",function(){i({c_count:t,c_size:n}),t=n=0}),i({c_usage:1})}})}),t("webuploader",["preset/all","widgets/log"],function(e){return e}),i("webuploader")}),function(e,t){"use strict";function i(e,t){for(var i,n=[],a=0;a<e.length;++a){if(i=o[e[a]]||r(e[a]),!i)throw"module definition dependecy not found: "+e[a];n.push(i)}t.apply(null,n)}function n(e,n,r){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(n===t)throw"invalid module definition, dependencies must be specified";if(r===t)throw"invalid module definition, definition function must be specified";i(n,function(){o[e]=r.apply(null,arguments)})}function r(t){for(var i=e,n=t.split(/[.\/]/),r=0;r<n.length;++r){if(!i[n[r]])return;i=i[n[r]]}return i}function a(i){for(var n=0;n<i.length;n++){for(var r=e,a=i[n],s=a.split(/[.\/]/),u=0;u<s.length-1;++u)r[s[u]]===t&&(r[s[u]]={}),r=r[s[u]];r[s[s.length-1]]=o[a]}}var o={};n("moxie/core/utils/Basic",[],function(){var e=function(e){var t;return e===t?"undefined":null===e?"null":e.nodeType?"node":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},t=function(n){var r;return i(arguments,function(a,s){s>0&&i(a,function(i,a){i!==r&&(e(n[a])===e(i)&&~o(e(i),["array","object"])?t(n[a],i):n[a]=i)})}),n},i=function(e,t){var i,n,r,a;if(e){try{i=e.length}catch(o){i=a}if(i===a){for(n in e)if(e.hasOwnProperty(n)&&t(e[n],n)===!1)return}else for(r=0;r<i;r++)if(t(e[r],r)===!1)return}},n=function(t){var i;if(!t||"object"!==e(t))return!0;for(i in t)return!1;return!0},r=function(t,i){function n(r){"function"===e(t[r])&&t[r](function(e){++r<a&&!e?n(r):i(e)})}var r=0,a=t.length;"function"!==e(i)&&(i=function(){}),t&&t.length||i(),n(r)},a=function(e,t){var n=0,r=e.length,a=new Array(r);i(e,function(e,i){e(function(e){if(e)return t(e);var o=[].slice.call(arguments);o.shift(),a[i]=o,n++,n===r&&(a.unshift(null),t.apply(this,a))})})},o=function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i}return-1},s=function(t,i){var n=[];"array"!==e(t)&&(t=[t]),"array"!==e(i)&&(i=[i]);for(var r in t)o(t[r],i)===-1&&n.push(t[r]);return!!n.length&&n},u=function(e,t){var n=[];return i(e,function(e){o(e,t)!==-1&&n.push(e)}),n.length?n:null},c=function(e){var t,i=[];for(t=0;t<e.length;t++)i[t]=e[t];return i},l=function(){var e=0;return function(t){var i,n=(new Date).getTime().toString(32);for(i=0;i<5;i++)n+=Math.floor(65535*Math.random()).toString(32);return(t||"o_")+n+(e++).toString(32)}}(),h=function(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e},d=function(e){if("string"!=typeof e)return e;var t,i={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],i.hasOwnProperty(t)&&(e*=i[t]),e};return{guid:l,typeOf:e,extend:t,each:i,isEmptyObj:n,inSeries:r,inParallel:a,inArray:o,arrayDiff:s,arrayIntersect:u,toArray:c,trim:h,parseSizeStr:d}}),n("moxie/core/I18n",["moxie/core/utils/Basic"],function(e){var t={};return{addI18n:function(i){return e.extend(t,i)},translate:function(e){return t[e]||e},_:function(e){return this.translate(e)},sprintf:function(t){var i=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=i.shift();return"undefined"!==e.typeOf(t)?t:""})}}}),n("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(e,t){var i="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",n={mimes:{},extensions:{},addMimeType:function(e){var t,i,n,r=e.split(/,/);for(t=0;t<r.length;t+=2){for(n=r[t+1].split(/ /),i=0;i<n.length;i++)this.mimes[n[i]]=r[t];this.extensions[r[t]]=n}},extList2mimes:function(t,i){var n,r,a,o,s=this,u=[];for(r=0;r<t.length;r++)for(n=t[r].extensions.split(/\s*,\s*/),a=0;a<n.length;a++){if("*"===n[a])return[];if(o=s.mimes[n[a]])e.inArray(o,u)===-1&&u.push(o);else{if(!i||!/^\w+$/.test(n[a]))return[];u.push("."+n[a])}}return u},mimes2exts:function(t){var i=this,n=[];return e.each(t,function(t){if("*"===t)return n=[],!1;var r=t.match(/^(\w+)\/(\*|\w+)$/);r&&("*"===r[2]?e.each(i.extensions,function(e,t){new RegExp("^"+r[1]+"/").test(t)&&[].push.apply(n,i.extensions[t])}):i.extensions[t]&&[].push.apply(n,i.extensions[t]))}),n},mimes2extList:function(i){var n=[],r=[];return"string"===e.typeOf(i)&&(i=e.trim(i).split(/\s*,\s*/)),r=this.mimes2exts(i),n.push({title:t.translate("Files"),extensions:r.length?r.join(","):"*"}),n.mimes=i,n},getFileExtension:function(e){var t=e&&e.match(/\.([^.]+)$/);return t?t[1].toLowerCase():""},getFileMime:function(e){return this.mimes[this.getFileExtension(e)]||""}};return n.addMimeType(i),n}),n("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(e){function t(e,t,i){var n=0,r=0,a=0,o={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function(e){return e=(""+e).replace(/[_\-+]/g,"."),e=e.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),e.length?e.split("."):[-8]},u=function(e){return e?isNaN(e)?o[e]||-7:parseInt(e,10):0};for(e=s(e),t=s(t),r=Math.max(e.length,t.length),n=0;n<r;n++)if(e[n]!=t[n]){if(e[n]=u(e[n]),t[n]=u(t[n]),e[n]<t[n]){a=-1;break}if(e[n]>t[n]){a=1;break}}if(!i)return a;switch(i){case">":case"gt":return a>0;case">=":case"ge":return a>=0;case"<=":case"le":return a<=0;case"==":case"=":case"eq":return 0===a;case"<>":case"!=":case"ne":return 0!==a;case"":case"<":case"lt":return a<0;default:return null}}var i=function(e){var t="",i="?",n="function",r="undefined",a="object",o="major",s="name",u="version",c={has:function(e,t){return t.toLowerCase().indexOf(e.toLowerCase())!==-1},lowerize:function(e){return e.toLowerCase()}},l={rgx:function(){for(var t,i,o,s,u,c,l,h=0,d=arguments;h<d.length;h+=2){var f=d[h],p=d[h+1];if(typeof t===r){t={};for(s in p)u=p[s],typeof u===a?t[u[0]]=e:t[u]=e}for(i=o=0;i<f.length;i++)if(c=f[i].exec(this.getUA())){for(s=0;s<p.length;s++)l=c[++o],u=p[s],typeof u===a&&u.length>0?2==u.length?typeof u[1]==n?t[u[0]]=u[1].call(this,l):t[u[0]]=u[1]:3==u.length?typeof u[1]!==n||u[1].exec&&u[1].test?t[u[0]]=l?l.replace(u[1],u[2]):e:t[u[0]]=l?u[1].call(this,l,u[2]):e:4==u.length&&(t[u[0]]=l?u[3].call(this,l.replace(u[1],u[2])):e):t[u]=l?l:e;break}if(c)break}return t},str:function(t,n){for(var r in n)if(typeof n[r]===a&&n[r].length>0){for(var o=0;o<n[r].length;o++)if(c.has(n[r][o],t))return r===i?e:r}else if(c.has(n[r],t))return r===i?e:r;return t}},h={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},d={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[s,u,o],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[s,"Opera"],u,o],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[s,u,o],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[s,"IE"],u,o],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[s,"Yandex"],u,o],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[s,/_/g," "],u,o],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[s,u,o],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[s,"Dolphin"],u,o],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[s,"Chrome"],u,o],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[s,"Android Browser"],u,o],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[u,o,[s,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[u,o,s],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[s,[o,l.str,h.browser.oldsafari.major],[u,l.str,h.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[s,u,o],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[s,"Netscape"],u,o],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[s,u,o]],
engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,u],[/rv\:([\w\.]+).*(gecko)/i],[u,s]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[u,l.str,h.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[u,l.str,h.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[s,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],u],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],u],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],u],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,u],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[s,"iOS"],[u,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[s,[u,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[s,u]]},f=function(e){var i=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:t);this.getBrowser=function(){return l.rgx.apply(this,d.browser)},this.getEngine=function(){return l.rgx.apply(this,d.engine)},this.getOS=function(){return l.rgx.apply(this,d.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this.setUA(i)};return(new f).getResult()}(),n=function(){var t={define_property:function(){return!1}(),create_canvas:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),return_response_type:function(t){try{if(e.inArray(t,["","text","document"])!==-1)return!0;if(window.XMLHttpRequest){var i=new XMLHttpRequest;if(i.open("get","/"),"responseType"in i)return i.responseType=t,i.responseType===t}}catch(n){}return!1},use_data_uri:function(){var e=new Image;return e.onload=function(){t.use_data_uri=1===e.width&&1===e.height},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return t.use_data_uri&&("IE"!==r.browser||r.version>=9)},use_data_uri_of:function(e){return t.use_data_uri&&e<33e3||t.use_data_uri_over32kb()},use_fileinput:function(){var e=document.createElement("input");return e.setAttribute("type","file"),!e.disabled}};return function(i){var n=[].slice.call(arguments);return n.shift(),"function"===e.typeOf(t[i])?t[i].apply(this,n):!!t[i]}}(),r={can:n,browser:i.browser.name,version:parseFloat(i.browser.major),os:i.os.name,osVersion:i.os.version,verComp:t,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return r.OS=r.os,r}),n("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(e){var t=function(e){return"string"!=typeof e?e:document.getElementById(e)},i=function(e,t){if(!e.className)return!1;var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return i.test(e.className)},n=function(e,t){i(e,t)||(e.className=e.className?e.className.replace(/\s+$/,"")+" "+t:t)},r=function(e,t){if(e.className){var i=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(i,function(e,t,i){return" "===t&&" "===i?" ":""})}},a=function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},o=function(t,i){function n(e){var t,i,n=0,r=0;return e&&(i=e.getBoundingClientRect(),t="CSS1Compat"===c.compatMode?c.documentElement:c.body,n=i.left+t.scrollLeft,r=i.top+t.scrollTop),{x:n,y:r}}var r,a,o,s=0,u=0,c=document;if(t=t,i=i||c.body,t&&t.getBoundingClientRect&&"IE"===e.browser&&(!c.documentMode||c.documentMode<8))return a=n(t),o=n(i),{x:a.x-o.x,y:a.y-o.y};for(r=t;r&&r!=i&&r.nodeType;)s+=r.offsetLeft||0,u+=r.offsetTop||0,r=r.offsetParent;for(r=t.parentNode;r&&r!=i&&r.nodeType;)s-=r.scrollLeft||0,u-=r.scrollTop||0,r=r.parentNode;return{x:s,y:u}},s=function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}};return{get:t,hasClass:i,addClass:n,removeClass:r,getStyle:a,getPos:o,getSize:s}}),n("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(e){function t(e,t){var i;for(i in e)if(e[i]===t)return i;return null}return{RuntimeError:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": RuntimeError "+this.code}var n={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(i,n),i.prototype=Error.prototype,i}(),OperationNotAllowedException:function(){function t(e){this.code=e,this.name="OperationNotAllowedException"}return e.extend(t,{NOT_ALLOWED_ERR:1}),t.prototype=Error.prototype,t}(),ImageError:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": ImageError "+this.code}var n={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return e.extend(i,n),i.prototype=Error.prototype,i}(),FileException:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": FileException "+this.code}var n={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(i,n),i.prototype=Error.prototype,i}(),DOMException:function(){function i(e){this.code=e,this.name=t(n,e),this.message=this.name+": DOMException "+this.code}var n={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(i,n),i.prototype=Error.prototype,i}(),EventException:function(){function t(e){this.code=e,this.name="EventException"}return e.extend(t,{UNSPECIFIED_EVENT_TYPE_ERR:0}),t.prototype=Error.prototype,t}()}}),n("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],function(e,t){function i(){var i={};t.extend(this,{uid:null,init:function(){this.uid||(this.uid=t.guid("uid_"))},addEventListener:function(e,n,r,a){var o,s=this;return e=t.trim(e),/\s/.test(e)?void t.each(e.split(/\s+/),function(e){s.addEventListener(e,n,r,a)}):(e=e.toLowerCase(),r=parseInt(r,10)||0,o=i[this.uid]&&i[this.uid][e]||[],o.push({fn:n,priority:r,scope:a||this}),i[this.uid]||(i[this.uid]={}),void(i[this.uid][e]=o))},hasEventListener:function(e){return e?!(!i[this.uid]||!i[this.uid][e]):!!i[this.uid]},removeEventListener:function(e,n){e=e.toLowerCase();var r,a=i[this.uid]&&i[this.uid][e];if(a){if(n){for(r=a.length-1;r>=0;r--)if(a[r].fn===n){a.splice(r,1);break}}else a=[];a.length||(delete i[this.uid][e],t.isEmptyObj(i[this.uid])&&delete i[this.uid])}},removeAllEventListeners:function(){i[this.uid]&&delete i[this.uid]},dispatchEvent:function(n){var r,a,o,s,u,c={},l=!0;if("string"!==t.typeOf(n)){if(s=n,"string"!==t.typeOf(s.type))throw new e.EventException(e.EventException.UNSPECIFIED_EVENT_TYPE_ERR);n=s.type,s.total!==u&&s.loaded!==u&&(c.total=s.total,c.loaded=s.loaded),c.async=s.async||!1}if(n.indexOf("::")!==-1?!function(e){r=e[0],n=e[1]}(n.split("::")):r=this.uid,n=n.toLowerCase(),a=i[r]&&i[r][n]){a.sort(function(e,t){return t.priority-e.priority}),o=[].slice.call(arguments),o.shift(),c.type=n,o.unshift(c);var h=[];t.each(a,function(e){o[0].target=e.scope,c.async?h.push(function(t){setTimeout(function(){t(e.fn.apply(e.scope,o)===!1)},1)}):h.push(function(t){t(e.fn.apply(e.scope,o)===!1)})}),h.length&&t.inSeries(h,function(e){l=!e})}return l},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(e){var i;"array"!==t.typeOf(e)&&(e=[e]);for(var n=0;n<e.length;n++)i="on"+e[n],"function"===t.typeOf(this[i])?this.addEventListener(e[n],this[i]):"undefined"===t.typeOf(this[i])&&(this[i]=null)}})}return i.instance=new i,i}),n("moxie/core/utils/Encode",[],function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return decodeURIComponent(escape(e))},i=function(e,i){if("function"==typeof window.atob)return i?t(window.atob(e)):window.atob(e);var n,r,a,o,s,u,c,l,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,f=0,p="",m=[];if(!e)return e;e+="";do o=h.indexOf(e.charAt(d++)),s=h.indexOf(e.charAt(d++)),u=h.indexOf(e.charAt(d++)),c=h.indexOf(e.charAt(d++)),l=o<<18|s<<12|u<<6|c,n=l>>16&255,r=l>>8&255,a=255&l,64==u?m[f++]=String.fromCharCode(n):64==c?m[f++]=String.fromCharCode(n,r):m[f++]=String.fromCharCode(n,r,a);while(d<e.length);return p=m.join(""),i?t(p):p},n=function(t,i){if(i&&e(t),"function"==typeof window.btoa)return window.btoa(t);var n,r,a,o,s,u,c,l,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,f=0,p="",m=[];if(!t)return t;do n=t.charCodeAt(d++),r=t.charCodeAt(d++),a=t.charCodeAt(d++),l=n<<16|r<<8|a,o=l>>18&63,s=l>>12&63,u=l>>6&63,c=63&l,m[f++]=h.charAt(o)+h.charAt(s)+h.charAt(u)+h.charAt(c);while(d<t.length);p=m.join("");var g=t.length%3;return(g?p.slice(0,g-3):p)+"===".slice(g||3)};return{utf8_encode:e,utf8_decode:t,atob:i,btoa:n}}),n("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(e,t,i){function n(i,r,o,s,u){var c,l=this,h=e.guid(r+"_"),d=u||"browser";i=i||{},a[h]=this,o=e.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},o),i.preferred_caps&&(d=n.getMode(s,i.preferred_caps,d)),c=function(){var t={};return{exec:function(e,i,n,r){if(c[i]&&(t[e]||(t[e]={context:this,instance:new c[i]}),t[e].instance[n]))return t[e].instance[n].apply(this,r)},removeInstance:function(e){delete t[e]},removeAllInstances:function(){var i=this;e.each(t,function(t,n){"function"===e.typeOf(t.instance.destroy)&&t.instance.destroy.call(t.context),i.removeInstance(n)})}}}(),e.extend(this,{initialized:!1,uid:h,type:r,mode:n.getMode(s,i.required_caps,d),shimid:h+"_container",clients:0,options:i,can:function(t,i){var r=arguments[2]||o;if("string"===e.typeOf(t)&&"undefined"===e.typeOf(i)&&(t=n.parseCaps(t)),"object"===e.typeOf(t)){for(var a in t)if(!this.can(a,t[a],r))return!1;return!0}return"function"===e.typeOf(r[t])?r[t].call(this,i):i===r[t]},getShimContainer:function(){var i,n=t.get(this.shimid);return n||(i=this.options.container?t.get(this.options.container):document.body,n=document.createElement("div"),n.id=this.shimid,n.className="moxie-shim moxie-shim-"+this.type,e.extend(n.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),i.appendChild(n),i=null),n},getShim:function(){return c},shimExec:function(e,t){var i=[].slice.call(arguments,2);return l.getShim().exec.call(this,this.uid,e,t,i)},exec:function(e,t){var i=[].slice.call(arguments,2);return l[e]&&l[e][t]?l[e][t].apply(this,i):l.shimExec.apply(this,arguments)},destroy:function(){if(l){var e=t.get(this.shimid);e&&e.parentNode.removeChild(e),c&&c.removeAllInstances(),this.unbindAll(),delete a[this.uid],this.uid=null,h=l=c=e=null}}}),this.mode&&i.required_caps&&!this.can(i.required_caps)&&(this.mode=!1)}var r={},a={};return n.order="html5,flash,silverlight,html4",n.getRuntime=function(e){return!!a[e]&&a[e]},n.addConstructor=function(e,t){t.prototype=i.instance,r[e]=t},n.getConstructor=function(e){return r[e]||null},n.getInfo=function(e){var t=n.getRuntime(e);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},n.parseCaps=function(t){var i={};return"string"!==e.typeOf(t)?t||{}:(e.each(t.split(","),function(e){i[e]=!0}),i)},n.can=function(e,t){var i,r,a=n.getConstructor(e);return!!a&&(i=new a({required_caps:t}),r=i.mode,i.destroy(),!!r)},n.thatCan=function(e,t){var i=(t||n.order).split(/\s*,\s*/);for(var r in i)if(n.can(i[r],e))return i[r];return null},n.getMode=function(t,i,n){var r=null;if("undefined"===e.typeOf(n)&&(n="browser"),i&&!e.isEmptyObj(t)){if(e.each(i,function(i,n){if(t.hasOwnProperty(n)){var a=t[n](i);if("string"==typeof a&&(a=[a]),r){if(!(r=e.arrayIntersect(r,a)))return r=!1}else r=a}}),r)return e.inArray(n,r)!==-1?n:r[0];if(r===!1)return!1}return n},n.capTrue=function(){return!0},n.capFalse=function(){return!1},n.capTest=function(e){return function(){return!!e}},n}),n("moxie/runtime/RuntimeClient",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(e,t,i){return function(){var n;t.extend(this,{connectRuntime:function(r){function a(t){var o,u;return t.length?(o=t.shift(),(u=i.getConstructor(o))?(n=new u(r),n.bind("Init",function(){n.initialized=!0,setTimeout(function(){n.clients++,s.trigger("RuntimeInit",n)},1)}),n.bind("Error",function(){n.destroy(),a(t)}),n.mode?void n.init():void n.trigger("Error")):void a(t)):(s.trigger("RuntimeError",new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)),void(n=null))}var o,s=this;if("string"===t.typeOf(r)?o=r:"string"===t.typeOf(r.ruid)&&(o=r.ruid),o){if(n=i.getRuntime(o))return n.clients++,n;throw new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)}a((r.runtime_order||i.order).split(/\s*,\s*/))},getRuntime:function(){return n&&n.uid?n:(n=null,null)},disconnectRuntime:function(){n&&--n.clients<=0&&(n.destroy(),n=null)}})}}),n("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(e,t,i){function n(a,o){function s(t,i,a){var o,s=r[this.uid];return"string"===e.typeOf(s)&&s.length?(o=new n(null,{type:a,size:i-t}),o.detach(s.substr(t,o.size)),o):null}i.call(this),a&&this.connectRuntime(a),o?"string"===e.typeOf(o)&&(o={data:o}):o={},e.extend(this,{uid:o.uid||e.guid("uid_"),ruid:a,size:o.size||0,type:o.type||"",slice:function(e,t,i){return this.isDetached()?s.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,t,i)},getSource:function(){return r[this.uid]?r[this.uid]:null},detach:function(e){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy",r[this.uid]),this.disconnectRuntime(),this.ruid=null),e=e||"";var i=e.match(/^data:([^;]*);base64,/);i&&(this.type=i[1],e=t.atob(e.substring(e.indexOf("base64,")+7))),this.size=e.length,r[this.uid]=e},isDetached:function(){return!this.ruid&&"string"===e.typeOf(r[this.uid])},destroy:function(){this.detach(),delete r[this.uid]}}),o.data?this.detach(o.data):r[this.uid]=o}var r={};return n}),n("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(e,t,i){function n(n,r){var a,o;if(r||(r={}),o=r.type&&""!==r.type?r.type:t.getFileMime(r.name),r.name)a=r.name.replace(/\\/g,"/"),a=a.substr(a.lastIndexOf("/")+1);else{var s=o.split("/")[0];a=e.guid((""!==s?s:"file")+"_"),t.extensions[o]&&(a+="."+t.extensions[o][0])}i.apply(this,arguments),e.extend(this,{type:o||"",name:a||e.guid("file_"),lastModifiedDate:r.lastModifiedDate||(new Date).toLocaleString()})}return n.prototype=i.prototype,n}),n("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/file/File","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(e,t,i,n,r,a,o,s,u){function c(r){var c,h,d,f=this;if(e.inArray(e.typeOf(r),["string","node"])!==-1&&(r={browse_button:r}),h=i.get(r.browse_button),!h)throw new n.DOMException(n.DOMException.NOT_FOUND_ERR);d={accept:[{title:a.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:h.parentNode||document.body},r=e.extend({},d,r),"string"==typeof r.required_caps&&(r.required_caps=s.parseCaps(r.required_caps)),"string"==typeof r.accept&&(r.accept=t.mimes2extList(r.accept)),c=i.get(r.container),c||(c=document.body),"static"===i.getStyle(c,"position")&&(c.style.position="relative"),c=h=null,u.call(f),e.extend(f,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){f.convertEventPropsToHandlers(l),f.bind("RuntimeInit",function(t,n){f.ruid=n.uid,f.shimid=n.shimid,f.bind("Ready",function(){f.trigger("Refresh")},999),f.bind("Change",function(){var t=n.exec.call(f,"FileInput","getFiles");f.files=[],e.each(t,function(e){return 0===e.size||void f.files.push(new o(f.ruid,e))})},999),f.bind("Refresh",function(){var t,a,o,s;o=i.get(r.browse_button),s=i.get(n.shimid),o&&(t=i.getPos(o,i.get(r.container)),a=i.getSize(o),s&&e.extend(s.style,{top:t.y+"px",left:t.x+"px",width:a.w+"px",height:a.h+"px"})),s=o=null}),n.exec.call(f,"FileInput","init",r)}),f.connectRuntime(e.extend({},r,{required_caps:{select_file:!0}}))},disable:function(t){var i=this.getRuntime();i&&i.exec.call(this,"FileInput","disable","undefined"===e.typeOf(t)||t)},refresh:function(){f.trigger("Refresh")},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===e.typeOf(this.files)&&e.each(this.files,function(e){e.destroy()}),this.files=null}})}var l=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return c.prototype=r.instance,c}),n("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(e,t,i,n,r,a,o,s){function u(i){var o,u=this;"string"==typeof i&&(i={drop_zone:i}),o={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},i="object"==typeof i?n.extend({},o,i):o,i.container=t.get(i.drop_zone)||document.body,"static"===t.getStyle(i.container,"position")&&(i.container.style.position="relative"),"string"==typeof i.accept&&(i.accept=s.mimes2extList(i.accept)),a.call(u),n.extend(u,{uid:n.guid("uid_"),ruid:null,files:null,init:function(){u.convertEventPropsToHandlers(c),u.bind("RuntimeInit",function(e,t){u.ruid=t.uid,u.bind("Drop",function(){var e=t.exec.call(u,"FileDrop","getFiles");u.files=[],n.each(e,function(e){u.files.push(new r(u.ruid,e))})},999),t.exec.call(u,"FileDrop","init",i),u.dispatchEvent("ready")}),u.connectRuntime(i)},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var c=["ready","dragenter","dragleave","drop","error"];return u.prototype=o.instance,u}),n("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,t,i){function n(){this.uid=e.guid("uid_"),t.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return n.prototype=i.instance,n}),n("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/runtime/RuntimeTarget"],function(e,t,i,n,r,a,o){function s(){function n(e,n){function l(e){c.readyState=s.DONE,c.error=e,c.trigger("error"),h()}function h(){a.destroy(),a=null,c.trigger("loadend")}function d(t){a.bind("Error",function(e,t){l(t)}),a.bind("Progress",function(e){c.result=t.exec.call(a,"FileReader","getResult"),c.trigger(e)}),a.bind("Load",function(e){c.readyState=s.DONE,c.result=t.exec.call(a,"FileReader","getResult"),c.trigger(e),h()}),t.exec.call(a,"FileReader","read",e,n)}if(a=new o,this.convertEventPropsToHandlers(u),this.readyState===s.LOADING)return l(new i.DOMException(i.DOMException.INVALID_STATE_ERR));if(this.readyState=s.LOADING,this.trigger("loadstart"),n instanceof r)if(n.isDetached()){var f=n.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=f;break;case"readAsDataURL":this.result="data:"+n.type+";base64,"+t.btoa(f)}this.readyState=s.DONE,this.trigger("load"),h()}else d(a.connectRuntime(n.ruid));else l(new i.DOMException(i.DOMException.NOT_FOUND_ERR))}var a,c=this;e.extend(this,{uid:e.guid("uid_"),readyState:s.EMPTY,result:null,error:null,readAsBinaryString:function(e){n.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){n.call(this,"readAsDataURL",e)},readAsText:function(e){n.call(this,"readAsText",e)},abort:function(){this.result=null,e.inArray(this.readyState,[s.EMPTY,s.DONE])===-1&&(this.readyState===s.LOADING&&(this.readyState=s.DONE),a&&a.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),a&&(a.getRuntime().exec.call(this,"FileReader","destroy"),a.disconnectRuntime()),c=a=null}})}var u=["loadstart","progress","load","abort","error","loadend"];return s.EMPTY=0,s.LOADING=1,s.DONE=2,s.prototype=n.instance,s}),n("moxie/core/utils/Url",[],function(){var e=function(t,i){for(var n=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],r=n.length,a={http:80,https:443},o={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,u=s.exec(t||"");r--;)u[r]&&(o[n[r]]=u[r]);if(!o.scheme){i&&"string"!=typeof i||(i=e(i||document.location.href)),o.scheme=i.scheme,o.host=i.host,o.port=i.port;var c="";/^[^\/]/.test(o.path)&&(c=i.path,/(\/|\/[^\.]+)$/.test(c)?c+="/":c=c.replace(/\/[^\/]+$/,"/")),o.path=c+(o.path||"")}return o.port||(o.port=a[o.scheme]||80),o.port=parseInt(o.port,10),o.path||(o.path="/"),delete o.source,o},t=function(t){var i={http:80,https:443},n=e(t);return n.scheme+"://"+n.host+(n.port!==i[n.scheme]?":"+n.port:"")+n.path+(n.query?n.query:"")},i=function(t){function i(e){return[e.scheme,e.host,e.port].join("/")}return"string"==typeof t&&(t=e(t)),i(e())===i(t)};return{parseUrl:e,resolveUrl:t,hasSameOrigin:i}}),n("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(e,t,i){return function(){function n(e,t){if(!t.isDetached()){var n=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);return this.disconnectRuntime(),n}var r=t.getSource();switch(e){case"readAsBinaryString":return r;case"readAsDataURL":return"data:"+t.type+";base64,"+i.btoa(r);case"readAsText":for(var a="",o=0,s=r.length;o<s;o++)a+=String.fromCharCode(r[o]);return a}}t.call(this),e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(e){return n.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return n.call(this,"readAsDataURL",e)},readAsText:function(e){return n.call(this,"readAsText",e)}})}}),n("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(e,t,i){function n(){var e,n=[];t.extend(this,{append:function(r,a){var o=this,s=t.typeOf(a);a instanceof i?e={name:r,value:a}:"array"===s?(r+="[]",t.each(a,function(e){o.append(r,e)})):"object"===s?t.each(a,function(e,t){o.append(r+"["+t+"]",e)}):"null"===s||"undefined"===s||"number"===s&&isNaN(a)?o.append(r,"false"):n.push({name:r,value:a.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(i){t.each(n,function(e){i(e.value,e.name)}),e&&i(e.value,e.name)},destroy:function(){e=null,n=[]}})}return n}),n("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(e,t,i,n,r,a,o,s,u,c,l,h){function d(){this.uid=e.guid("uid_")}function f(){function i(e,t){if(S.hasOwnProperty(e))return 1===arguments.length?l.can("define_property")?S[e]:D[e]:void(l.can("define_property")?S[e]=t:D[e]=t)}function u(t){function n(){E.destroy(),E=null,s.dispatchEvent("loadend"),s=null}function r(r){E.bind("LoadStart",function(e){i("readyState",f.LOADING),s.dispatchEvent("readystatechange"),s.dispatchEvent(e),M&&s.upload.dispatchEvent(e)}),E.bind("Progress",function(e){i("readyState")!==f.LOADING&&(i("readyState",f.LOADING),s.dispatchEvent("readystatechange")),s.dispatchEvent(e)}),E.bind("UploadProgress",function(e){M&&s.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),E.bind("Load",function(t){i("readyState",f.DONE),i("status",Number(r.exec.call(E,"XMLHttpRequest","getStatus")||0)),i("statusText",p[i("status")]||""),i("response",r.exec.call(E,"XMLHttpRequest","getResponse",i("responseType"))),~e.inArray(i("responseType"),["text",""])?i("responseText",i("response")):"document"===i("responseType")&&i("responseXML",i("response")),H=r.exec.call(E,"XMLHttpRequest","getAllResponseHeaders"),s.dispatchEvent("readystatechange"),i("status")>0?(M&&s.upload.dispatchEvent(t),s.dispatchEvent(t)):(F=!0,s.dispatchEvent("error")),n()}),E.bind("Abort",function(e){s.dispatchEvent(e),n()}),E.bind("Error",function(e){F=!0,i("readyState",f.DONE),s.dispatchEvent("readystatechange"),L=!0,s.dispatchEvent(e),n()}),r.exec.call(E,"XMLHttpRequest","send",{url:v,method:y,async:k,user:w,password:x,headers:T,mimeType:A,encoding:I,responseType:s.responseType,withCredentials:s.withCredentials,options:U},t)}var s=this;b=(new Date).getTime(),E=new o,"string"==typeof U.required_caps&&(U.required_caps=a.parseCaps(U.required_caps)),U.required_caps=e.extend({},U.required_caps,{return_response_type:s.responseType}),t instanceof c&&(U.required_caps.send_multipart=!0),P||(U.required_caps.do_cors=!0),U.ruid?r(E.connectRuntime(U)):(E.bind("RuntimeInit",function(e,t){r(t)}),E.bind("RuntimeError",function(e,t){s.dispatchEvent("RuntimeError",t)}),E.connectRuntime(U))}function g(){i("responseText",""),i("responseXML",null),i("response",null),i("status",0),i("statusText",""),b=_=null}var v,y,w,x,b,_,E,R,D=this,S={timeout:0,readyState:f.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},k=!0,T={},I=null,A=null,C=!1,O=!1,M=!1,L=!1,F=!1,P=!1,N=null,B=null,U={},H="";e.extend(this,S,{uid:e.guid("uid_"),upload:new d,open:function(a,o,s,u,c){var l;if(!a||!o)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(a)||n.utf8_encode(a)!==a)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(~e.inArray(a.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(y=a.toUpperCase()),~e.inArray(y,["CONNECT","TRACE","TRACK"]))throw new t.DOMException(t.DOMException.SECURITY_ERR);if(o=n.utf8_encode(o),l=r.parseUrl(o),P=r.hasSameOrigin(l),v=r.resolveUrl(o),(u||c)&&!P)throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);if(w=u||l.user,x=c||l.pass,k=s||!0,k===!1&&(i("timeout")||i("withCredentials")||""!==i("responseType")))throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);C=!k,O=!1,T={},g.call(this),i("readyState",f.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(r,a){var o=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(i("readyState")!==f.OPENED||O)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(r)||n.utf8_encode(r)!==r)throw new t.DOMException(t.DOMException.SYNTAX_ERR);return r=e.trim(r).toLowerCase(),!~e.inArray(r,o)&&!/^(proxy\-|sec\-)/.test(r)&&(T[r]?T[r]+=", "+a:T[r]=a,!0)},getAllResponseHeaders:function(){return H||""},getResponseHeader:function(t){return t=t.toLowerCase(),F||~e.inArray(t,["set-cookie","set-cookie2"])?null:H&&""!==H&&(R||(R={},e.each(H.split(/\r\n/),function(t){var i=t.split(/:\s+/);2===i.length&&(i[0]=e.trim(i[0]),R[i[0].toLowerCase()]={header:i[0],value:e.trim(i[1])})})),R.hasOwnProperty(t))?R[t].header+": "+R[t].value:null},overrideMimeType:function(n){var r,a;if(~e.inArray(i("readyState"),[f.LOADING,f.DONE]))throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(n=e.trim(n.toLowerCase()),/;/.test(n)&&(r=n.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(n=r[1],r[2]&&(a=r[2])),!h.mimes[n])throw new t.DOMException(t.DOMException.SYNTAX_ERR);N=n,B=a},send:function(i,r){if(U="string"===e.typeOf(r)?{ruid:r}:r?r:{},this.convertEventPropsToHandlers(m),this.upload.convertEventPropsToHandlers(m),this.readyState!==f.OPENED||O)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(i instanceof s)U.ruid=i.ruid,A=i.type||"application/octet-stream";else if(i instanceof c){if(i.hasBlob()){var a=i.getBlob();U.ruid=a.ruid,A=a.type||"application/octet-stream"}}else"string"==typeof i&&(I="UTF-8",A="text/plain;charset=UTF-8",i=n.utf8_encode(i));this.withCredentials||(this.withCredentials=U.required_caps&&U.required_caps.send_browser_cookies&&!P),M=!C&&this.upload.hasEventListener(),F=!1,L=!i,C||(O=!0),u.call(this,i)},abort:function(){if(F=!0,C=!1,~e.inArray(i("readyState"),[f.UNSENT,f.OPENED,f.DONE]))i("readyState",f.UNSENT);else{if(i("readyState",f.DONE),O=!1,!E)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);E.getRuntime().exec.call(E,"XMLHttpRequest","abort",L),L=!0}},destroy:function(){E&&("function"===e.typeOf(E.destroy)&&E.destroy(),E=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var p={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};d.prototype=i.instance;var m=["loadstart","progress","abort","error","load","timeout","loadend"];return f.UNSENT=0,f.OPENED=1,f.HEADERS_RECEIVED=2,f.LOADING=3,f.DONE=4,f.prototype=i.instance,f}),n("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(e,t,i,n){function r(){function n(){l=h=0,c=this.result=null}function a(t,i){var n=this;u=i,n.bind("TransportingProgress",function(t){h=t.loaded,
h<l&&e.inArray(n.state,[r.IDLE,r.DONE])===-1&&o.call(n)},999),n.bind("TransportingComplete",function(){h=l,n.state=r.DONE,c=null,n.result=u.exec.call(n,"Transporter","getAsBlob",t||"")},999),n.state=r.BUSY,n.trigger("TransportingStarted"),o.call(n)}function o(){var e,i=this,n=l-h;d>n&&(d=n),e=t.btoa(c.substr(h,d)),u.exec.call(i,"Transporter","receive",e,l)}var s,u,c,l,h,d;i.call(this),e.extend(this,{uid:e.guid("uid_"),state:r.IDLE,result:null,transport:function(t,i,r){var o=this;if(r=e.extend({chunk_size:204798},r),(s=r.chunk_size%3)&&(r.chunk_size+=3-s),d=r.chunk_size,n.call(this),c=t,l=t.length,"string"===e.typeOf(r)||r.ruid)a.call(o,i,this.connectRuntime(r));else{var u=function(e,t){o.unbind("RuntimeInit",u),a.call(o,i,t)};this.bind("RuntimeInit",u),this.connectRuntime(r)}},abort:function(){var e=this;e.state=r.IDLE,u&&(u.exec.call(e,"Transporter","clear"),e.trigger("TransportingAborted")),n.call(e)},destroy:function(){this.unbindAll(),u=null,this.disconnectRuntime(),n.call(this)}})}return r.IDLE=0,r.BUSY=1,r.DONE=2,r.prototype=n.instance,r}),n("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(e,t,i,n,r,a,o,s,u,c,l,h,d){function f(){function n(e){e||(e=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=e.size,this.width=e.width,this.height=e.height,this.type=e.type,this.meta=e.meta,""===this.name&&(this.name=e.name)}function c(t){var n=e.typeOf(t);try{if(t instanceof f){if(!t.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);m.apply(this,arguments)}else if(t instanceof l){if(!~e.inArray(t.type,["image/jpeg","image/png"]))throw new i.ImageError(i.ImageError.WRONG_FORMAT);g.apply(this,arguments)}else if(e.inArray(n,["blob","file"])!==-1)c.call(this,new h(null,t),arguments[1]);else if("string"===n)/^data:[^;]*;base64,/.test(t)?c.call(this,new l(null,{data:t}),arguments[1]):v.apply(this,arguments);else{if("node"!==n||"img"!==t.nodeName.toLowerCase())throw new i.DOMException(i.DOMException.TYPE_MISMATCH_ERR);c.call(this,t.src,arguments[1])}}catch(r){this.trigger("error",r)}}function m(t,i){var n=this.connectRuntime(t.ruid);this.ruid=n.uid,n.exec.call(this,"Image","loadFromImage",t,"undefined"===e.typeOf(i)||i)}function g(t,i){function n(e){r.ruid=e.uid,e.exec.call(r,"Image","loadFromBlob",t)}var r=this;r.name=t.name||"",t.isDetached()?(this.bind("RuntimeInit",function(e,t){n(t)}),i&&"string"==typeof i.required_caps&&(i.required_caps=a.parseCaps(i.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},i))):n(this.connectRuntime(t.ruid))}function v(e,t){var i,n=this;i=new r,i.open("get",e),i.responseType="blob",i.onprogress=function(e){n.trigger(e)},i.onload=function(){g.call(n,i.response,!0)},i.onerror=function(e){n.trigger(e)},i.onloadend=function(){i.destroy()},i.bind("RuntimeError",function(e,t){n.trigger("RuntimeError",t)}),i.send(null,t)}o.call(this),e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){n.call(this)},999),this.convertEventPropsToHandlers(p),c.apply(this,arguments)},downsize:function(t,n,r,a){try{if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(this.width>f.MAX_RESIZE_WIDTH||this.height>f.MAX_RESIZE_HEIGHT)throw new i.ImageError(i.ImageError.MAX_RESOLUTION_ERR);(t||n)&&"undefined"!==e.typeOf(r)||(r=!1),t=t||this.width,n=n||this.height,a="undefined"===e.typeOf(a)||!!a,this.getRuntime().exec.call(this,"Image","downsize",t,n,r,a)}catch(o){this.trigger("error",o)}},crop:function(e,t,i){this.downsize(e,t,!0,i)},getAsCanvas:function(){if(!u.can("create_canvas"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);var e=this.connectRuntime(this.ruid);return e.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(e,t){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return e||(e="image/jpeg"),"image/jpeg"!==e||t||(t=90),this.getRuntime().exec.call(this,"Image","getAsBlob",e,t)},getAsDataURL:function(e,t){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",e,t)},getAsBinaryString:function(e,t){var i=this.getAsDataURL(e,t);return d.atob(i.substring(i.indexOf("base64,")+7))},embed:function(n){function r(){if(u.can("create_canvas")){var t=a.getAsCanvas();if(t)return n.appendChild(t),t=null,a.destroy(),void p.trigger("embedded")}var r=a.getAsDataURL(o,c);if(!r)throw new i.ImageError(i.ImageError.WRONG_FORMAT);if(u.can("use_data_uri_of",r.length))n.innerHTML='<img src="'+r+'" width="'+a.width+'" height="'+a.height+'" />',a.destroy(),p.trigger("embedded");else{var l=new s;l.bind("TransportingComplete",function(){h=p.connectRuntime(this.result.ruid),p.bind("Embedded",function(){e.extend(h.getShimContainer().style,{top:"0px",left:"0px",width:a.width+"px",height:a.height+"px"}),h=null},999),h.exec.call(p,"ImageView","display",this.result.uid,g,v),a.destroy()}),l.transport(d.atob(r.substring(r.indexOf("base64,")+7)),o,e.extend({},m,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:n}))}}var a,o,c,l,h,p=this,m=arguments[1]||{},g=this.width,v=this.height;try{if(!(n=t.get(n)))throw new i.DOMException(i.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(this.width>f.MAX_RESIZE_WIDTH||this.height>f.MAX_RESIZE_HEIGHT)throw new i.ImageError(i.ImageError.MAX_RESOLUTION_ERR);if(o=m.type||this.type||"image/jpeg",c=m.quality||90,l="undefined"!==e.typeOf(m.crop)&&m.crop,m.width)g=m.width,v=m.height||g;else{var y=t.getSize(n);y.w&&y.h&&(g=y.w,v=y.h)}return a=new f,a.bind("Resize",function(){r.call(p)}),a.bind("Load",function(){a.downsize(g,v,l,!1)}),a.clone(this,!1),a}catch(w){this.trigger("error",w)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var p=["progress","load","error","resize","embedded"];return f.MAX_RESIZE_WIDTH=6500,f.MAX_RESIZE_HEIGHT=6500,f.prototype=c.instance,f}),n("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,t,i,n){function r(t){var r=this,s=i.capTest,u=i.capTrue,c=e.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return r.can("access_binary")&&!!o.Image},display_media:s(n.can("create_canvas")||n.can("use_data_uri_over32kb")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==n.browser||n.version>9)}()),filter_by_extension:s(function(){return"Chrome"===n.browser&&n.version>=28||"IE"===n.browser&&n.version>=10}()),return_response_headers:u,return_response_type:function(e){return!("json"!==e||!window.JSON)||n.can("return_response_type",e)},return_status_code:u,report_upload_progress:s(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return r.can("access_binary")&&n.can("create_canvas")},select_file:function(){return n.can("use_fileinput")&&window.File},select_folder:function(){return r.can("select_file")&&"Chrome"===n.browser&&n.version>=21},select_multiple:function(){return r.can("select_file")&&!("Safari"===n.browser&&"Windows"===n.os)&&!("iOS"===n.os&&n.verComp(n.osVersion,"7.0.4","<"))},send_binary_string:s(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||r.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return r.can("slice_blob")&&r.can("send_multipart")},summon_file_dialog:s(function(){return"Firefox"===n.browser&&n.version>=4||"Opera"===n.browser&&n.version>=12||"IE"===n.browser&&n.version>=10||!!~e.inArray(n.browser,["Chrome","Safari"])}()),upload_filesize:u},arguments[2]);i.call(this,t,arguments[1]||a,c),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(r),e=r=null}}(this.destroy)}),e.extend(this.getShim(),o)}var a="html5",o={};return i.addConstructor(a,r),o}),n("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(e,t){function i(){function e(e,t,i){var n;if(!window.File.prototype.slice)return(n=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?n.call(e,t,i):null;try{return e.slice(),e.slice(t,i)}catch(r){return e.slice(t,i-t)}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))}}return e.Blob=i}),n("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(e){function t(){this.returnValue=!1}function i(){this.cancelBubble=!0}var n={},r="moxie_"+e.guid(),a=function(a,o,s,u){var c,l;o=o.toLowerCase(),a.addEventListener?(c=s,a.addEventListener(o,c,!1)):a.attachEvent&&(c=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=t,e.stopPropagation=i,s(e)},a.attachEvent("on"+o,c)),a[r]||(a[r]=e.guid()),n.hasOwnProperty(a[r])||(n[a[r]]={}),l=n[a[r]],l.hasOwnProperty(o)||(l[o]=[]),l[o].push({func:c,orig:s,key:u})},o=function(t,i,a){var o,s;if(i=i.toLowerCase(),t[r]&&n[t[r]]&&n[t[r]][i]){o=n[t[r]][i];for(var u=o.length-1;u>=0&&(o[u].orig!==a&&o[u].key!==a||(t.removeEventListener?t.removeEventListener(i,o[u].func,!1):t.detachEvent&&t.detachEvent("on"+i,o[u].func),o[u].orig=null,o[u].func=null,o.splice(u,1),a===s));u--);if(o.length||delete n[t[r]][i],e.isEmptyObj(n[t[r]])){delete n[t[r]];try{delete t[r]}catch(c){t[r]=s}}}},s=function(t,i){t&&t[r]&&e.each(n[t[r]],function(e,n){o(t,n,i)})};return{addEvent:a,removeEvent:o,removeAllEvents:s}}),n("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,a){function o(){var e,o=[];t.extend(this,{init:function(s){var u,c,l,h,d,f,p=this,m=p.getRuntime();e=s,o=[],l=e.accept.mimes||r.extList2mimes(e.accept,m.can("filter_by_extension")),c=m.getShimContainer(),c.innerHTML='<input id="'+m.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&m.can("select_multiple")?"multiple":"")+(e.directory&&m.can("select_folder")?"webkitdirectory directory":"")+(l?' accept="'+l.join(",")+'"':"")+" />",u=i.get(m.uid),t.extend(u.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),h=i.get(e.browse_button),m.can("summon_file_dialog")&&("static"===i.getStyle(h,"position")&&(h.style.position="relative"),d=parseInt(i.getStyle(h,"z-index"),10)||1,h.style.zIndex=d,c.style.zIndex=d-1,n.addEvent(h,"click",function(e){var t=i.get(m.uid);t&&!t.disabled&&t.click(),e.preventDefault()},p.uid)),f=m.can("summon_file_dialog")?h:c,n.addEvent(f,"mouseover",function(){p.trigger("mouseenter")},p.uid),n.addEvent(f,"mouseout",function(){p.trigger("mouseleave")},p.uid),n.addEvent(f,"mousedown",function(){p.trigger("mousedown")},p.uid),n.addEvent(i.get(e.container),"mouseup",function(){p.trigger("mouseup")},p.uid),u.onchange=function g(){if(o=[],e.directory?t.each(this.files,function(e){"."!==e.name&&o.push(e)}):o=[].slice.call(this.files),"IE"!==a.browser)this.value="";else{var i=this.cloneNode(!0);this.parentNode.replaceChild(i,this),i.onchange=g}p.trigger("change")},p.trigger({type:"ready",async:!0}),c=null},getFiles:function(){return o},disable:function(e){var t,n=this.getRuntime();(t=i.get(n.uid))&&(t.disabled=!!e)},destroy:function(){var t=this.getRuntime(),r=t.getShim(),a=t.getShimContainer();n.removeAllEvents(a,this.uid),n.removeAllEvents(e&&i.get(e.container),this.uid),n.removeAllEvents(e&&i.get(e.browse_button),this.uid),a&&(a.innerHTML=""),r.removeInstance(this.uid),o=e=a=r=null}})}return e.FileInput=o}),n("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(e,t,i,n,r){function a(){function e(e){for(var i=[],n=0;n<e.length;n++)[].push.apply(i,e[n].extensions.split(/\s*,\s*/));return t.inArray("*",i)===-1?i:[]}function a(e){var i=r.getFileExtension(e.name);return!i||!d.length||t.inArray(i,d)!==-1}function o(e,i){var n=[];t.each(e,function(e){var t=e.webkitGetAsEntry();if(t)if(t.isFile){var i=e.getAsFile();a(i)&&h.push(i)}else n.push(t)}),n.length?s(n,i):i()}function s(e,i){var n=[];t.each(e,function(e){n.push(function(t){u(e,t)})}),t.inSeries(n,function(){i()})}function u(e,t){e.isFile?e.file(function(e){a(e)&&h.push(e),t()},function(){t()}):e.isDirectory?c(e,t):t()}function c(e,t){function i(e){r.readEntries(function(t){t.length?([].push.apply(n,t),i(e)):e()},e)}var n=[],r=e.createReader();i(function(){s(n,t)})}var l,h=[],d=[];t.extend(this,{init:function(i){var r,s=this;l=i,d=e(l.accept),r=l.container,n.addEvent(r,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},s.uid),n.addEvent(r,"drop",function(e){e.preventDefault(),e.stopPropagation(),h=[],e.dataTransfer.items&&e.dataTransfer.items[0].webkitGetAsEntry?o(e.dataTransfer.items,function(){s.trigger("drop")}):(t.each(e.dataTransfer.files,function(e){a(e)&&h.push(e)}),s.trigger("drop"))},s.uid),n.addEvent(r,"dragenter",function(e){e.preventDefault(),e.stopPropagation(),s.trigger("dragenter")},s.uid),n.addEvent(r,"dragleave",function(e){e.preventDefault(),e.stopPropagation(),s.trigger("dragleave")},s.uid)},getFiles:function(){return h},destroy:function(){n.removeAllEvents(l&&i.get(l.container),this.uid),h=d=l=null}})}return e.FileDrop=a}),n("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(e,t,i){function n(){function e(e){return t.atob(e.substring(e.indexOf("base64,")+7))}var n,r=!1;i.extend(this,{read:function(e,t){var a=this;n=new window.FileReader,n.addEventListener("progress",function(e){a.trigger(e)}),n.addEventListener("load",function(e){a.trigger(e)}),n.addEventListener("error",function(e){a.trigger(e,n.error)}),n.addEventListener("loadend",function(){n=null}),"function"===i.typeOf(n[e])?(r=!1,n[e](t.getSource())):"readAsBinaryString"===e&&(r=!0,n.readAsDataURL(t.getSource()))},getResult:function(){return n&&n.result?r?e(n.result):n.result:null},abort:function(){n&&n.abort()},destroy:function(){n=null}})}return e.FileReader=n}),n("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(e,t,i,n,r,a,o,s,u){function c(){function e(e,t){var i,n,r=this;i=t.getBlob().getSource(),n=new window.FileReader,n.onload=function(){t.append(t.getBlobName(),new a(null,{type:i.type,data:n.result})),p.send.call(r,e,t)},n.readAsBinaryString(i)}function c(){return!window.XMLHttpRequest||"IE"===u.browser&&u.version<8?function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(i){}}():new window.XMLHttpRequest}function l(e){var t=e.responseXML,i=e.responseText;return"IE"===u.browser&&i&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(i)),t&&("IE"===u.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName)?null:t}function h(e){var t="----moxieboundary"+(new Date).getTime(),i="--",n="\r\n",r="",o=this.getRuntime();if(!o.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return d.setRequestHeader("Content-Type","multipart/form-data; boundary="+t),e.each(function(e,o){r+=e instanceof a?i+t+n+'Content-Disposition: form-data; name="'+o+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+n+"Content-Type: "+(e.type||"application/octet-stream")+n+n+e.getSource()+n:i+t+n+'Content-Disposition: form-data; name="'+o+'"'+n+n+unescape(encodeURIComponent(e))+n}),r+=i+t+i+n}var d,f,p=this;t.extend(this,{send:function(i,r){var s=this,l="Mozilla"===u.browser&&u.version>=4&&u.version<7,p="Android Browser"===u.browser,m=!1;if(f=i.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),d=c(),d.open(i.method,i.url,i.async,i.user,i.password),r instanceof a)r.isDetached()&&(m=!0),r=r.getSource();else if(r instanceof o){if(r.hasBlob())if(r.getBlob().isDetached())r=h.call(s,r),m=!0;else if((l||p)&&"blob"===t.typeOf(r.getBlob().getSource())&&window.FileReader)return void e.call(s,i,r);if(r instanceof o){var g=new window.FormData;r.each(function(e,t){e instanceof a?g.append(t,e.getSource()):g.append(t,e)}),r=g}}d.upload?(i.withCredentials&&(d.withCredentials=!0),d.addEventListener("load",function(e){s.trigger(e)}),d.addEventListener("error",function(e){s.trigger(e)}),d.addEventListener("progress",function(e){s.trigger(e)}),d.upload.addEventListener("progress",function(e){s.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):d.onreadystatechange=function(){switch(d.readyState){case 1:break;case 2:break;case 3:var e,t;try{n.hasSameOrigin(i.url)&&(e=d.getResponseHeader("Content-Length")||0),d.responseText&&(t=d.responseText.length)}catch(r){e=t=0}s.trigger({type:"progress",lengthComputable:!!e,total:parseInt(e,10),loaded:t});break;case 4:d.onreadystatechange=function(){},0===d.status?s.trigger("error"):s.trigger("load")}},t.isEmptyObj(i.headers)||t.each(i.headers,function(e,t){d.setRequestHeader(t,e)}),""!==i.responseType&&"responseType"in d&&("json"!==i.responseType||u.can("return_response_type","json")?d.responseType=i.responseType:d.responseType="text"),m?d.sendAsBinary?d.sendAsBinary(r):!function(){for(var e=new Uint8Array(r.length),t=0;t<r.length;t++)e[t]=255&r.charCodeAt(t);d.send(e.buffer)}():d.send(r),s.trigger("loadstart")},getStatus:function(){try{if(d)return d.status}catch(e){}return 0},getResponse:function(e){var t=this.getRuntime();try{switch(e){case"blob":var n=new r(t.uid,d.response),a=d.getResponseHeader("Content-Disposition");if(a){var o=a.match(/filename=([\'\"'])([^\1]+)\1/);o&&(f=o[2])}return n.name=f,n.type||(n.type=i.getFileMime(f)),n;case"json":return u.can("return_response_type","json")?d.response:200===d.status&&window.JSON?JSON.parse(d.responseText):null;case"document":return l(d);default:return""!==d.responseText?d.responseText:null}}catch(s){return null}},getAllResponseHeaders:function(){try{return d.getAllResponseHeaders()}catch(e){}return""},abort:function(){d&&d.abort()},destroy:function(){p=f=null}})}return e.XMLHttpRequest=c}),n("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function e(e,t){var i,n=a?0:-8*(t-1),o=0;for(i=0;i<t;i++)o|=r.charCodeAt(e+i)<<Math.abs(n+8*i);return o}function i(e,t,i){i=3===arguments.length?i:r.length-t-1,r=r.substr(0,t)+e+r.substr(i+t)}function n(e,t,n){var r,o="",s=a?0:-8*(n-1);for(r=0;r<n;r++)o+=String.fromCharCode(t>>Math.abs(s+8*r)&255);i(o,e,n)}var r,a=!1;return{II:function(e){return e===t?a:void(a=e)},init:function(e){a=!1,r=e},SEGMENT:function(e,t,n){switch(arguments.length){case 1:return r.substr(e,r.length-e-1);case 2:return r.substr(e,t);case 3:i(n,e,t);break;default:return r}},BYTE:function(t){return e(t,1)},SHORT:function(t){return e(t,2)},LONG:function(i,r){return r===t?e(i,4):void n(i,r,4)},SLONG:function(t){var i=e(t,4);return i>2147483647?i-4294967296:i},STRING:function(t,i){var n="";for(i+=t;t<i;t++)n+=String.fromCharCode(e(t,1));return n}}}}),n("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],function(e){return function t(i){var n,r,a,o=[],s=0;if(n=new e,n.init(i),65496===n.SHORT(0)){for(r=2;r<=i.length;)if(a=n.SHORT(r),a>=65488&&a<=65495)r+=2;else{if(65498===a||65497===a)break;s=n.SHORT(r+2)+2,a>=65505&&a<=65519&&o.push({hex:a,name:"APP"+(15&a),start:r,length:s,segment:n.SEGMENT(r,s)}),r+=s}return n.init(null),{headers:o,restore:function(e){var t,i;for(n.init(e),r=65504==n.SHORT(2)?4+n.SHORT(4):2,i=0,t=o.length;i<t;i++)n.SEGMENT(r,0,o[i].segment),r+=o[i].length;return e=n.SEGMENT(),n.init(null),e},strip:function(e){var i,r,a;for(r=new t(e),i=r.headers,r.purge(),n.init(e),a=i.length;a--;)n.SEGMENT(i[a].start,i[a].length,"");return e=n.SEGMENT(),n.init(null),e},get:function(e){for(var t=[],i=0,n=o.length;i<n;i++)o[i].name===e.toUpperCase()&&t.push(o[i].segment);return t},set:function(e,t){var i,n,r,a=[];for("string"==typeof t?a.push(t):a=t,i=n=0,r=o.length;i<r&&(o[i].name===e.toUpperCase()&&(o[i].segment=a[n],o[i].length=a[n].length,n++),!(n>=a.length));i++);},purge:function(){o=[],n.init(null),n=null}}}}}),n("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(e,i){return function(){function n(e,i){var n,r,a,s,u,h,d,f,p=o.SHORT(e),m=[],g={};for(n=0;n<p;n++)if(d=h=e+12*n+2,a=i[o.SHORT(d)],a!==t){switch(s=o.SHORT(d+=2),u=o.LONG(d+=2),d+=4,m=[],s){case 1:case 7:for(u>4&&(d=o.LONG(d)+l.tiffHeader),r=0;r<u;r++)m[r]=o.BYTE(d+r);break;case 2:u>4&&(d=o.LONG(d)+l.tiffHeader),g[a]=o.STRING(d,u-1);continue;case 3:for(u>2&&(d=o.LONG(d)+l.tiffHeader),r=0;r<u;r++)m[r]=o.SHORT(d+2*r);break;case 4:for(u>1&&(d=o.LONG(d)+l.tiffHeader),r=0;r<u;r++)m[r]=o.LONG(d+4*r);break;case 5:for(d=o.LONG(d)+l.tiffHeader,r=0;r<u;r++)m[r]=o.LONG(d+4*r)/o.LONG(d+4*r+4);break;case 9:for(d=o.LONG(d)+l.tiffHeader,r=0;r<u;r++)m[r]=o.SLONG(d+4*r);break;case 10:for(d=o.LONG(d)+l.tiffHeader,r=0;r<u;r++)m[r]=o.SLONG(d+4*r)/o.SLONG(d+4*r+4);break;default:continue}f=1==u?m[0]:m,c.hasOwnProperty(a)&&"object"!=typeof f?g[a]=c[a][f]:g[a]=f}return g}function r(){var e=l.tiffHeader;return o.II(18761==o.SHORT(e)),42===o.SHORT(e+=2)&&(l.IFD0=l.tiffHeader+o.LONG(e+=2),u=n(l.IFD0,s.tiff),"ExifIFDPointer"in u&&(l.exifIFD=l.tiffHeader+u.ExifIFDPointer,delete u.ExifIFDPointer),"GPSInfoIFDPointer"in u&&(l.gpsIFD=l.tiffHeader+u.GPSInfoIFDPointer,delete u.GPSInfoIFDPointer),!0)}function a(e,t,i){var n,r,a,u=0;if("string"==typeof t){var c=s[e.toLowerCase()];for(var h in c)if(c[h]===t){t=h;break}}n=l[e.toLowerCase()+"IFD"],r=o.SHORT(n);for(var d=0;d<r;d++)if(a=n+12*d+2,o.SHORT(a)==t){u=a+8;break}return!!u&&(o.LONG(u,i),!0)}var o,s,u,c,l={};return o=new i,s={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},c={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(e){return l={tiffHeader:10},!(e===t||!e.length)&&(o.init(e),65505===o.SHORT(0)&&"EXIF\0"===o.STRING(4,5).toUpperCase()&&r())},TIFF:function(){return u},EXIF:function(){var t;if(t=n(l.exifIFD,s.exif),t.ExifVersion&&"array"===e.typeOf(t.ExifVersion)){for(var i=0,r="";i<t.ExifVersion.length;i++)r+=String.fromCharCode(t.ExifVersion[i]);t.ExifVersion=r}return t},GPS:function(){var t;return t=n(l.gpsIFD,s.gps),t.GPSVersionID&&"array"===e.typeOf(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join(".")),t},setExif:function(e,t){return("PixelXDimension"===e||"PixelYDimension"===e)&&a("exif",e,t)},getBinary:function(){return o.SEGMENT()},purge:function(){o.init(null),o=u=null,l={}}}}}),n("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(e,t,i,n,r){function a(a){function o(){for(var e,t,i=0;i<=u.length;){if(e=c.SHORT(i+=2),e>=65472&&e<=65475)return i+=5,{height:c.SHORT(i),width:c.SHORT(i+=2)};t=c.SHORT(i+=2),i+=t-2}return null}function s(){h&&l&&c&&(h.purge(),l.purge(),c.init(null),u=d=l=h=c=null)}var u,c,l,h,d,f;if(u=a,c=new n,c.init(u),65496!==c.SHORT(0))throw new t.ImageError(t.ImageError.WRONG_FORMAT);l=new i(a),h=new r,f=!!h.init(l.get("app1")[0]),d=o.call(this),e.extend(this,{type:"image/jpeg",size:u.length,width:d&&d.width||0,height:d&&d.height||0,setExif:function(t,i){return!!f&&("object"===e.typeOf(t)?e.each(t,function(e,t){h.setExif(t,e)}):h.setExif(t,i),void l.set("app1",h.getBinary()))},writeHeaders:function(){return arguments.length?l.restore(arguments[0]):u=l.restore(u)},stripHeaders:function(e){return l.strip(e)},purge:function(){s.call(this)}}),f&&(this.meta={tiff:h.TIFF(),exif:h.EXIF(),gps:h.GPS()})}return a}),n("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(e,t,i){function n(n){function r(){var e,t;return e=o.call(this,8),"IHDR"==e.type?(t=e.start,{width:u.LONG(t),height:u.LONG(t+=4)}):null}function a(){u&&(u.init(null),s=h=c=l=u=null)}function o(e){var t,i,n,r;return t=u.LONG(e),i=u.STRING(e+=4,4),n=e+=4,r=u.LONG(e+t),{length:t,type:i,start:n,CRC:r}}var s,u,c,l,h;s=n,u=new i,u.init(s),function(){var t=0,i=0,n=[35152,20039,3338,6666];for(i=0;i<n.length;i++,t+=2)if(n[i]!=u.SHORT(t))throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),h=r.call(this),t.extend(this,{type:"image/png",size:s.length,width:h.width,height:h.height,purge:function(){a.call(this)}}),a.call(this)}return n}),n("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(e,t,i,n){return function(r){var a,o=[i,n];a=function(){for(var e=0;e<o.length;e++)try{return new o[e](r)}catch(i){}throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(e){return e},stripHeaders:function(e){return e},purge:function(){}}),e.extend(this,a),this.purge=function(){a.purge(),a=null}}}),n("moxie/runtime/html5/image/MegaPixel",[],function(){function e(e,n,r){var a=e.naturalWidth,o=e.naturalHeight,s=r.width,u=r.height,c=r.x||0,l=r.y||0,h=n.getContext("2d");t(e)&&(a/=2,o/=2);var d=1024,f=document.createElement("canvas");f.width=f.height=d;for(var p=f.getContext("2d"),m=i(e,a,o),g=0;g<o;){for(var v=g+d>o?o-g:d,y=0;y<a;){var w=y+d>a?a-y:d;p.clearRect(0,0,d,d),p.drawImage(e,-y,-g);var x=y*s/a+c<<0,b=Math.ceil(w*s/a),_=g*u/o/m+l<<0,E=Math.ceil(v*u/o/m);h.drawImage(f,0,0,w,v,x,_,b,E),y+=d}g+=d}f=p=null}function t(e){var t=e.naturalWidth,i=e.naturalHeight;if(t*i>1048576){var n=document.createElement("canvas");n.width=n.height=1;var r=n.getContext("2d");return r.drawImage(e,-t+1,0),0===r.getImageData(0,0,1,1).data[3]}return!1}function i(e,t,i){var n=document.createElement("canvas");n.width=1,n.height=i;var r=n.getContext("2d");r.drawImage(e,0,0);for(var a=r.getImageData(0,0,1,i).data,o=0,s=i,u=i;u>o;){var c=a[4*(u-1)+3];0===c?s=u:o=u,u=s+o>>1}n=null;var l=u/i;return 0===l?1:l}return{isSubsampled:t,renderTo:e}}),n("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/MegaPixel","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,a,o,s,u){function c(){function e(){if(!w&&!v)throw new i.ImageError(i.DOMException.INVALID_STATE_ERR);return w||v}function c(e){return n.atob(e.substring(e.indexOf("base64,")+7))}function l(e,t){return"data:"+(t||"")+";base64,"+n.btoa(e)}function h(e){var t=this;v=new Image,v.onerror=function(){g.call(this),t.trigger("error",new i.ImageError(i.ImageError.WRONG_FORMAT))},v.onload=function(){t.trigger("load")},v.src=/^data:[^;]*;base64,/.test(e)?e:l(e,b.type)}function d(e,t){var n,r=this;return window.FileReader?(n=new FileReader,n.onload=function(){t(this.result)},n.onerror=function(){r.trigger("error",new i.FileException(i.FileException.NOT_READABLE_ERR))},n.readAsDataURL(e),void 0):t(e.getAsDataURL())}function f(i,n,r,a){var o,s,u,c,l,h,d=this,f=0,g=0;if(R=a,h=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,t.inArray(h,[5,6,7,8])!==-1){var v=i;i=n,n=v}return u=e(),s=r?Math.max:Math.min,o=s(i/u.width,n/u.height),o>1&&(!r||a)?void this.trigger("Resize"):(w||(w=document.createElement("canvas")),c=Math.round(u.width*o),l=Math.round(u.height*o),r?(w.width=i,w.height=n,c>i&&(f=Math.round((c-i)/2)),l>n&&(g=Math.round((l-n)/2))):(w.width=c,w.height=l),R||m(w.width,w.height,h),p.call(this,u,w,-f,-g,c,l),this.width=w.width,this.height=w.height,E=!0,void d.trigger("Resize"))}function p(e,t,i,n,r,a){if("iOS"===u.OS)o.renderTo(e,t,{width:r,height:a,x:i,y:n});else{var s=t.getContext("2d");s.drawImage(e,i,n,r,a)}}function m(e,t,i){switch(i){case 5:case 6:case 7:case 8:w.width=t,w.height=e;break;default:w.width=e,w.height=t}var n=w.getContext("2d");switch(i){case 2:n.translate(e,0),n.scale(-1,1);break;case 3:n.translate(e,t),n.rotate(Math.PI);break;case 4:n.translate(0,t),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-t);break;case 7:n.rotate(.5*Math.PI),n.translate(e,-t),n.scale(-1,1);break;case 8:
n.rotate(-.5*Math.PI),n.translate(-e,0)}}function g(){y&&(y.purge(),y=null),x=v=w=b=null,E=!1}var v,y,w,x,b,_=this,E=!1,R=!0;t.extend(this,{loadFromBlob:function(e){var t=this,n=t.getRuntime(),r=!(arguments.length>1)||arguments[1];if(!n.can("access_binary"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);return b=e,e.isDetached()?(x=e.getSource(),void h.call(this,x)):void d.call(this,e.getSource(),function(e){r&&(x=c(e)),h.call(t,e)})},loadFromImage:function(e,t){this.meta=e.meta,b=new r(null,{name:e.name,size:e.size,type:e.type}),h.call(this,t?x=e.getAsBinaryString():e.getAsDataURL())},getInfo:function(){var t,i=this.getRuntime();return!y&&x&&i.can("access_image_binary")&&(y=new a(x)),t={width:e().width||0,height:e().height||0,type:b.type||s.getFileMime(b.name),size:x&&x.length||b.size||0,name:b.name||"",meta:y&&y.meta||this.meta||{}}},downsize:function(){f.apply(this,arguments)},getAsCanvas:function(){return w&&(w.id=this.uid+"_canvas"),w},getAsBlob:function(e,t){return e!==this.type&&f.call(this,this.width,this.height,!1),new r(null,{name:b.name||"",type:e,data:_.getAsBinaryString.call(this,e,t)})},getAsDataURL:function(e){var t=arguments[1]||90;if(!E)return v.src;if("image/jpeg"!==e)return w.toDataURL("image/png");try{return w.toDataURL("image/jpeg",t/100)}catch(i){return w.toDataURL("image/jpeg")}},getAsBinaryString:function(e,t){if(!E)return x||(x=c(_.getAsDataURL(e,t))),x;if("image/jpeg"!==e)x=c(_.getAsDataURL(e,t));else{var i;t||(t=90);try{i=w.toDataURL("image/jpeg",t/100)}catch(n){i=w.toDataURL("image/jpeg")}x=c(i),y&&(x=y.stripHeaders(x),R&&(y.meta&&y.meta.exif&&y.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),x=y.writeHeaders(x)),y.purge(),y=null)}return E=!1,x},destroy:function(){_=null,g.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return e.Image=c}),n("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,t,i,n,r){function a(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(i){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}function o(o){var c,l=this;o=e.extend({swf_url:t.swf_url},o),r.call(this,o,s,{access_binary:function(e){return e&&"browser"===l.mode},access_image_binary:function(e){return e&&"browser"===l.mode},display_media:r.capTrue,do_cors:r.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===l.mode},resize_image:r.capTrue,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||(!e.arrayDiff(t,["","text","document"])||"browser"===l.mode)},return_status_code:function(t){return"browser"===l.mode||!e.arrayDiff(t,[200,404])},select_file:r.capTrue,select_multiple:r.capTrue,send_binary_string:function(e){return e&&"browser"===l.mode},send_browser_cookies:function(e){return e&&"browser"===l.mode},send_custom_headers:function(e){return e&&"browser"===l.mode},send_multipart:r.capTrue,slice_blob:r.capTrue,stream_upload:function(e){return e&&"browser"===l.mode},summon_file_dialog:!1,upload_filesize:function(t){return e.parseSizeStr(t)<=2097152||"client"===l.mode},use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}},{access_binary:function(e){return e?"browser":"client"},access_image_binary:function(e){return e?"browser":"client"},report_upload_progress:function(e){return e?"browser":"client"},return_response_type:function(t){return e.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function(e){return e?"browser":"client"},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"browser":"client"},stream_upload:function(e){return e?"client":"browser"},upload_filesize:function(t){return e.parseSizeStr(t)>=2097152?"client":"browser"}},"client"),a()<10&&(this.mode=!1),e.extend(this,{getShim:function(){return i.get(this.uid)},shimExec:function(e,t){var i=[].slice.call(arguments,2);return l.getShim().exec(this.uid,e,t,i)},init:function(){var i,r,a;a=this.getShimContainer(),e.extend(a.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),i='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+o.swf_url+'" ',"IE"===t.browser&&(i+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),i+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+o.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+t.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===t.browser?(r=document.createElement("div"),a.appendChild(r),r.outerHTML=i,r=a=null):a.innerHTML=i,c=setTimeout(function(){l&&!l.initialized&&l.trigger("Error",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(e){return function(){e.call(l),clearTimeout(c),o=c=e=l=null}}(this.destroy)},u)}var s="flash",u={};return r.addConstructor(s,o),u}),n("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,t){var i={slice:function(e,i,n,r){var a=this.getRuntime();return i<0?i=Math.max(e.size+i,0):i>0&&(i=Math.min(i,e.size)),n<0?n=Math.max(e.size+n,0):n>0&&(n=Math.min(n,e.size)),e=a.shimExec.call(this,"Blob","slice",i,n,r||""),e&&(e=new t(a.uid,e)),e}};return e.Blob=i}),n("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(e){var t={init:function(e){this.getRuntime().shimExec.call(this,"FileInput","init",{name:e.name,accept:e.accept,multiple:e.multiple}),this.trigger("ready")}};return e.FileInput=t}),n("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,t){function i(e,i){switch(i){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var n="",r={read:function(e,t){var r=this,a=r.getRuntime();return"readAsDataURL"===e&&(n="data:"+(t.type||"")+";base64,"),r.bind("Progress",function(t,r){r&&(n+=i(r,e))}),a.shimExec.call(this,"FileReader","readAsBase64",t.uid)},getResult:function(){return n},destroy:function(){n=null}};return e.FileReader=r}),n("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(e,t){function i(e,i){switch(i){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var n={read:function(e,t){var n,r=this.getRuntime();return(n=r.shimExec.call(this,"FileReaderSync","readAsBase64",t.uid))?("readAsDataURL"===e&&(n="data:"+(t.type||"")+";base64,"+n),i(n,e,t.type)):null}};return e.FileReaderSync=n}),n("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter"],function(e,t,i,n,r,a,o){var s={send:function(e,n){function r(){e.transport=l.mode,l.shimExec.call(c,"XMLHttpRequest","send",e,n)}function s(e,t){l.shimExec.call(c,"XMLHttpRequest","appendBlob",e,t.uid),n=null,r()}function u(e,t){var i=new o;i.bind("TransportingComplete",function(){t(this.result)}),i.transport(e.getSource(),e.type,{ruid:l.uid})}var c=this,l=c.getRuntime();if(t.isEmptyObj(e.headers)||t.each(e.headers,function(e,t){l.shimExec.call(c,"XMLHttpRequest","setRequestHeader",t,e.toString())}),n instanceof a){var h;if(n.each(function(e,t){e instanceof i?h=t:l.shimExec.call(c,"XMLHttpRequest","append",t,e)}),n.hasBlob()){var d=n.getBlob();d.isDetached()?u(d,function(e){d.destroy(),s(h,e)}):s(h,d)}else n=null,r()}else n instanceof i?n.isDetached()?u(n,function(e){n.destroy(),n=e.uid,r()}):(n=n.uid,r()):r()},getResponse:function(e){var i,a,o=this.getRuntime();if(a=o.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(a=new n(o.uid,a),"blob"===e)return a;try{if(i=new r,~t.inArray(e,["","text"]))return i.readAsText(a);if("json"===e&&window.JSON)return JSON.parse(i.readAsText(a))}finally{a.destroy()}}return null},abort:function(e){var t=this.getRuntime();t.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return e.XMLHttpRequest=s}),n("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(e,t){var i={getAsBlob:function(e){var i=this.getRuntime(),n=i.shimExec.call(this,"Transporter","getAsBlob",e);return n?new t(i.uid,n):null}};return e.Transporter=i}),n("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(e,t,i,n,r){var a={loadFromBlob:function(e){function t(e){r.shimExec.call(n,"Image","loadFromBlob",e.uid),n=r=null}var n=this,r=n.getRuntime();if(e.isDetached()){var a=new i;a.bind("TransportingComplete",function(){t(a.result.getSource())}),a.transport(e.getSource(),e.type,{ruid:r.uid})}else t(e.getSource())},loadFromImage:function(e){var t=this.getRuntime();return t.shimExec.call(this,"Image","loadFromImage",e.uid)},getAsBlob:function(e,t){var i=this.getRuntime(),r=i.shimExec.call(this,"Image","getAsBlob",e,t);return r?new n(i.uid,r):null},getAsDataURL:function(){var e,t=this.getRuntime(),i=t.Image.getAsBlob.apply(this,arguments);return i?(e=new r,e.readAsDataURL(i)):null}};return e.Image=a}),n("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(e,t,i,n,r){function a(e){var t,i,n,r,a,o=!1,s=null,u=0;try{try{s=new ActiveXObject("AgControl.AgControl"),s.IsVersionSupported(e)&&(o=!0),s=null}catch(c){var l=navigator.plugins["Silverlight Plug-In"];if(l){for(t=l.description,"1.0.30226.2"===t&&(t="2.0.30226.2"),i=t.split(".");i.length>3;)i.pop();for(;i.length<4;)i.push(0);for(n=e.split(".");n.length>4;)n.pop();do r=parseInt(n[u],10),a=parseInt(i[u],10),u++;while(u<n.length&&r===a);r<=a&&!isNaN(r)&&(o=!0)}}}catch(h){o=!1}return o}function o(o){var c,l=this;o=e.extend({xap_url:t.xap_url},o),r.call(this,o,s,{access_binary:r.capTrue,access_image_binary:r.capTrue,display_media:r.capTrue,do_cors:r.capTrue,drag_and_drop:!1,report_upload_progress:r.capTrue,resize_image:r.capTrue,return_response_headers:function(e){return e&&"client"===l.mode},return_response_type:function(e){return"json"!==e||!!window.JSON},return_status_code:function(t){return"client"===l.mode||!e.arrayDiff(t,[200,404])},select_file:r.capTrue,select_multiple:r.capTrue,send_binary_string:r.capTrue,send_browser_cookies:function(e){return e&&"browser"===l.mode},send_custom_headers:function(e){return e&&"client"===l.mode},send_multipart:r.capTrue,slice_blob:r.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:r.capTrue,use_http_method:function(t){return"client"===l.mode||!e.arrayDiff(t,["GET","POST"])}},{return_response_headers:function(e){return e?"client":"browser"},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"client":"browser"},use_http_method:function(t){return e.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}}),a("2.0.31005.0")&&"Opera"!==t.browser||(this.mode=!1),e.extend(this,{getShim:function(){return i.get(this.uid).content.Moxie},shimExec:function(e,t){var i=[].slice.call(arguments,2);return l.getShim().exec(this.uid,e,t,i)},init:function(){var e;e=this.getShimContainer(),e.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+o.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+t.global_event_dispatcher+'"/></object>',c=setTimeout(function(){l&&!l.initialized&&l.trigger("Error",new n.RuntimeError(n.RuntimeError.NOT_INIT_ERR))},"Windows"!==t.OS?1e4:5e3)},destroy:function(e){return function(){e.call(l),clearTimeout(c),o=c=e=l=null}}(this.destroy)},u)}var s="silverlight",u={};return r.addConstructor(s,o),u}),n("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(e,t,i){return e.Blob=t.extend({},i)}),n("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(e){var t={init:function(e){function t(e){for(var t="",i=0;i<e.length;i++)t+=(""!==t?"|":"")+e[i].title+" | *."+e[i].extensions.replace(/,/g,";*.");return t}this.getRuntime().shimExec.call(this,"FileInput","init",t(e.accept),e.name,e.multiple),this.trigger("ready")}};return e.FileInput=t}),n("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(e,t,i){var n={init:function(){var e,n=this,r=n.getRuntime();return e=r.getShimContainer(),i.addEvent(e,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},n.uid),i.addEvent(e,"dragenter",function(e){e.preventDefault();var i=t.get(r.uid).dragEnter(e);i&&e.stopPropagation()},n.uid),i.addEvent(e,"drop",function(e){e.preventDefault();var i=t.get(r.uid).dragDrop(e);i&&e.stopPropagation()},n.uid),r.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=n}),n("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(e,t,i){return e.FileReader=t.extend({},i)}),n("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(e,t,i){return e.FileReaderSync=t.extend({},i)}),n("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(e,t,i){return e.XMLHttpRequest=t.extend({},i)}),n("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(e,t,i){return e.Transporter=t.extend({},i)}),n("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(e,t,i){return e.Image=t.extend({},i,{getInfo:function(){var e=this.getRuntime(),i=["tiff","exif","gps"],n={meta:{}},r=e.shimExec.call(this,"Image","getInfo");return r.meta&&t.each(i,function(e){var t,i,a,o,s=r.meta[e];if(s&&s.keys)for(n.meta[e]={},i=0,a=s.keys.length;i<a;i++)t=s.keys[i],o=s[t],o&&(/^(\d|[1-9]\d+)$/.test(o)?o=parseInt(o,10):/^\d*\.\d+$/.test(o)&&(o=parseFloat(o)),n.meta[e][t]=o)}),n.width=parseInt(r.width,10),n.height=parseInt(r.height,10),n.size=parseInt(r.size,10),n.type=r.type,n.name=r.name,n}})}),n("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(e,t,i,n){function r(t){var r=this,s=i.capTest,u=i.capTrue;i.call(this,t,a,{access_binary:s(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:s(o.Image&&(n.can("create_canvas")||n.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:s(function(){return"Chrome"===n.browser&&n.version>=28||"IE"===n.browser&&n.version>=10}()),resize_image:function(){return o.Image&&r.can("access_binary")&&n.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(t){return!("json"!==t||!window.JSON)||!!~e.inArray(t,["text","document",""])},return_status_code:function(t){return!e.arrayDiff(t,[200,404])},select_file:function(){return n.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return r.can("select_file")},summon_file_dialog:s(function(){return"Firefox"===n.browser&&n.version>=4||"Opera"===n.browser&&n.version>=12||!!~e.inArray(n.browser,["Chrome","Safari"])}()),upload_filesize:u,use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}}),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(r),e=r=null}}(this.destroy)}),e.extend(this.getShim(),o)}var a="html4",o={};return i.addConstructor(a,r),o}),n("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(e,t,i,n,r,a){function o(){function e(){var r,l,h,d,f,p,m=this,g=m.getRuntime();p=t.guid("uid_"),r=g.getShimContainer(),o&&(h=i.get(o+"_form"),h&&t.extend(h.style,{top:"100%"})),d=document.createElement("form"),d.setAttribute("id",p+"_form"),d.setAttribute("method","post"),d.setAttribute("enctype","multipart/form-data"),d.setAttribute("encoding","multipart/form-data"),t.extend(d.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),f=document.createElement("input"),f.setAttribute("id",p),f.setAttribute("type","file"),f.setAttribute("name",s.name||"Filedata"),f.setAttribute("accept",c.join(",")),t.extend(f.style,{fontSize:"999px",opacity:0}),d.appendChild(f),r.appendChild(d),t.extend(f.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===a.browser&&a.version<10&&t.extend(f.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),f.onchange=function(){var t;this.value&&(t=this.files?this.files[0]:{name:this.value},u=[t],this.onchange=function(){},e.call(m),m.bind("change",function n(){var e,t=i.get(p),r=i.get(p+"_form");m.unbind("change",n),m.files.length&&t&&r&&(e=m.files[0],t.setAttribute("id",e.uid),r.setAttribute("id",e.uid+"_form"),r.setAttribute("target",e.uid+"_iframe")),t=r=null},998),f=d=null,m.trigger("change"))},g.can("summon_file_dialog")&&(l=i.get(s.browse_button),n.removeEvent(l,"click",m.uid),n.addEvent(l,"click",function(e){f&&!f.disabled&&f.click(),e.preventDefault()},m.uid)),o=p,r=h=l=null}var o,s,u=[],c=[];t.extend(this,{init:function(t){var a,o=this,u=o.getRuntime();s=t,c=t.accept.mimes||r.extList2mimes(t.accept,u.can("filter_by_extension")),a=u.getShimContainer(),function(){var e,r,s;e=i.get(t.browse_button),u.can("summon_file_dialog")&&("static"===i.getStyle(e,"position")&&(e.style.position="relative"),r=parseInt(i.getStyle(e,"z-index"),10)||1,e.style.zIndex=r,a.style.zIndex=r-1),s=u.can("summon_file_dialog")?e:a,n.addEvent(s,"mouseover",function(){o.trigger("mouseenter")},o.uid),n.addEvent(s,"mouseout",function(){o.trigger("mouseleave")},o.uid),n.addEvent(s,"mousedown",function(){o.trigger("mousedown")},o.uid),n.addEvent(i.get(t.container),"mouseup",function(){o.trigger("mouseup")},o.uid),e=null}(),e.call(this),a=null,o.trigger({type:"ready",async:!0})},getFiles:function(){return u},disable:function(e){var t;(t=i.get(o))&&(t.disabled=!!e)},destroy:function(){var e=this.getRuntime(),t=e.getShim(),r=e.getShimContainer();n.removeAllEvents(r,this.uid),n.removeAllEvents(s&&i.get(s.container),this.uid),n.removeAllEvents(s&&i.get(s.browse_button),this.uid),r&&(r.innerHTML=""),t.removeInstance(this.uid),o=u=c=s=r=t=null}})}return e.FileInput=o}),n("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(e,t){return e.FileReader=t}),n("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(e,t,i,n,r,a,o,s){function u(){function e(e){var t,n,r,o,s=this,u=!1;if(l){if(t=l.id.replace(/_iframe$/,""),n=i.get(t+"_form")){for(r=n.getElementsByTagName("input"),o=r.length;o--;)switch(r[o].getAttribute("type")){case"hidden":r[o].parentNode.removeChild(r[o]);break;case"file":u=!0}r=[],u||n.parentNode.removeChild(n),n=null}setTimeout(function(){a.removeEvent(l,"load",s.uid),l.parentNode&&l.parentNode.removeChild(l);var t=s.getRuntime().getShimContainer();t.children.length||t.parentNode.removeChild(t),t=l=null,e()},1)}}var u,c,l;t.extend(this,{send:function(h,d){function f(){var i=w.getShimContainer()||document.body,r=document.createElement("div");r.innerHTML='<iframe id="'+p+'_iframe" name="'+p+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',l=r.firstChild,i.appendChild(l),a.addEvent(l,"load",function(){var i;try{i=l.contentWindow.document||l.contentDocument||window.frames[l.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(i.title)?u=i.title.replace(/^(\d+).*$/,"$1"):(u=200,c=t.trim(i.body.innerHTML),y.trigger({type:"progress",loaded:c.length,total:c.length}),v&&y.trigger({type:"uploadprogress",loaded:v.size||1025,total:v.size||1025}))}catch(r){if(!n.hasSameOrigin(h.url))return void e.call(y,function(){y.trigger("error")});u=404}e.call(y,function(){y.trigger("load")})},y.uid)}var p,m,g,v,y=this,w=y.getRuntime();if(u=c=null,d instanceof s&&d.hasBlob()){if(v=d.getBlob(),p=v.uid,g=i.get(p),m=i.get(p+"_form"),!m)throw new r.DOMException(r.DOMException.NOT_FOUND_ERR)}else p=t.guid("uid_"),m=document.createElement("form"),m.setAttribute("id",p+"_form"),m.setAttribute("method",h.method),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),m.setAttribute("target",p+"_iframe"),w.getShimContainer().appendChild(m);d instanceof s&&d.each(function(e,i){if(e instanceof o)g&&g.setAttribute("name",i);else{var n=document.createElement("input");t.extend(n,{type:"hidden",name:i,value:e}),g?m.insertBefore(n,g):m.appendChild(n)}}),m.setAttribute("action",h.url),f(),m.submit(),y.trigger("loadstart")},getStatus:function(){return u},getResponse:function(e){if("json"===e&&"string"===t.typeOf(c)&&window.JSON)try{return JSON.parse(c.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(i){return null}return c},abort:function(){var t=this;l&&l.contentWindow&&(l.contentWindow.stop?l.contentWindow.stop():l.contentWindow.document.execCommand?l.contentWindow.document.execCommand("Stop"):l.src="about:blank"),e.call(this,function(){t.dispatchEvent("abort")})}})}return e.XMLHttpRequest=u}),n("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(e,t){return e.Image=t}),a(["moxie/core/utils/Basic","moxie/core/I18n","moxie/core/utils/Mime","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/file/File","moxie/file/FileInput","moxie/file/FileDrop","moxie/runtime/RuntimeTarget","moxie/file/FileReader","moxie/core/utils/Url","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/runtime/Transporter","moxie/image/Image","moxie/core/utils/Events"])}(this),function(){"use strict";var e={},t=moxie.core.utils.Basic.inArray;return function i(n){var r,a;for(r in n)a=typeof n[r],"object"!==a||~t(r,["Exceptions","Env","Mime"])?"function"===a&&(e[r]=n[r]):i(n[r])}(window.moxie),e.Env=window.moxie.core.utils.Env,e.Mime=window.moxie.core.utils.Mime,e.Exceptions=window.moxie.core.Exceptions,window.mOxie=e,window.o||(window.o=e),e}();